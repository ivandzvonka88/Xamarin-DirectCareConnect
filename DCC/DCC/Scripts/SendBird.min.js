/**
 * Copyright (c) 2016 SendBird DBA (Smile Family, Inc.)
 * SendBird JavaScript SDK v3.0.125
 */

!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("ws")):"function"==typeof define&&define.amd?define(["ws"],n):(e=e||self).SendBird=n(e.WebSocket)}(this,function(r){"use strict";function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function i(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,n,t){return n&&i(e.prototype,n),t&&i(e,t),e}function n(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,r)}return t}function _(i){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach(function(e){var n,t,r;n=i,r=a[t=e],t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})}return i}function o(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&a(e,n)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,n){return(a=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function c(e,n,t){return(c=u()?Reflect.construct:function(e,n,t){var r=[null];r.push.apply(r,n);var i=new(Function.bind.apply(e,r));return t&&a(i,t.prototype),i}).apply(null,arguments)}function t(e){var r="function"==typeof Map?new Map:void 0;return(t=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return c(e,arguments,l(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),a(t,e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(a){var s=u();return function(){var e,n,t,r=l(a);if(s){var i=l(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return n=this,!(t=e)||"object"!=typeof t&&"function"!=typeof t?d(n):t}}function p(e,n,t){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,n,t){var r=function(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&null!==(e=l(e)););return e}(e,n);if(r){var i=Object.getOwnPropertyDescriptor(r,n);return i.get?i.get.call(t):i.value}})(e,n,t||e)}function C(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],r=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(t.push(s.value),!n||t.length!==n);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return t}(e,n)||f(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,n){if(e){if("string"==typeof e)return g(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?g(e,n):void 0}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;var he=function(){function e(){v(this,e)}return s(e,null,[{key:"OS_VERSION",get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"undefined"}},{key:"SDK_VERSION",get:function(){return"3.0.125"}},{key:"SDK_MAJOR_VERSION",get:function(){return e.SDK_VERSION.split(".")[0]}},{key:"COMMAND_ACK_TIMEOUT",get:function(){return 1e4}},{key:"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",get:function(){return 100}}]),e}(),y={},m=new WeakMap,pe=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};v(this,t),m.set(this,"object"===de(e)&&e?e:{})}return s(t,[{key:"get",value:function(e){return m.get(this)[e]}},{key:"set",value:function(e,n){m.get(this)[e]=n}},{key:"remove",value:function(e){var n=m.get(this);n.hasOwnProperty(e)&&delete n[e]}},{key:"container",get:function(){return m.get(this)}}],[{key:"create",value:function(e,n){return y[e]=new t(n),y[e]}},{key:"get",value:function(e){return e=e||En.getInstance()._iid,y[e]}}]),t}(),fe=function(){o(i,t(Error));var r=h(i);function i(e,n){var t;return v(this,i),(t=r.call(this,n)).name="SendBirdException",t.code=n||0,t.message=e,t}return s(i,null,[{key:"INVALID_INITIALIZATION",get:function(){return 800100}},{key:"CONNECTION_REQUIRED",get:function(){return 800101}},{key:"CONNECTION_CANCELED",get:function(){return 800102}},{key:"INVALID_PARAMETER",get:function(){return 800110}},{key:"NETWORK_ERROR",get:function(){return 800120}},{key:"NETWORK_ROUTING_ERROR",get:function(){return 800121}},{key:"MALFORMED_DATA",get:function(){return 800130}},{key:"MALFORMED_ERROR_DATA",get:function(){return 800140}},{key:"WRONG_CHANNEL_TYPE",get:function(){return 800150}},{key:"MARK_AS_READ_RATE_LIMIT_EXCEEDED",get:function(){return 800160}},{key:"QUERY_IN_PROGRESS",get:function(){return 800170}},{key:"ACK_TIMEOUT",get:function(){return 800180}},{key:"LOGIN_TIMEOUT",get:function(){return 800190}},{key:"WEBSOCKET_CONNECTION_CLOSED",get:function(){return 800200}},{key:"WEBSOCKET_CONNECTION_FAILED",get:function(){return 800210}},{key:"REQUEST_FAILED",get:function(){return 800220}},{key:"FILE_UPLOAD_CANCEL_FAILED",get:function(){return 800230}},{key:"REQUEST_CANCELED",get:function(){return 800240}},{key:"REQUEST_DUPLICATED",get:function(){return 800250}}]),i}(),E=function(){function e(){v(this,e),this.sessionKey=null,this.eKey=null}return s(e,[{key:"hasSession",value:function(){return!!this.sessionKey}}]),e}(),e={DEBUG:"debug",PRODUCTION:"production"},U=e.PRODUCTION,_e=function(){function n(){v(this,n)}return s(n,null,[{key:"log",value:function(){var e;(e=console).log.apply(e,arguments)}},{key:"debug",value:function(){U===n.Mode.DEBUG&&n.log.apply(n,arguments)}},{key:"Mode",get:function(){return e}},{key:"mode",get:function(){return U},set:function(e){-1<Object.keys(n.Mode).map(function(e){return n.Mode[e]}).indexOf(e)&&(U=e)}}]),n}(),S={},D=function(){function i(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(var t in v(this,i),this._iid=e,n){var r=n[t];"function"==typeof r&&(this[t]=this.getClonedClass(r))}S[e]=this}return s(i,[{key:"getClonedClass",value:function(t){var r=this._iid;return function(){o(n,t);var e=h(n);function n(){return v(this,n),e.apply(this,arguments)}return s(n,[{key:"_iid",get:function(){return r}}],[{key:"_iid",get:function(){return r}},{key:"_name",get:function(){return t.name}}]),n}()}}],[{key:"get",value:function(e){return e?S[e]:{}}}]),i}(),A=function(){function n(e){v(this,n),this.sb=e,this.pingTimer=null,this.pingTimeoutTimer=null}return s(n,[{key:"ping",value:function(){var e=this,n=D.get(this.sb._iid).Command.bPing(),t=pe.get(this.sb._iid).container,r=t.wsAdapter,i=t.pongTimeout;r.ws.send(n),_e.debug("PING"),this.pingTimeoutTimer=setTimeout(function(){_e.debug("PING timeout"),e.stop(),r.ws.handler&&r.ws.handler.onError()},i)}},{key:"pong",value:function(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=null}},{key:"start",value:function(){var e=this,n=pe.get(this.sb._iid).container.pingInterval;this.stop(),this.ping(),this.pingTimer=setInterval(function(){e.ping()},n)}},{key:"stop",value:function(){clearInterval(this.pingTimer),this.pingTimer=null,clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=null}}]),n}();function I(){return"undefined"==typeof window&&"undefined"!=typeof process}var N=[fe.CONNECTION_REQUIRED,fe.NETWORK_ERROR,fe.ACK_TIMEOUT,fe.WEBSOCKET_CONNECTION_CLOSED,fe.WEBSOCKET_CONNECTION_FAILED,fe.FILE_UPLOAD_CANCEL_FAILED,fe.REQUEST_CANCELED,500901,500910,900200],ge=function(){function e(){v(this,e)}return s(e,null,[{key:"deepEqual",value:function(e,n){if(e===n)return!0;var t=_({},e),r=_({},n);return(!t.messageId||!r.messageId||t.messageId===r.messageId)&&((!t.reqId||!r.reqId||t.reqId===r.reqId)&&(t.hasOwnProperty("messageId")&&delete t.messageId,t.hasOwnProperty("reqId")&&delete t.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(t)===JSON.stringify(r)))}},{key:"isVideoChatSignalingMessage",value:function(e){try{return!(!e.isUserMessage()||"string"!=typeof e.customType||0!==e.customType.indexOf("SB_VIDEOCHAT")||"SGNL"!==e.data.substring(0,4))}catch(e){return!1}}},{key:"isResendableError",value:function(e){return 0<e&&0<=N.indexOf(e)}},{key:"isFile",value:function(e){var n="object"===de(e)&&null!==e&&"string"==typeof e.name&&"string"==typeof e.uri&&"string"==typeof e.type;if(!n)if(I()){if("undefined"!=typeof Buffer)return e instanceof Buffer}else{if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return n}}]),e}(),k=function(){function t(e){if(v(this,t),this.fields={},e)for(var n in e)this.fields[n]={value:e[n]},ge.isFile(e[n])&&(this.fields[n].filename=e[n].name);this.upload={requestId:null,deleteRequest:null,progressHandler:null}}return s(t,[{key:"add",value:function(e,n,t){var r=2<arguments.length&&void 0!==t?t:null;this.fields[e]={value:n,filename:r}}},{key:"remove",value:function(e){this.fields.hasOwnProperty(e)&&delete this.fields[e]}},{key:"yield",value:function(){var e=!1;for(var n in this.fields)if(ge.isFile(this.fields[n].value)){e=!0;break}if(e){var t=new FormData;for(var r in this.fields){var i=this.fields[r];if(ge.isFile(i.value)){var a=i.value;a.filename||a.name?t.append(r,i.value,a.filename||a.name):a.data&&t.append(r,i.value,i.data.name)}else t.append(r,i.value)}return t}var s={};for(var o in this.fields)s[o]=this.fields[o].value;return s}}]),t}(),M=function(){function S(e){v(this,S),this.sb=e,this.cls=D.get(this.sb._iid)}return s(S,[{key:"checkRouting",value:function(e){if(this.sb.customApiHost&&this.sb.customWsHost)"function"==typeof e&&e(null,{apiHost:this.sb.customApiHost,wsHost:this.sb.customWsHost});else{var n=this.sb.getApplicationId();e(null,{apiHost:"https://api-".concat(n,".sendbird.com"),wsHost:"wss://ws-".concat(n,".sendbird.com")})}}},{key:"_parseError",value:function(n){try{var e=JSON.parse(n.response),t=e?e.message:"Request failed.",r=e?e.code:fe.REQUEST_FAILED;return new fe(t,r)}catch(e){return n instanceof fe?n:new fe("Request failed.",fe.REQUEST_FAILED)}}},{key:"_setDefaultHeader",value:function(e,n){try{var t=pe.get(this.sb._iid).container,r=t.appId,i=t.auth,a=t.extensions,s=t.getUserAgentWithExtensions;e.setRequestHeader("SendBird","JS,".concat(he.OS_VERSION,",").concat(he.SDK_VERSION,",").concat(r)),e.setRequestHeader("SB-User-Agent",encodeURIComponent(s(a))),n&&e.setRequestHeader("Session-Key",i.sessionKey),e.setRequestHeader("Request-Sent-Timestamp",(new Date).getTime().toString())}catch(e){_e.debug("setting default header is failed. - ",e)}}},{key:"_setRequestEvent",value:function(i,a,n){var s=this;try{a&&"function"==typeof a&&i.upload&&(i.upload.onprogress=function(e){n&&"function"==typeof n&&n(e),e.lengthComputable&&e.loaded>=e.total&&a()}),i.onreadystatechange=function(){if(i&&i.readyState===i.DONE){var e=i.status,n=null;if(200<=e&&e<400){var t=!0;try{n=JSON.parse(i.responseText)}catch(e){t=!1,n=null}t?i.callback(null,n):i.callback(new fe("Request failed.",fe.REQUEST_FAILED),null),a&&"function"==typeof a&&a(),i=null}else{var r={status:e,statusText:i.statusText,response:i.responseText};_e.debug(r),i&&i.isAbort?i.onabort():(i.callback(s._parseError(r),null),i=null)}}},i.onabort=function(){i&&(i.callback(new fe("Request has been canceled.",fe.REQUEST_CANCELED),null),a&&"function"==typeof a&&a()),i=null},i.onerror=function(){i&&(i.callback(new fe("There was a network error.",fe.NETWORK_ERROR),null),a&&"function"==typeof a&&a()),i=null},i.ontimeout=function(){i&&(i.callback(new fe("Request is timeout.",fe.REQUEST_FAILED),null),a&&"function"==typeof a&&a()),i=null}}catch(e){_e.debug("setting request event is failed. - ",e)}}},{key:"_createWithEncodedGetParams",value:function(e){try{var n="";for(var t in e.data)if(e.data.hasOwnProperty(t)){var r=e.data[t];if(null!=r){n+=t+"="+("object"===de(r)?Array.isArray(r)?r.map(function(e){return encodeURIComponent(e)}).join(","):encodeURIComponent(JSON.stringify(r)):encodeURIComponent(r))+"&"}}n&&(e.url=e.url+"?"+n.substring(0,n.length-1))}catch(e){_e.debug("createWithEncodedGetParams is failed. - ",e)}}},{key:"_sendRequest",value:function(e,n){try{switch(e){case"GET":n.send();break;default:if("undefined"!=typeof FormData&&FormData&&n.data instanceof FormData)if(I()){var t=n.data.getHeaders();n.setRequestHeader("Content-Type",t["content-type"]);var r=[];n.data.on("data",function(e){return r.push(e)}),n.data.on("end",function(){return n.send(r)}),n.data.resume()}else n.send(n.data);else n.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.send(JSON.stringify(n.data))}}catch(e){_e.debug("sending a request is failed. - ",e)}}},{key:"get",value:function(o,l,u){var c=this;this.checkRouting(function(e,n){if(e)u(new fe("Request failed.",fe.REQUEST_FAILED),null);else{var t=pe.get(c.sb._iid).container,r=t.auth,i=t.nodeJs,a=i?i.XMLHttpRequest:XMLHttpRequest;if(a){var s=new a;s.url="".concat(n.apiHost,"/v").concat(he.SDK_MAJOR_VERSION).concat(o),s.data=l?l.yield():{},s.callback=u,c._createWithEncodedGetParams(s),s.open("GET",s.url,!0),c._setRequestEvent(s),c._setDefaultHeader(s,r.sessionKey),c._sendRequest("GET",s)}else u(new fe("Request failed. XMLHttpRequest not found.",fe.REQUEST_FAILED),null)}})}},{key:"dummyCall",value:function(o){var l=this;this.checkRouting(function(e,n){if(e)o(new fe("Request failed.",fe.REQUEST_FAILED),null);else{var t=pe.get(l.sb._iid).container,r=t.auth,i=t.nodeJs,a=i?i.XMLHttpRequest:XMLHttpRequest;if(a){var s=new a;s.url="".concat(n.apiHost),s.data={},s.callback=o,l._createWithEncodedGetParams(s),s.open("GET",s.url,!0),l._setRequestEvent(s),l._setDefaultHeader(s,r.sessionKey),l._sendRequest("GET",s)}else o(new fe("Request failed. XMLHttpRequest not found.",fe.REQUEST_FAILED),null)}})}},{key:"post",value:function(u,c,d){var h=this;this.checkRouting(function(e,n){if(e)d(new fe("Request failed.",fe.REQUEST_FAILED),null);else{var t=pe.get(h.sb._iid).container,r=t.auth,i=t.nodeJs,a=i?i.XMLHttpRequest:XMLHttpRequest;if(a){var s=new a;s.url="".concat(n.apiHost,"/v").concat(he.SDK_MAJOR_VERSION).concat(u),s.data=c?c.yield():{},s.callback=d,s.open("POST",s.url,!0),c.upload||(c.upload={});var o=h.cls.FileMessageQueue,l=c.upload.reqId;l&&(o.uploadRequest[l]=s),h._setRequestEvent(s,c.upload.deleteRequest,c.upload.progressHandler),h._setDefaultHeader(s,r.sessionKey),h._sendRequest("POST",s)}else d(new fe("Request failed. XMLHttpRequest not found.",fe.REQUEST_FAILED),null)}})}},{key:"put",value:function(o,l,u){var c=this;this.checkRouting(function(e,n){if(e)u(new fe("Request failed.",fe.REQUEST_FAILED),null);else{var t=pe.get(c.sb._iid).container,r=t.auth,i=t.nodeJs,a=i?i.XMLHttpRequest:XMLHttpRequest;if(a){var s=new a;s.url="".concat(n.apiHost,"/v").concat(he.SDK_MAJOR_VERSION).concat(o),s.data=l?l.yield():{},s.callback=u,s.open("PUT",s.url,!0),c._setRequestEvent(s),c._setDefaultHeader(s,r.sessionKey),c._sendRequest("PUT",s)}else u(new fe("Request failed. XMLHttpRequest not found.",fe.REQUEST_FAILED),null)}})}},{key:"delete",value:function(o,l,u){var c=this;this.checkRouting(function(e,n){if(e)u(new fe("Request failed.",fe.REQUEST_FAILED),null);else{var t=pe.get(c.sb._iid).container,r=t.auth,i=t.nodeJs,a=i?i.XMLHttpRequest:XMLHttpRequest;if(a){var s=new a;s.url="".concat(n.apiHost,"/v").concat(he.SDK_MAJOR_VERSION).concat(o),s.data=l?l.yield():{},s.callback=u,c._createWithEncodedGetParams(s),s.open("DELETE",s.url,!0),c._setRequestEvent(s),c._setDefaultHeader(s,r.sessionKey),c._sendRequest("DELETE",s)}else u(new fe("Request failed. XMLHttpRequest not found.",fe.REQUEST_FAILED),null)}})}},{key:"updateCurrentUserInfo",value:function(e,i){var a=this,s=e.nickname,o=e.profileUrl,l=e.profileImage,u=e.preferredLanguages;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID.replace("%s",encodeURIComponent(n.userId)),r=new k;s&&r.add("nickname",s),o&&r.add("profile_url",o),l&&r.add("profile_file",l,l.name),u&&r.add("preferred_languages",u),a.put(t,r,i)}})}},{key:"getMyGroupChannelChangeLogs",value:function(e,i){var a=this,s=e.ts,o=e.token,l=e.customTypes,u=e.includeEmpty,c=e.includeFrozen;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_MY_GROUP_CHANNEL_CHANGELOGS.replace("%s",encodeURIComponent(n.userId)),r=new k({show_read_receipt:!0,show_delivery_receipt:!0,show_member:!0});o&&r.add("token",o),s&&r.add("change_ts",s),l&&0<l.length&&r.add("custom_types",l),"boolean"==typeof u&&r.add("show_empty",u),"boolean"==typeof c&&r.add("show_frozen",c),a.get(t,r,i)}})}},{key:"getChannelInvitationPreference",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(n.userId));i.get(t,null,r)}})}},{key:"getGroupChannelCount",value:function(e,s){var o=this,l=e.memberStateFilter;this.sb.ConnectionManager.ready(function(e,n){if(e)s(e,null);else{var t=o.cls.GroupChannel,r=S.Path.USERS_USERID_GROUP_CHANNEL_COUNT.replace("%s",encodeURIComponent(n.userId)),i="";switch(l){case t.MemberStateFilter.JOINED:i="joined";break;case t.MemberStateFilter.INVITED:i="invited";break;case t.MemberStateFilter.INVITED_BY_FRIEND:i="invited_by_friend";break;case t.MemberStateFilter.INVITED_BY_NON_FRIEND:i="invited_by_non_friend";break;default:i="all"}var a=new k({state:i});o.get(r,a,s)}})}},{key:"getUnreadItemCount",value:function(e,i){var a=this,s=e.keys;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_UNREAD_ITEM_COUNT.replace("%s",encodeURIComponent(n.userId)),r=new k({item_keys:s});a.get(t,r,i)}})}},{key:"getTotalUnreadMessageCount",value:function(e,i){var a=this,s=e.customTypesFilter,o=e.superChannelFilter;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_UNREAD_MESSAGE_COUNT.replace("%s",encodeURIComponent(n.userId)),r=new k({super_mode:o});null!==s&&0<s.length&&r.add("custom_types",s),a.get(t,r,i)}})}},{key:"getTotalUnreadChannelCount",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_UNREAD_CHANNEL_COUNT.replace("%s",encodeURIComponent(n.userId));i.get(t,null,r)}})}},{key:"searchMessages",value:function(e,i){var a=this,s=e.keyword,o=e.limit,l=e.reverse,u=e.exactMatch,c=e.channelUrl,d=e.channelCustomType,h=e.messageTimestampFrom,p=e.messageTimestampTo,f=e.order,_=e.nextToken;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.SEARCH_MESSAGE,r=new k({limit:o,reverse:l,query:s,custom_type:d});h&&r.add("message_ts_from",h),p&&r.add("message_ts_to",p),c&&r.add("channel_url",c),f&&r.add("sort_field",f),"boolean"==typeof u&&r.add("exact_match",u),null!==_&&0<_.length&&r.add("after",_),a.get(t,r,i)}})}},{key:"markAsReadAll",value:function(e,i){var a=this,s=e.channelUrls;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_MARKASREADALL.replace("%s",encodeURIComponent(n.userId)),r=new k;s&&r.add("channel_urls",s),a.put(t,r,i)}})}},{key:"markAsDelivered",value:function(e,i){var a=this,s=e.channelUrl,o=e.userId;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASDELIVERED.replace("%s",encodeURIComponent(s)),r=new k;o&&r.add("user_id",o),a.put(t,r,i)}})}},{key:"setChannelInvitationPreference",value:function(e,i){var a=this,s=e.isAutoAccept;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE.replace("%s",encodeURIComponent(n.userId)),r=new k({auto_accept:s});a.put(t,r,i)}})}},{key:"blockUser",value:function(e,i){var a=this,s=e.blockedUserId;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_BLOCK.replace("%s",encodeURIComponent(n.userId)),r=new k({target_id:s});a.post(t,r,i)}})}},{key:"unblockUser",value:function(e,r){var i=this,a=e.unblockedUserId;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_BLOCK_TARGETID.replace("%s",encodeURIComponent(n.userId)).replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"getPushTriggerOption",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(n.userId));i.get(t,null,r)}})}},{key:"setPushTriggerOption",value:function(e,i){var a=this,s=e.pushTriggerOption;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(n.userId)),r=new k({push_trigger_option:s});a.put(t,r,i)}})}},{key:"getPushTokens",value:function(e,i){var a=this,s=e.ts,o=e.token,l=e.type;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_PUSH_DEVICE_TOKENS.replace("%s",encodeURIComponent(n.userId)).replace("%s",encodeURIComponent(l)),r=new k;o&&r.add("token",o),s&&r.add("created_ts",s),a.get(t,r,i)}})}},{key:"getPushTemplate",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(n.userId));i.get(t,null,r)}})}},{key:"setPushTemplate",value:function(e,i){var a=this,s=e.templateName;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_PUSH_TEMPLATE.replace("%s",encodeURIComponent(n.userId)),r=new k({name:s});a.put(t,r,i)}})}},{key:"getDoNotDisturb",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(n.userId));i.get(t,null,r)}})}},{key:"setDoNotDisturb",value:function(e,i){var a=this,s=e.doNotDisturbOn,o=e.startHour,l=e.startMin,u=e.endHour,c=e.endMin,d=e.timezone;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(n.userId)),r=new k({do_not_disturb:s,start_hour:o,start_min:l,end_hour:u,end_min:c,timezone:d});a.put(t,r,i)}})}},{key:"getSnoozePeriod",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(n.userId));i.get(t,null,r)}})}},{key:"setSnoozePeriod",value:function(e,i){var a=this,s=e.snoozeOn,o=e.startTs,l=e.endTs;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_PUSHPREFERENCE.replace("%s",encodeURIComponent(n.userId)),r=new k({snooze_enabled:s,snooze_start_ts:o,snooze_end_ts:l});a.put(t,r,i)}})}},{key:"registerGCMPushToken",value:function(e,i){var a=this,s=e.token;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(n.userId)),r=new k({gcm_reg_token:s,always_push:!0});a.post(t,r,i)}})}},{key:"unregisterGCMPushToken",value:function(e,r){var i=this,a=e.token;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSH_GCM_TOKEN.replace("%s",encodeURIComponent(n.userId)).replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"unregisterAllGCMPushTokens",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSH_GCM.replace("%s",encodeURIComponent(n.userId));i.delete(t,null,r)}})}},{key:"registerAPNSPushToken",value:function(e,i){var a=this,s=e.token;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(n.userId)),r=new k({apns_device_token:s,always_push:!0});a.post(t,r,i)}})}},{key:"unregisterAPNSPushToken",value:function(e,r){var i=this,a=e.token;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSH_APNS_TOKEN.replace("%s",encodeURIComponent(n.userId)).replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"unregisterAllAPNSPushTokens",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSH_APNS.replace("%s",encodeURIComponent(n.userId));i.delete(t,null,r)}})}},{key:"unregisterAllPushTokens",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSH.replace("%s",encodeURIComponent(n.userId));i.delete(t,null,r)}})}},{key:"loadFriendList",value:function(e,i){var a=this,s=e.token,o=e.limit;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.FRIENDS.replace("%s",encodeURIComponent(n.userId)),r=new k({limit:o,token:s});a.get(t,r,i)}})}},{key:"getFriendChangeLogsByToken",value:function(e,i){var a=this,s=e.token;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.FRIENDS_CHANGE_LOGS.replace("%s",encodeURIComponent(n.userId)),r=new k;s&&r.add("token",s),a.get(t,r,i)}})}},{key:"addFriends",value:function(e,i){var a=this,s=e.userIds;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.FRIENDS.replace("%s",encodeURIComponent(n.userId)),r=new k({user_ids:s});a.post(t,r,i)}})}},{key:"deleteFriends",value:function(e,i){var a=this,s=e.userIds;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.FRIENDS.replace("%s",encodeURIComponent(n.userId)),r=new k({user_ids:s});a.delete(t,r,i)}})}},{key:"uploadFriendDiscoveries",value:function(e,a){var s=this,o=e.discoveries;this.sb.ConnectionManager.ready(function(e,n){if(e)a(e,null);else{var t=S.Path.FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(n.userId)),r=[];o.forEach(function(e){r.push({friend_discovery_key:e.friendDiscoveryKey,friend_name:"string"==typeof e.friendName||e.friendName?e.friendName:null})});var i=new k({friend_discoveries:r});s.put(t,i,a)}})}},{key:"deleteFriendDiscoveries",value:function(e,i){var a=this,s=e.discoveryKeys;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.FRIENDS_DISCOVERIES.replace("%s",encodeURIComponent(n.userId)),r=new k({friend_discovery_keys:s});a.delete(t,r,i)}})}},{key:"loadUserList",value:function(e,i){var a=this,s=e.token,o=e.limit,l=e.userIdsFilter,u=e.metaDataKeyFilter,c=e.metaDataValuesFilter;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS,r=new k({token:s,limit:o});l&&0<l.length&&r.add("user_ids",l),u&&c&&0<c.length&&(r.add("metadatakey",u),r.add("metadatavalues_in",c)),a.get(t,r,i)}})}},{key:"loadBlockedUserList",value:function(e,i){var a=this,s=e.token,o=e.limit,l=e.userIdsFilter;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_BLOCK.replace("%s",encodeURIComponent(n.userId)),r=new k({token:s,limit:o});l&&0<l.length&&r.add("user_ids",l),a.get(t,r,i)}})}},{key:"createUserMetaData",value:function(e,i){var a=this,s=e.metaData;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(n.userId)),r=new k({metadata:s});a.post(t,r,i)}})}},{key:"updateUserMetaData",value:function(e,i){var a=this,s=e.metaData,o=e.upsert;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(n.userId)),r=new k({metadata:s,upsert:o});a.put(t,r,i)}})}},{key:"deleteUserMetaData",value:function(e,r){var i=this,a=e.metaDataKey;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_METADATA_KEY.replace("%s",encodeURIComponent(n.userId)).replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"deleteAllUserMetaData",value:function(e,r){var i=this;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_METADATA.replace("%s",encodeURIComponent(n.userId));i.delete(t,null,r)}})}},{key:"getMessageChangeLogs",value:function(e,i){var a=this,s=e.channelUrl,o=e.ts,l=e.timestamp,u=e.token,c=e.isOpenChannel,d=e.includeMetaArray,h=e.includeReaction,p=e.includeReplies,f=e.includeParentMessageText,_=e.includeThreadInfo;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=c?S.Path.OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS.replace("%s",encodeURIComponent(s)),r=new k;u&&r.add("token",u),o&&r.add("change_ts",o),l&&r.add("change_ts",l),"boolean"==typeof d&&r.add("with_sorted_meta_array",d),"boolean"==typeof h&&r.add("include_reactions",h),"boolean"==typeof p&&r.add("include_replies",p),"boolean"==typeof f&&r.add("include_parent_text_message",f),"boolean"==typeof _&&r.add("include_thread_info",_),a.get(t,r,i)}})}},{key:"getMyMutedInfo",value:function(e,r){var i=this,a=e.channelUrl,s=e.userId,o=e.isGroupChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=o?S.Path.GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)):S.Path.OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s));i.get(t,null,r)}})}},{key:"loadBannedUserList",value:function(e,i){var a=this,s=e.token,o=e.limit,l=e.channelUrl,u=e.isOpenChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=u?S.Path.OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(l)):S.Path.GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(l)),r=new k({token:s,limit:o});a.get(t,r,i)}})}},{key:"loadMutedUserList",value:function(e,i){var a=this,s=e.token,o=e.limit,l=e.channelUrl,u=e.isOpenChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=u?S.Path.OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(l)):S.Path.GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(l)),r=new k({token:s,limit:o});a.get(t,r,i)}})}},{key:"getMessageList",value:function(e,i){var a=this,s=e.channel,o=e.token,l=e.tokenType,u=e.isInclusive,n=e.prevResultSize,c=void 0===n?0:n,t=e.nextResultSize,d=void 0===t?0:t,h=e.shouldReverse,p=e.messageType,f=e.customType,_=e.senderUserIds,g=e.includeMetaArray,y=e.includeReaction,m=e.includeThreadInfo,v=e.includeReplies,C=e.includeParentMessageText,E=e.rootMessageId,U=e.parentMessageId;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=s.isOpenChannel()?S.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",s.url):S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",s.url),r=new k({is_sdk:String(!0),prev_limit:String(c),next_limit:String(d),include:String(u),reverse:String(h)});"timestamp"===l?r.add("message_ts",o):"messageId"===l&&r.add("message_id",String(o)),p&&r.add("message_type",String(p)),f&&r.add("custom_type",String(f)),Array.isArray(_)&&0<_.length&&r.add("sender_ids",_),"boolean"==typeof g&&r.add("with_sorted_meta_array",g),"boolean"==typeof y&&r.add("include_reactions",y),"boolean"==typeof m&&r.add("include_thread_info",m),"boolean"==typeof v&&r.add("include_replies",v),"boolean"==typeof C&&r.add("include_parent_message_text",C),E&&r.add("root_message_id",E),U&&r.add("parent_message_id",U),a.get(t,r,i)}})}},{key:"translateUserMessage",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.messageId,u=e.translationTargetLanguages;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION.replace("%s",encodeURIComponent(s)).replace("%s",l):S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION.replace("%s",encodeURIComponent(s)).replace("%s",l),r=new k({target_langs:u});a.post(t,r,i)}})}},{key:"getMessage",value:function(e,r){var i=this,a=e.channel,s=e.messageId;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=a.isOpenChannel()?S.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(a.url)).replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(a.url)).replace("%s",encodeURIComponent(s));i.get(t,null,r)}})}},{key:"deleteMessage",value:function(e,r){var i=this,a=e.channelUrl,s=e.isOpenChannel,o=e.messageId;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=s?S.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(o)):S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(o));i.delete(t,null,r)}})}},{key:"muteUser",value:function(e,i){var a=this,s=e.channelUrl,o=e.userId,l=e.description,u=e.seconds,c=e.isGroupChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=c?S.Path.GROUPCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(s)):S.Path.OPENCHANNELS_CHANNELURL_MUTE.replace("%s",encodeURIComponent(s)),r=new k({user_id:o});u&&(0<u||-1!==u)&&r.add("seconds",u),l&&r.add("description",l),a.post(t,r,i)}})}},{key:"unmuteUser",value:function(e,r){var i=this,a=e.channelUrl,s=e.userId,o=e.isGroupChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=o?S.Path.GROUPCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)):S.Path.OPENCHANNELS_CHANNELURL_MUTE_USERID.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s));i.delete(t,null,r)}})}},{key:"banUser",value:function(e,i){var a=this,s=e.channelUrl,o=e.userId,l=e.description,u=e.seconds,c=e.isGroupChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=c?S.Path.GROUPCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(s)):S.Path.OPENCHANNELS_CHANNELURL_BAN.replace("%s",encodeURIComponent(s)),r=new k({user_id:o});l&&r.add("description",l),r.add("seconds",String(u)),a.post(t,r,i)}})}},{key:"unbanUser",value:function(e,r){var i=this,a=e.channelUrl,s=e.userId,o=e.isGroupChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=o?S.Path.GROUPCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s)):S.Path.OPENCHANNELS_CHANNELURL_BAN_USERID.replace("%s",encodeURIComponent(a)).replace("%s",encodeURIComponent(s));i.delete(t,null,r)}})}},{key:"getMetaCounters",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.keys;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(s)),r=new k({keys:l});a.get(t,r,i)}})}},{key:"createMetaCounters",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.metaCounter;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(s)),r=new k({metacounter:l});a.post(t,r,i)}})}},{key:"updateMetaCounters",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.metaCounter,u=e.upsert,c=e.mode;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(s)),r=new k({metacounter:l,upsert:u,mode:c});a.put(t,r,i)}})}},{key:"deleteMetaCounter",value:function(e,r){var i=this,a=e.channelUrl,s=e.isOpenChannel,o=e.key;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=s?S.Path.OPENCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(a)).replace("%s",o):S.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY.replace("%s",encodeURIComponent(a)).replace("%s",o);i.delete(t,null,r)}})}},{key:"deleteAllMetaCounters",value:function(e,r){var i=this,a=e.channelUrl,s=e.isOpenChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=s?S.Path.OPENCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(a)):S.Path.GROUPCHANNELS_CHANNELURL_METACOUNTER.replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"getMetaData",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.keys;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(s)),r=new k({keys:l});a.get(t,r,i)}})}},{key:"createMetaData",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.metaData;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(s)),r=new k({metadata:l});a.post(t,r,i)}})}},{key:"updateMetaData",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.metaData,u=e.upsert;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(s)),r=new k({metadata:l,upsert:u});a.put(t,r,i)}})}},{key:"deleteMetaData",value:function(e,r){var i=this,a=e.channelUrl,s=e.isOpenChannel,o=e.key;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=s?S.Path.OPENCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(a)).replace("%s",o):S.Path.GROUPCHANNELS_CHANNELURL_METADATA_KEY.replace("%s",encodeURIComponent(a)).replace("%s",o);i.delete(t,null,r)}})}},{key:"deleteAllMetaData",value:function(e,r){var i=this,a=e.channelUrl,s=e.isOpenChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=s?S.Path.OPENCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(a)):S.Path.GROUPCHANNELS_CHANNELURL_METADATA.replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"loadOperatorList",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.token,u=e.limit;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.OPENCHANNELS_OPERATORS.replace("%s",encodeURIComponent(s)):S.Path.GROUPCHANNELS_OPERATORS.replace("%s",encodeURIComponent(s)),r=new k({token:l,limit:u});a.get(t,r,i)}})}},{key:"getOpenChannel",value:function(e,r){var i=this,a=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(a));i.get(t,null,r)}})}},{key:"loadOpenChannelList",value:function(e,i){var a=this,s=e.token,o=e.limit,l=e.nameKeyword,u=e.urlKeyword,c=e.customTypes,d=e.includeFrozen;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.OPENCHANNELS,r=new k({token:s,limit:o});l&&r.add("name_contains",l),u&&r.add("url_contains",u),c&&0<c.length&&r.add("custom_types",c),"boolean"==typeof d&&r.add("show_frozen",d),a.get(t,r,i)}})}},{key:"loadParticipantList",value:function(e,i){var a=this,s=e.token,o=e.limit,l=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.OPENCHANNELS_CHANNELURL_PARTICIPANTS.replace("%s",encodeURIComponent(l)),r=new k({token:s,limit:o});a.get(t,r,i)}})}},{key:"createOpenChannel",value:function(e,i){var a=this,s=e.name,o=e.coverUrlOrImage,l=e.data,u=e.operatorUserIds,c=e.customType;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.OPENCHANNELS,r=new k;"string"==typeof o&&r.add("cover_url",o),ge.isFile(o)&&r.add("cover_file",o),null!==s&&"string"==typeof s&&r.add("name",s),l&&r.add("data",l),u&&(Array.isArray(u)?r.add("operators",u):r.add("operators",[u])),c&&r.add("custom_type",c),a.post(t,r,i)}})}},{key:"updateOpenChannel",value:function(e,i){var a=this,s=e.channelUrl,o=e.name,l=e.coverUrlOrImage,u=e.data,c=e.operatorUserIds,d=e.customType;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(s)),r=new k;"string"==typeof l&&r.add("cover_url",l),ge.isFile(l)&&r.add("cover_file",l,l.name),null!==o&&"string"==typeof o&&r.add("name",o),null!==u&&"string"==typeof u&&r.add("data",u),null!==c&&(Array.isArray(c)?r.add("operator_ids",c):r.add("operator_ids",[c])),null!==d&&"string"==typeof d&&r.add("custom_type",d),a.put(t,r,i)}})}},{key:"deleteOpenChannel",value:function(e,r){var i=this,a=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.OPENCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"getGroupChannel",value:function(e,i){var a=this,s=e.channelUrl,o=e.showMember;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(s)),r=new k({show_member:o,show_read_receipt:!0,show_delivery_receipt:!0});a.get(t,r,i)}})}},{key:"loadGroupChannelList",value:function(e,i){var a=this,s=e.token,o=e.limit,l=e.includeEmpty,u=e.order,c=e.userIdsFilter,d=e.nicknameContainsFilter,h=e.channelNameContainsFilter,p=e.channelUrlsFilter,f=e.customTypesFilter,_=e.customTypeStartsWithFilter,g=e.memberStateFilter,y=e.superChannelFilter,m=e.publicChannelFilter,v=e.unreadChannelFilter,C=e.metadataOrderKeyFilter,E=e.hiddenChannelFilter,U=e.searchFilter,b=e.includeFrozen;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.MYGROUPCHANNELS.replace("%s",encodeURIComponent(n.userId)),r=new k({token:s,limit:o,order:u,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:String(l),member_state_filter:g});f&&0<f.length&&r.add("custom_types",f),d&&r.add("members_nickname_contains",d),h&&r.add("name_contains",h),U.hasOwnProperty("search_query")&&U.hasOwnProperty("search_fields")&&(r.add("search_query",U.search_query),r.add("search_fields",U.search_fields)),c.userIds&&0<c.userIds.length&&(c.includeMode?(r.add("members_include_in",c.userIds),r.add("query_type",c.queryType.toUpperCase())):r.add("members_exactly_in",c.userIds)),p&&0<p.length&&r.add("channel_urls",p),r.add("super_mode",y),r.add("public_mode",m),r.add("unread_filter",v),C&&r.add("metadata_order_key",C),_&&r.add("custom_type_startswith",_),E&&r.add("hidden_mode",E),"boolean"==typeof b&&r.add("show_frozen",b),a.get(t,r,i)}})}},{key:"loadPublicGroupChannelList",value:function(e,a){var s=this,o=e.token,l=e.limit,u=e.includeEmpty,c=e.order,d=e.channelNameContainsFilter,h=e.channelUrlsFilter,p=e.customTypesFilter,f=e.customTypeStartsWithFilter,_=e.superChannelFilter,g=e.membershipFilter,y=e.metadataOrderKeyFilter,m=e.includeFrozen;this.sb.ConnectionManager.ready(function(e,n){if(e)a(e,null);else{var t=s.cls.GroupChannel,r=S.Path.GROUPCHANNELS,i=new k({token:o,limit:l,order:c,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:String(u),public_mode:t.PublicChannelFilter.PUBLIC,public_membership_mode:g});p&&0<p.length&&i.add("custom_types",p),d&&i.add("name_contains",d),h&&0<h.length&&i.add("channel_urls",h),i.add("super_mode",_),y&&i.add("metadata_order_key",y),f&&i.add("custom_type_startswith",f),"boolean"==typeof m&&i.add("show_frozen",m),s.get(r,i,a)}})}},{key:"createGroupChannel",value:function(e,i){var a=this,s=e.isDistinct,o=e.isSuper,l=e.isBroadcast,u=e.isPublic,c=e.channelUrl,d=e.isDiscoverable,h=e.isStrict,p=e.name,f=e.data,_=e.customType,g=e.coverUrl,y=e.coverImage,m=e.accessCode,v=e.isEphemeral,n=e._invitedUserIds,C=void 0===n?[]:n,E=e.operatorUserIds,U=e.messageSurvivalSeconds;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS,r=new k({user_ids:[n.userId].concat(b(C)).filter(function(e,n,t){return n===t.indexOf(e)})});null!==g&&"string"==typeof g&&r.add("cover_url",g),ge.isFile(y)&&r.add("cover_file",y,y.name),null!==c&&r.add("channel_url",c),null!==s&&r.add("is_distinct",s),null!==o&&r.add("is_super",o),null!==l&&r.add("is_broadcast",l),null!==u&&r.add("is_public",u),null!==d&&r.add("is_discoverable",d),null!==h&&r.add("strict",h),null!==v&&r.add("is_ephemeral",v),m&&r.add("access_code",m),null!==p&&"string"==typeof p&&r.add("name",p),f&&r.add("data",f),_&&r.add("custom_type",_),Array.isArray(E)&&0<E.length&&r.add("operator_ids",E),null!==U&&-1<U&&r.add("message_survival_seconds",U),a.post(t,r,i)}})}},{key:"updateGroupChannel",value:function(e,i){var a=this,s=e.isDistinct,o=e.isPublic,l=e.channelUrl,u=e.isDiscoverable,c=e.name,d=e.data,h=e.customType,p=e.coverUrl,f=e.coverImage,_=e.accessCode,g=e.operatorUserIds,y=e.messageSurvivalSeconds;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(l)),r=new k;null!==s&&r.add("is_distinct",s),null!==o&&r.add("is_public",o),null!==u&&r.add("is_discoverable",u),null!==_&&r.add("access_code",_),null!==p&&"string"==typeof p&&r.add("cover_url",p),ge.isFile(f)&&r.add("cover_file",f,f.name),null!==c&&"string"==typeof c&&r.add("name",c),null!==d&&"string"==typeof d&&r.add("data",d),null!==h&&"string"==typeof h&&r.add("custom_type",h),null!==g&&(Array.isArray(g)?r.add("operator_ids",g):g&&r.add("operator_ids",[g])),null!==y&&-1<y&&r.add("message_survival_seconds",y),a.put(t,r,i)}})}},{key:"inviteToGroupChannel",value:function(e,i){var a=this,s=e.channelUrl,o=e.userIds;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL_INVITE.replace("%s",encodeURIComponent(s)),r=new k({user_ids:o});a.post(t,r,i)}})}},{key:"acceptInvitation",value:function(e,i){var a=this,s=e.channelUrl,o=e.accessCode;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION.replace("%s",encodeURIComponent(s)),r=new k({user_id:n.userId});o&&r.add("access_code",o),a.put(t,r,i)}})}},{key:"declineInvitation",value:function(e,i){var a=this,s=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION.replace("%s",encodeURIComponent(s)),r=new k({user_id:n.userId});a.put(t,r,i)}})}},{key:"joinGroupChannel",value:function(e,i){var a=this,s=e.channelUrl,o=e.accessCode;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL_JOIN.replace("%s",encodeURIComponent(s)),r=new k({user_id:n.userId});o&&r.add("access_code",o),a.put(t,r,i)}})}},{key:"leaveGroupChannel",value:function(e,i){var a=this,s=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL_LEAVE.replace("%s",encodeURIComponent(s)),r=new k({user_id:n.userId});a.put(t,r,i)}})}},{key:"hideGroupChannel",value:function(e,i){var a=this,s=e.channelUrl,o=e.hidePreviousMessages,l=e.allowAutoUnhide;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(s)),r=new k({user_id:n.userId,hide_previous_messages:o,allow_auto_unhide:l});a.put(t,r,i)}})}},{key:"unhideGroupChannel",value:function(e,r){var i=this,a=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL_HIDE.replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"freeze",value:function(e,i){var a=this,s=e.channelUrl,o=e.isGroupChannel,l=e.freezing;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=o?S.Path.GROUPCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(s)):S.Path.OPENCHANNELS_CHANNELURL_FREEZE.replace("%s",encodeURIComponent(s)),r=new k({freeze:l});a.put(t,r,i)}})}},{key:"deleteGroupChannel",value:function(e,r){var i=this,a=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.GROUPCHANNELS_CHANNELURL.replace("%s",encodeURIComponent(a));i.delete(t,null,r)}})}},{key:"loadMemberList",value:function(e,i){var a=this,s=e.channelUrl,o=e.token,l=e.limit,u=e.mutedMemberFilter,c=e.order,d=e.memberStateFilter,h=e.nicknameStartsWithFilter;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.GROUPCHANNELS_MEMBERS.replace("%s",encodeURIComponent(s)),r=new k({token:o,limit:l,order:c.toLowerCase(),muted_member_filter:u.toLowerCase(),member_state_filter:d,show_read_receipt:!0,show_delivery_receipt:!0});h&&r.add("nickname_startswith",h),a.get(t,r,i)}})}},{key:"report",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.reportCategory,u=e.reportingUserId,c=e.reportDescription;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.REPORT_CHANNELS.replace("%s",encodeURIComponent(o?"open_channels":"group_channels")).replace("%s",encodeURIComponent(s)),r=new k({report_category:l});null!=u&&r.add("reporting_user_id",u),null!=c&&r.add("report_description",c),a.post(t,r,i)}})}},{key:"reportUser",value:function(e,i){var a=this,s=e.offendingUserId,o=e.channelUrl,l=e.isOpenChannel,u=e.reportCategory,c=e.reportingUserId,d=e.reportDescription;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.REPORT_USERS.replace("%s",encodeURIComponent(s)),r=new k({channel_url:o,channel_type:l?"open_channels":"group_channels",report_category:u});null!=c&&r.add("reporting_user_id",c),null!=d&&r.add("report_description",d),a.post(t,r,i)}})}},{key:"reportMessage",value:function(e,i){var a=this,s=e.channelUrl,o=e.isOpenChannel,l=e.messageId,u=e.reportCategory,c=e.reportingUserId,d=e.reportDescription,h=e.offendingUserId;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.REPORT_MESSAGES.replace("%s",encodeURIComponent(o?"open_channels":"group_channels")).replace("%s",encodeURIComponent(s)).replace("%s",encodeURIComponent(l)),r=new k({report_category:u,offending_user_id:h});null!=c&&r.add("reporting_user_id",c),null!=d&&r.add("report_description",d),a.post(t,r,i)}})}},{key:"sendUserMessage",value:function(e,a){var s=this,o=e.channelUrl,l=e.isOpenChannel,u=e.message,c=e.data,d=e.customType,h=e.translationTargetLanguages,p=e.metaArrays,f=e.mentionType,_=e.mentionedUserIds,g=e.pushNotificationDeliveryOption,y=e.rootMessageId,m=e.parentMessageId;this.sb.ConnectionManager.ready(function(e,n){if(e)a(e,null);else{var t=s.cls.FileMessageParams,r=l?S.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(o)):S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(o)),i=new k({message_type:"MESG",user_id:n.userId,message:u,mention_type:f,mentioned_user_ids:[]});null!=c&&i.add("data",c),null!=d&&i.add("custom_type",d),h&&i.add("translation_target_langs",h),p&&0<p.length&&i.add("sorted_metaarray",p.map(function(e){return e.encode()})),f===s.cls.BaseMessageParams.MentionType.CHANNEL?i.add("mentioned_user_ids",[]):Array.isArray(_)&&0<_.length&&i.add("mentioned_user_ids",_),g&&g!==t.PushNotificationDeliveryOption.DEFAULT&&i.add("push_option",g),y&&i.add("root_message_id",y),m&&i.add("parent_message_id",m),s.post(r,i,a)}})}},{key:"sendFileMessage",value:function(e,a){var s=this,o=e.channelUrl,l=e.isOpenChannel,u=e.fileUrl,c=e.fileName,d=e.fileSize,h=e.fileType,p=e.data,f=e.customType,_=e.thumbnailSizes,g=e.requireAuth,y=e.metaArrays,m=e.mentionType,v=e.mentionedUserIds,C=e.pushNotificationDeliveryOption,E=e.rootMessageId,U=e.parentMessageId;this.sb.ConnectionManager.ready(function(e,n){if(e)a(e,null);else{var t=s.cls.FileMessageParams,r=l?S.Path.OPENCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(o)):S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES.replace("%s",encodeURIComponent(o)),i=new k({message_type:"FILE",user_id:n.userId,url:u,mention_type:m,mentioned_user_ids:[]});null!=c&&i.add("file_name",c),null!=d&&i.add("file_size",d),null!=h&&i.add("file_type",h),null!=p&&i.add("custom_field",p),null!=f&&i.add("custom_type",f),_&&i.add("thumbnails",_),g&&i.add("require_auth",g),y&&0<y.length&&i.add("sorted_metaarray",y.map(function(e){return e.encode()})),m===s.cls.BaseMessageParams.MentionType.CHANNEL?i.add("mentioned_user_ids",[]):Array.isArray(v)&&0<v.length&&i.add("mentioned_user_ids",v),C&&C!==t.PushNotificationDeliveryOption.DEFAULT&&i.add("push_option",C),E&&i.add("root_message_id",E),U&&i.add("parent_message_id",U),s.post(r,i,a)}})}},{key:"uploadFile",value:function(e,a){var s=this,o=e.file,l=e.thumbnailSizes,u=e.channelUrl,c=e.progressHandler,d=e.reqId;this.sb.ConnectionManager.ready(function(e,n){if(e)a(e,null);else{var t=S.Path.STORAGE_FILE,r=new k;if(r.add("file",o,o.name),u&&"string"==typeof u&&r.add("channel_url",u),l)for(var i=0;i<l.length;i++)r.add("thumbnail"+(i+1),l[i].maxWidth+","+l[i].maxHeight);r.upload.reqId=d,r.upload.deleteRequest=function(){var e=s.cls.FileMessageQueue;e.uploadRequest[d]&&delete e.uploadRequest[d]},r.upload.progressHandler=function(e){c&&"function"==typeof c&&c(e,d)},s.post(t,r,a)}})}},{key:"registerScheduledUserMessage",value:function(e,i){var a=this,s=e.groupChannelParams,o=e.channelUrl,l=e.isOpenChannel;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=l?S.Path.OPENCHANNELS_CHANNELURL_SCHEDULED_MESSAGES.replace("%s",encodeURIComponent(o)):S.Path.GROUPCHANNELS_CHANNELURL_SCHEDULED_MESSAGES.replace("%s",encodeURIComponent(o)),r=new k({scheduled_dt:s._getScheduleString(),user_id:n.userId,message:s.message,data:s.data});s.customType&&r.add("custom_type",s.customType),s.metaArrayKeys&&0<Object.keys(s.metaArrayKeys).length&&r.add("metaarray",s.metaArrayKeys),s.mentionType&&r.add("mention_type",s._mentionType),s._mentionType===a.cls.BaseMessageParams.MentionType.CHANNEL?r.add("mentioned_user_ids",[]):Array.isArray(s._mentionedUserIds)&&0<s._mentionedUserIds.length&&r.add("mentioned_user_ids",s._mentionedUserIds),s.translationTargetLanguages&&0<s.translationTargetLanguages.length&&r.add("translation_target_langs",s.translationTargetLanguages),s.pushNotificationDeliveryOption&&s.pushNotificationDeliveryOption!==a.cls.BaseMessageParams.PushNotificationDeliveryOption.DEFAULT&&r.add("push_option",s.pushNotificationDeliveryOption),a.post(t,r,i)}})}},{key:"getMyPushTriggerOption",value:function(e,r){var i=this,a=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(n.userId)).replace("%s",encodeURIComponent(a));i.get(t,null,r)}})}},{key:"setMyPushTriggerOption",value:function(e,i){var a=this,s=e.channelUrl,o=e.pushTriggerOption,l=e.enable;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_USERID_PUSHPREFERENCE_CHANNELURL.replace("%s",encodeURIComponent(n.userId)).replace("%s",encodeURIComponent(s)),r=new k;o&&r.add("push_trigger_option",o),"boolean"==typeof l&&r.add("enable",l),a.put(t,r,i)}})}},{key:"setMyCountPreference",value:function(e,i){var a=this,s=e.channelUrl,o=e.countPreference;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=S.Path.USERS_COUNT_PREFERENCE.replace("%s",encodeURIComponent(n.userId)).replace("%s",encodeURIComponent(s)),r=new k({count_preference:o});a.put(t,r,i)}})}},{key:"resetMyHistory",value:function(e,r){var i=this,a=e.channelUrl;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.GROUPCHANNELS_RESET_USER_HISTORY.replace("%s",encodeURIComponent(a));i.put(t,null,r)}})}},{key:"addReaction",value:function(e,i){var a=this,s=e.isGroupChannel,o=e.channelUrl,l=e.messageId,u=e.key;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=s?S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(o)).replace("%s",encodeURIComponent(l)):S.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(o)).replace("%s",encodeURIComponent(l)),r=new k({reaction:u});a.post(t,r,i)}})}},{key:"deleteReaction",value:function(e,i){var a=this,s=e.isGroupChannel,o=e.channelUrl,l=e.messageId,u=e.key;this.sb.ConnectionManager.ready(function(e,n){if(e)i(e,null);else{var t=s?S.Path.GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(o)).replace("%s",encodeURIComponent(l)):S.Path.OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION.replace("%s",encodeURIComponent(o)).replace("%s",encodeURIComponent(l)),r=new k({reaction:u});a.delete(t,r,i)}})}},{key:"getAllEmoji",value:function(t){var r=this;this.sb.ConnectionManager.ready(function(e,n){e?t(e,null):r.get(S.Path.EMOJI_CATEGORIES,null,t)})}},{key:"getEmojiCategory",value:function(e,r){var i=this,a=e.categoryId;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.EMOJI_CATEGORIES_CATEGORYID.replace("%s",a);i.get(t,null,r)}})}},{key:"getEmoji",value:function(e,r){var i=this,a=e.emojiKey;this.sb.ConnectionManager.ready(function(e,n){if(e)r(e,null);else{var t=S.Path.EMOJIS_EMOJIKEY.replace("%s",a);i.get(t,null,r)}})}}],[{key:"Path",get:function(){return{USERS:"/users",USERS_USERID:"/users/%s",USERS_USERID_LOGIN:"/users/%s/login",USERS_USERID_METADATA:"/users/%s/metadata",USERS_USERID_METADATA_KEY:"/users/%s/metadata/%s",USERS_USERID_MARKASREADALL:"/users/%s/mark_as_read_all",USERS_USERID_MY_GROUP_CHANNEL_CHANGELOGS:"/users/%s/my_group_channels/changelogs",USERS_USERID_UNREAD_ITEM_COUNT:"/users/%s/unread_item_count",USERS_USERID_UNREAD_MESSAGE_COUNT:"/users/%s/unread_message_count",USERS_USERID_UNREAD_CHANNEL_COUNT:"/users/%s/unread_channel_count",USERS_USERID_PUSH_GCM_TOKEN:"/users/%s/push/gcm/%s",USERS_USERID_PUSH_GCM:"/users/%s/push/gcm",USERS_USERID_PUSH_DEVICE_TOKENS:"/users/%s/push/%s/device_tokens",USERS_USERID_PUSHPREFERENCE_CHANNELURL:"/users/%s/push_preference/%s",USERS_USERID_PUSHPREFERENCE:"/users/%s/push_preference/",USERS_USERID_PUSH_TEMPLATE:"/users/%s/push/template",USERS_USERID_BLOCK:"/users/%s/block",USERS_USERID_BLOCK_TARGETID:"/users/%s/block/%s",USERS_USERID_PUSH_APNS_TOKEN:"/users/%s/push/apns/%s",USERS_USERID_PUSH_APNS:"/users/%s/push/apns",USERS_USERID_PUSH:"/users/%s/push",USERS_USERID_GROUP_CHANNEL_INVITATION_PREFERENCE:"/users/%s/channel_invitation_preference",USERS_USERID_GROUP_CHANNEL_COUNT:"/users/%s/group_channel_count",USERS_COUNT_PREFERENCE:"/users/%s/count_preference/%s",OPENCHANNELS:"/open_channels",OPENCHANNELS_CHANNELURL:"/open_channels/%s",OPENCHANNELS_CHANNELURL_MESSAGES:"/open_channels/%s/messages",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID:"/open_channels/%s/messages/%s",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION:"/open_channels/%s/messages/%s/translation",OPENCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS:"/open_channels/%s/messages/changelogs",OPENCHANNELS_CHANNELURL_SCHEDULED_MESSAGES:"/open_channels/%s/scheduled_messages",OPENCHANNELS_CHANNELURL_PARTICIPANTS:"/open_channels/%s/participants",OPENCHANNELS_CHANNELURL_METADATA:"/open_channels/%s/metadata",OPENCHANNELS_CHANNELURL_METADATA_KEY:"/open_channels/%s/metadata/%s",OPENCHANNELS_CHANNELURL_METACOUNTER:"/open_channels/%s/metacounter",OPENCHANNELS_CHANNELURL_METACOUNTER_KEY:"/open_channels/%s/metacounter/%s",OPENCHANNELS_CHANNELURL_BAN:"/open_channels/%s/ban",OPENCHANNELS_CHANNELURL_BAN_USERID:"/open_channels/%s/ban/%s",OPENCHANNELS_CHANNELURL_MUTE:"/open_channels/%s/mute",OPENCHANNELS_CHANNELURL_MUTE_USERID:"/open_channels/%s/mute/%s",OPENCHANNELS_CHANNELURL_FREEZE:"/open_channels/%s/freeze",OPENCHANNELS_OPERATORS:"/open_channels/%s/operators",OPENCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION:"/open_channels/%s/messages/%s/reactions",GROUPCHANNELS:"/group_channels",MYGROUPCHANNELS:"/users/%s/my_group_channels",GROUPCHANNELS_CHANNELURL:"/group_channels/%s",GROUPCHANNELS_CHANNELURL_INVITE:"/group_channels/%s/invite",GROUPCHANNELS_CHANNELURL_ACCEPT_INVITATION:"/group_channels/%s/accept",GROUPCHANNELS_CHANNELURL_DECLINE_INVITATION:"/group_channels/%s/decline",GROUPCHANNELS_CHANNELURL_HIDE:"/group_channels/%s/hide",GROUPCHANNELS_CHANNELURL_LEAVE:"/group_channels/%s/leave",GROUPCHANNELS_CHANNELURL_JOIN:"/group_channels/%s/join",GROUPCHANNELS_CHANNELURL_MESSAGES:"/group_channels/%s/messages",GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASREAD:"/group_channels/%s/messages/mark_as_read",GROUPCHANNELS_CHANNELURL_MESSAGES_MARKASDELIVERED:"/group_channels/%s/messages/mark_as_delivered",GROUPCHANNELS_CHANNELURL_MESSAGES_TOTALCOUNT:"/group_channels/%s/messages/total_count",GROUPCHANNELS_CHANNELURL_MESSAGES_UNREADCOUNT:"/group_channels/%s/messages/unread_count",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID:"/group_channels/%s/messages/%s",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_TRANSLATION:"/group_channels/%s/messages/%s/translation",GROUPCHANNELS_CHANNELURL_MESSAGES_CHANGELOGS:"/group_channels/%s/messages/changelogs",GROUPCHANNELS_CHANNELURL_SCHEDULED_MESSAGES:"/group_channels/%s/scheduled_messages",GROUPCHANNELS_CHANNELURL_MEMBERS:"/group_channels/%s/members",GROUPCHANNELS_CHANNELURL_METADATA:"/group_channels/%s/metadata",GROUPCHANNELS_CHANNELURL_METADATA_KEY:"/group_channels/%s/metadata/%s",GROUPCHANNELS_CHANNELURL_METACOUNTER:"/group_channels/%s/metacounter",GROUPCHANNELS_CHANNELURL_METACOUNTER_KEY:"/group_channels/%s/metacounter/%s",GROUPCHANNELS_RESET_USER_HISTORY:"/group_channels/%s/reset_user_history",GROUPCHANNELS_OPERATORS:"/group_channels/%s/operators",GROUPCHANNELS_MEMBERS:"/group_channels/%s/members",GROUPCHANNELS_CHANNELURL_BAN:"/group_channels/%s/ban",GROUPCHANNELS_CHANNELURL_BAN_USERID:"/group_channels/%s/ban/%s",GROUPCHANNELS_CHANNELURL_MUTE:"/group_channels/%s/mute",GROUPCHANNELS_CHANNELURL_MUTE_USERID:"/group_channels/%s/mute/%s",GROUPCHANNELS_CHANNELURL_FREEZE:"/group_channels/%s/freeze",GROUPCHANNELS_CHANNELURL_MESSAGES_MESSAGEID_REACTION:"/group_channels/%s/messages/%s/reactions",STORAGE_FILE:"/storage/file",STORAGE_PROFILE:"/storage/profile_image",FRIENDS:"/users/%s/friends",FRIENDS_CHANGE_LOGS:"/users/%s/friends/changelogs",FRIENDS_DISCOVERIES:"/users/%s/friend_discoveries",SEARCH_MESSAGE:"/search/messages",REPORT_USERS:"/report/users/%s",REPORT_CHANNELS:"/report/%s/%s",REPORT_MESSAGES:"/report/%s/%s/messages/%s",EMOJIS_EMOJIKEY:"/emojis/%s",EMOJI_CATEGORIES:"/emoji_categories",EMOJI_CATEGORIES_CATEGORYID:"/emoji_categories/%s"}}}]),S}(),R=function(){function t(e,n){v(this,t),this.sb=e,this.ws=null,this.wsHost=null,this.WebSocket=null,this.handler=n||new t.ConnectionHandler,this.explicitDisconnect=!1,this.lastActiveMillis=0;try{this.WebSocket="undefined"==typeof WebSocket?r:WebSocket}catch(e){this.WebSocket=WebSocket}}return s(t,[{key:"connect",value:function(e,n,t){var i=this;_e.debug("WSClient connect called");var r=pe.get(this.sb._iid).container,a=r.pinger,s=r.auth,o=r.extensions,l=r.getUserAgentWithExtensions;this.wsHost=t;try{var u="/?p=JS&pv="+encodeURIComponent(he.OS_VERSION)+"&sv="+encodeURIComponent(he.SDK_VERSION)+"&ai="+encodeURIComponent(this.sb.getApplicationId());if(s.sessionKey?u+="&key="+encodeURIComponent(s.sessionKey):u+="&user_id="+encodeURIComponent(e)+"&access_token="+encodeURIComponent(n),u+="&active=1",u+="&SB-User-Agent="+encodeURIComponent(l(o)),u+="&Request-Sent-Timestamp="+(new Date).getTime().toString(),u+="&include_extra_data="+encodeURIComponent(["premium_feature_list","file_upload_size_limit","emoji_hash"].join(",")),this.ws=new this.WebSocket(this.wsHost+u),!this.ws)return this.sb.isReconnectingOnError=!0,void this.handler.onError("ws does not exist.")}catch(e){return this.sb.isReconnectingOnError=!0,void this.handler.onError(e)}try{this.sb.getDebugMode()&&"undefined"!=typeof window&&(window.ws=this.ws)}catch(e){_e.debug("window object does not exist.")}var c=!1;this.ws.onopen=function(e){_e.debug("WSClient onopen called"),i.handler.onOpen(e)},this.ws.onmessage=function(e){i.active();var n=e.data.split("\n");for(var t in n){var r=n[t];if(r&&"string"==typeof r){try{if("PONG"===r.substring(0,4)){a.pong();continue}}catch(e){_e.debug("ws.onmessage-command check error: ",e)}i.handler.onMessage(r)}}},this.ws.onerror=function(e){_e.debug("WSClient ws.onerror called: ",e),a&&a.stop(),c=!0,i.sb.isReconnectingOnError=!0,i.handler.onError(e)},this.ws.onclose=function(e){_e.debug("WSClient ws.onclose called - e, explicitDisconnect: ",e,i.explicitDisconnect),a&&a.stop(),i.explicitDisconnect?i.handler.onClose(e):c||i.handler.onError(e),i.explicitDisconnect=!1}}},{key:"disconnect",value:function(e,n){_e.debug("WSClient disconnect called [explicit]: ",e);var t=pe.get(this.sb._iid).container.pinger;t&&t.stop(),this.explicitDisconnect=!0===e,this.ws&&(this.ws.onopen=function(){},this.ws.onmessage=function(){},this.ws.onclose=function(){n&&n()},this.ws.onerror=function(){},this.ws.close(),this.ws=null),this.explicitDisconnect?this.handler.onClose():this.handler.onError(),this.explicitDisconnect=!1}},{key:"send",value:function(e,n){1!==this.ws.readyState?n&&n(new fe("Connection is not valid. Please reconnect.",fe.WEBSOCKET_CONNECTION_CLOSED),null):(this.ws.send(e.encode()),n&&n(null,null))}},{key:"active",value:function(){this.lastActiveMillis=(new Date).getTime()}},{key:"getConnectionState",value:function(){try{return 1===this.ws.readyState?this.sb.ConnectionState.OPEN:0===this.ws.readyState?this.sb.ConnectionState.CONNECTING:this.sb.ConnectionState.CLOSED}catch(e){return this.sb.ConnectionState.CLOSED}}}]),t}();R.ConnectionHandler=function(){return function e(){v(this,e),this.onReady=function(){},this.onOpen=function(){},this.onClose=function(){},this.onMessage=function(){},this.onError=function(){}}}(),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{value:Math.pow(2,53)-1});var T=function(){function n(e){v(this,n),this.sb=e,this.cls=D.get(this.sb._iid),this.ws=new R(this.sb),this.reconnectParams={interval:3,retryCount:3,multiplier:2,maxInterval:24},this.reconnectCount=0,this.reconnectDelay=0}return s(n,[{key:"connect",value:function(t,r){var i=this,e=pe.get(this.sb._iid).container,n=e.auth,a=e.apiClient,s=e.commandHandler,o=this.cls.GroupChannel,l=new R.ConnectionHandler;this.ws=new R(this.sb,l),l.onMessage=function(e){s.onRawCommandReceived(e)},this.sb.loginHandler=function(e,n){if(i.sb.connecting=!1,e)i.disconnect({clearSession:!0,err:e},null);else{clearInterval(i.sb.globalTimer);var t=function(){if(o.cachedChannels)for(var e in o.cachedChannels){var n=o.cachedChannels[e];if(n.invalidateTypingStatus())for(var t in i.sb.channelHandlers){i.sb.channelHandlers[t].onTypingStatusUpdated(n)}}};t(),i.sb.globalTimer=setInterval(function(){return t()},1e3),i.flushConnectionCallbacks(null,n),i.sb.connecting=!1,i.sb.reconnecting=!1,i.sb.ConnectionManager.processAllReadyHandler(null)}},l.onOpen=function(){i.sb.loginTimer=setTimeout(function(){i.sb.loginTimer=null,i.sb.onLoginTimerCancel=null,i.flushConnectionCallbacks(new fe("Connection timeout.",fe.LOGIN_TIMEOUT),null),i.sb.disconnect(null)},he.COMMAND_ACK_TIMEOUT),i.sb.onLoginTimerCancel=function(){i.flushConnectionCallbacks(new fe("Connection has been canceled.",fe.REQUEST_FAILED),null)},i.sb.connecting=!1},l.onError=function(e){_e.debug("WebSocketClient.ConnectionHandler.onError",e),n.sessionKey?(i.sb.isReconnectingOnError=!0,i.sb.ConnectionManager.errorAllReadyHandler(),i.reconnect(t,!0)):i.flushConnectionCallbacks(new fe("Websocket connection failed.",fe.WEBSOCKET_CONNECTION_FAILED),null),i.sb.connecting=!1},l.onClose=function(){_e.debug("WebSocketClient.ConnectionHandler.onClose"),i.sb.connecting=!1},a.checkRouting(function(e,n){if(e)return i.sb.connecting=!1,void i.flushConnectionCallbacks(new fe("Connection routing failed.",fe.REQUEST_FAILED),null);a.dummyCall(function(e){e&&_e.log("API dummy call failed",e)}),i.ws.connect(t,r,n.wsHost)})}},{key:"reconnect",value:function(t,e){var i=this,n=!(1<arguments.length&&void 0!==e)||e,r=pe.get(this.sb._iid).container,a=r.auth,s=r.apiClient,o=r.commandHandler,l=this.cls.OpenChannel;if(this.sb.reconnecting=!0,this.sb.reconnectTimer)_e.debug("still reconnecting");else{if(this.reconnectCount+=1,this.reconnectCount<=1){if(n)for(var u in this.sb.connectionHandlers){this.sb.connectionHandlers[u].onReconnectStarted()}this.reconnectDelay=0}else this.reconnectDelay=Math.min(1e3*this.reconnectParams.interval*Math.pow(this.reconnectParams.multiplier,this.reconnectCount-2),0<this.reconnectParams.maxInterval?1e3*this.reconnectParams.maxInterval:Number.MAX_SAFE_INTEGER);if(!t||!a.sessionKey||0<this.reconnectParams.retryCount&&this.reconnectCount>this.reconnectParams.retryCount){for(var c in this.disconnect({clearSession:!1,err:new fe("Websocket connection failed.",fe.WEBSOCKET_CONNECTION_FAILED)},null),this.reconnectCount=0,this.sb.connectionHandlers){this.sb.connectionHandlers[c].onReconnectFailed()}return this.sb.connecting=!1,this.sb.reconnecting=!1,this.sb.isReconnectingOnError=!1,void this.sb.ConnectionManager.errorAllReadyHandler()}this.sb.onReconnectTimerCancel=function(){i.reconnectCount=0},this.sb.reconnectTimer=setTimeout(function(){i.sb.reconnectTimer=null,i.sb.onReconnectTimerCancel=null,i.ws&&i.ws.disconnect(!0);var e=new R.ConnectionHandler;i.ws=new R(i.sb,e),i.sb.loginHandler=function(){for(var e in i.reconnectCount=0,i.sb.connecting=!1,i.sb.reconnecting=!1,i.sb.isReconnectingOnError=!1,i.sb.connectionHandlers){i.sb.connectionHandlers[e].onReconnectSucceeded()}if(i.sb.ConnectionManager.processAllReadyHandler(null),i.sb.isReconnectingOnError)for(var n in i.sb.ConnectionManager.networkHandlers)i.sb.ConnectionManager.networkHandlers[n].onReconnected();Object.keys(l.enteredChannels).forEach(function(r){l.enteredChannels[r].enter(function(e,n){if(e){var t=i.cls.FileMessageQueue;delete l.enteredChannels[r],t.delete(r)}})})},e.onOpen=function(){_e.debug("reconnect onOpen"),i.sb.loginTimer=setTimeout(function(){_e.debug("reconnect loginTimer timeout"),i.sb.loginTimer=null,i.reconnect(t,!0)},he.COMMAND_ACK_TIMEOUT),i.sb.onLoginTimerCancel=null,i.sb.reconnecting=!1},e.onMessage=function(e){o.onRawCommandReceived(e)},e.onError=function(e){_e.debug("reconnect onError",e),i.sb.isReconnectingOnError=!0,i.sb.ConnectionManager.errorAllReadyHandler(),i.reconnect(t,!0)},e.onClose=function(){_e.debug("reconnect onClose"),i.sb.reconnecting=!1},s.checkRouting(function(e,n){e?i.reconnect(t,!0):(i.sb.getCurrentApiHost()!==n.apiHost&&s.get("/",null,function(){}),i.ws.connect(t,null,n.wsHost))})},this.reconnectDelay)}}},{key:"disconnect",value:function(e,n){var t=pe.get(this.sb._iid),r=t.container.ackStateMap,i=this.cls,a=i.GroupChannel,s=i.OpenChannel,o=e.clearSession,l=e.err;if(this.sb.loginTimer&&(clearTimeout(this.sb.loginTimer),this.sb.onLoginTimerCancel&&(this.sb.onLoginTimerCancel(),this.sb.onLoginTimerCancel=null),this.sb.loginTimer=null),this.sb.reconnectTimer&&(clearTimeout(this.sb.reconnectTimer),this.sb.onReconnectTimerCancel&&(this.sb.onReconnectTimerCancel(),this.sb.onReconnectTimerCancel=null),this.sb.reconnectTimer=null),this.ws&&(this.reconnectCount=0,this.ws.disconnect(!0),this.ws=null),o){for(var u in s.clearEnteredChannels(),s.clearCache(),a.clearCache(),this.sb.globalTimer&&(clearInterval(this.sb.globalTimer),this.sb.globalTimer=null),r)clearTimeout(r[u].timer);this.sb.currentUser=null,t.set("ackStateMap",{}),t.set("subscribedUnreadMessageCount",{all:0,custom_types:{},ts:0}),t.set("auth",new E)}l&&(this.flushConnectionCallbacks(l,null),this.sb.connecting=!1,this.sb.reconnecting=!1,this.sb.isReconnectingOnError=!1),n&&n(null,null)}},{key:"flushConnectionCallbacks",value:function(n,t){var e=this.sb.connectionCallbacks;this.sb.connectionCallbacks=[],e.forEach(function(e){return e(n,t)})}}]),n}(),O=function(){function f(e){var n=e.type,t=e.nullable,r=void 0!==t&&t,i=e.optional,a=void 0!==i&&i,s=e.optionalIf,o=void 0===s?null:s,l=e.ignoreIf,u=void 0===l?null:l,c=e.defaultValue,d=void 0===c?null:c,h=e.constraint,p=void 0===h?null:h;v(this,f),this.type=n,this.nullable=r,this.optional=a,this.optionalIf=o,this.ignoreIf=u,this.defaultValue=d,this.constraint=p}return s(f,[{key:"isMatchingType",value:function(t){function n(e,n){return"string"==typeof n?de(e)===n||"array"===n&&Array.isArray(e)||"file"===n&&ge.isFile(e)||"null"===n&&null===e||"date"===n&&e instanceof Date:"function"==typeof n?e instanceof n:"object"===de(n)&&-1<Object.keys(n).map(function(e){return n[e]}).indexOf(t)}return n(t,this.type)||Array.isArray(this.type)&&this.type.some(function(e){return n(t,e)})||this.nullable&&null===t}}],[{key:"parse",value:function(e,n){for(e=f.toArray(e);void 0===e[e.length-1];)e.pop();var t=!1,r=null;"callback"===n[n.length-1].type&&("function"==typeof e[e.length-1]&&(r=e.pop()),n.pop(),t=!0);var i=[],a=null,s=0;for(var o in n){var l=n[o];"function"==typeof l.ignoreIf&&l.ignoreIf(e)?i.push(l.hasOwnProperty("defaultValue")?l.defaultValue:null):l.isMatchingType(e[s])?(l.nullable&&null===e[s]||!l.constraint||l.constraint(e[s])||(a=f.error),i.push(e[s]),s++):l.optional||"function"==typeof l.optionalIf&&l.optionalIf(e)?i.push(l.hasOwnProperty("defaultValue")?l.defaultValue:null):(a=f.error,i.push(e[s]),s++)}return t&&r&&i.push(r),e.length!==s&&(a=f.error),[a].concat(i)}},{key:"toArray",value:function(e){for(var n=[],t=0;t<e.length;t++)n.push(e[t]);return n}},{key:"error",get:function(){return new fe("Invalid parameter.",fe.INVALID_PARAMETER)}}]),f}(),L=function(){function n(e){v(this,n),this.sb=e,this.authCount=0,this.readyHandlers=[],this.networkHandlers={},this.authenticateTimer=1e4,this.authInfoRequester=null}return s(n,[{key:"addReadyHandler",value:function(e){e&&"function"==typeof e&&this.readyHandlers.push(e)}},{key:"ready",value:function(e,n){var t=!(1<arguments.length&&void 0!==n)||n,r=pe.get(this.sb._iid).container,i=r.auth,a=r.isInBackground;t&&i.hasSession()?e&&(this.sb.currentUser?e(null,this.sb.currentUser):(this.addReadyHandler(e),this.errorAllReadyHandler()),this.sb.getConnectionState()!==this.sb.ConnectionState.CLOSED||a||this.sb.reconnect()):(this.addReadyHandler(e),this.sb.isReconnectingOnError?this.errorAllReadyHandler():this.sb.getConnectionState()===this.sb.ConnectionState.OPEN?this.processAllReadyHandler(null):this.sb.getConnectionState()===this.sb.ConnectionState.CONNECTING||this.errorAllReadyHandler())}},{key:"processAllReadyHandler",value:function(n){if(0<this.readyHandlers.length){var t=this.sb.currentUser,e=this.readyHandlers;this.readyHandlers=[],e.forEach(function(e){e&&"function"==typeof e&&e(n,t)})}}},{key:"errorAllReadyHandler",value:function(){this.processAllReadyHandler(new fe("Connection should be made first.",fe.CONNECTION_REQUIRED))}},{key:"NetworkHandler",value:function(){this.onReconnected=function(){}}},{key:"addNetworkHandler",value:function(e,n){this.networkHandlers[e]=n}},{key:"removeNetworkHandler",value:function(e){delete this.networkHandlers[e]}},{key:"removeAllNetworkHandler",value:function(){this.networkHandlers={}}},{key:"authenticate",value:function(t){var r=this;if(this.sb.getConnectionState()===this.sb.ConnectionState.OPEN||this.sb.reconnecting)this.sb.connecting=!1,t(null,this.sb.currentUser);else if(this.authInfoRequester&&"function"==typeof this.authInfoRequester){this.sb.connecting=!0,this.authCount++;var i=setTimeout(function(){i=null,r.authCount--,0===r.authCount&&0===r.sb.connectionCallbacks.length&&(r.sb.connecting=!1),r.errorAllReadyHandler(),t(new fe("Connection should be made first.",fe.CONNECTION_REQUIRED),null)},this.authenticateTimer);this.authInfoRequester(function(e){if(i){clearTimeout(i),i=null,r.authCount--;var n=function(e){r.sb.connecting=!1,t(e,null)};e&&e.hasOwnProperty("userId")?e.accessToken?e.apiHost&&e.wsHost?r.sb.connect(e.userId,e.accessToken,e.apiHost,e.wsHost,n):r.sb.connect(e.userId,e.accessToken,n):e.apiHost&&e.wsHost?r.sb.connect(e.userId,e.apiHost,e.wsHost,n):r.sb.connect(e.userId,n):t(O.error,null)}})}else t(O.error,null)}}]),n}(),w=function(){function n(e){v(this,n),this.sb=e}return s(n,[{key:"onlineWorker",value:function(){try{if("undefined"!=typeof navigator&&navigator.onLine){var e=pe.get(this.sb._iid).container.auth;this.sb.reconnecting||this.sb.connecting||!e.sessionKey||this.sb.getConnectionState()===this.sb.ConnectionState.OPEN||this.sb.reconnect()}}catch(e){_e.debug("There is no window.addEventListener.ononline or navigator.onLine")}}},{key:"offlineWorker",value:function(){try{if("undefined"!=typeof navigator&&!navigator.onLine){var e=pe.get(this.sb._iid).container,n=e.auth,t=e.pinger;this.sb.reconnecting||this.sb.connecting||!n.sessionKey||(t&&t.stop(),this.sb.reconnect())}}catch(e){_e.debug("There is no window.addEventListener.ononline or navigator.onLine")}}},{key:"start",value:function(){try{"undefined"!=typeof window&&window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&"boolean"==typeof navigator.onLine&&(window.addEventListener("online",this.onlineWorker),window.addEventListener("offline",this.offlineWorker))}catch(e){_e.debug("There is no window.addEventListener.ononline or navigator.onLine")}}},{key:"stop",value:function(){try{window.removeEventListener("online",this.onlineWorker,!1),window.removeEventListener("offline",this.offlineWorker,!1)}catch(e){_e.debug("There is no window.addEventListener.ononline or navigator.onLine")}}}]),n}(),P=(new Date).getTime(),H=function(){function i(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;switch(v(this,i),this.command=e,this.requestId=t,arguments.length){case 1:if(!e||e.length<=4)this.command="NOOP",this.payload="{}";else if(this.decode(e),this.isRequestIdCommand){var r=this.getJsonElement();r&&(this.requestId=r.req_id||"")}break;case 2:case 3:!this.requestId&&this.isRequestIdCommand&&(this.requestId=i.generateRequestId()),n.req_id=this.requestId||"",this.payload=JSON.stringify(n)}}return s(i,[{key:"encode",value:function(){return this.command+this.payload+"\n"}},{key:"decode",value:function(e){e=e.trim(),this.command=e.substring(0,4),this.payload=e.substring(4)}},{key:"getJsonElement",value:function(){return JSON.parse(this.payload)}},{key:"isRequestIdCommand",get:function(){return this.isAckRequired||"EROR"===this.command}},{key:"isAckRequired",get:function(){return"MESG"===this.command||"FILE"===this.command||"ENTR"===this.command||"EXIT"===this.command||"READ"===this.command||"MEDI"===this.command||"FEDI"===this.command}}],[{key:"bPing",value:function(){return new this("PING",{id:(new Date).getTime(),active:1})}},{key:"bMessage",value:function(e){var n=e.channelUrl,t=e.message,r=e.data,i=e.customType,a=e.metaArrays,s=e.mentionType,o=e.mentionedUserIds,l=e.translationTargetLanguages,u=e.pushNotificationDeliveryOption,c=e.requestId,d=void 0===c?null:c,h=e.rootMessageId,p=void 0===h?null:h,f=e.parentMessageId,_=void 0===f?null:f,g=D.get(this._iid),y=g.UserMessageParams,m=g.BaseMessageParams,v={};return v.channel_url=n,v.message=t,v.data=r,a&&0<a.length&&(v.metaarray=a.map(function(e){return e.encode()})),s&&(v.mention_type=s),v.mentioned_user_ids=[],s===m.MentionType.CHANNEL?v.mentioned_user_ids=[]:Array.isArray(o)&&0<o.length&&(v.mentioned_user_ids=o),i&&(v.custom_type=i),l&&0<l.length&&(v.target_langs=l),u&&u!==y.PushNotificationDeliveryOption.DEFAULT&&(v.push_option=u),p&&(v.root_message_id=p),_&&(v.parent_message_id=_),new this("MESG",v,d)}},{key:"bFile",value:function(e){var n=e.channelUrl,t=e.url,r=e.name,i=e.type,a=e.size,s=e.data,o=e.customType,l=e.thumbnailSizes,u=e.requireAuth,c=e.metaArrays,d=e.mentionType,h=e.mentionedUserIds,p=e.pushNotificationDeliveryOption,f=e.requestId,_=void 0===f?null:f,g=e.rootMessageId,y=void 0===g?null:g,m=e.parentMessageId,v=void 0===m?null:m,C=D.get(this._iid),E=C.BaseMessageParams,U=C.FileMessageParams,b={};return b.channel_url=n,b.url=t,b.name=r||"",b.type=i||"",b.size=a||0,b.custom=s,o&&(b.custom_type=o),l&&(b.thumbnails=l),u&&(b.require_auth=u),c&&0<c.length&&(b.metaarray=c.map(function(e){return e.encode()})),d&&(b.mention_type=d),b.mentioned_user_ids=[],d===E.MentionType.CHANNEL?b.mentioned_user_ids=[]:Array.isArray(h)&&0<h.length&&(b.mentioned_user_ids=h),p&&p!==U.PushNotificationDeliveryOption.DEFAULT&&(b.push_option=p),y&&(b.root_message_id=y),v&&(b.parent_message_id=v),new this("FILE",b,_)}},{key:"bUpdateUserMessage",value:function(e){var n=e.channelUrl,t=e.messageId,r=e.message,i=void 0===r?null:r,a=e.data,s=void 0===a?null:a,o=e.customType,l=void 0===o?null:o,u=e.mentionType,c=void 0===u?null:u,d=e.mentionedUserIds,h=void 0===d?null:d,p=e.metaArrayParams,f=void 0===p?null:p,_=D.get(this._iid).BaseMessageParams,g={};return g.channel_url=n,g.msg_id=t,null!=i&&void 0!==i&&(g.message=i),null!=s&&void 0!==s&&(g.data=s),null!=l&&void 0!==l&&(g.custom_type=l),c&&(g.mention_type=c),c===_.MentionType.CHANNEL?g.mentioned_user_ids=[]:Array.isArray(h)&&0<h.length&&(g.mentioned_user_ids=h),f&&(g.metaarray=f),new this("MEDI",g)}},{key:"bUpdateFileMessage",value:function(e){var n=e.channelUrl,t=e.messageId,r=e.data,i=void 0===r?null:r,a=e.customType,s=void 0===a?null:a,o=e.mentionType,l=void 0===o?null:o,u=e.mentionedUserIds,c=void 0===u?null:u,d=e.metaArrayParams,h=void 0===d?null:d,p=D.get(this._iid).BaseMessageParams,f={};return f.channel_url=n,f.msg_id=t,null!=i&&void 0!==i&&(f.data=i),null!=s&&void 0!==s&&(f.custom_type=s),l&&(f.mention_type=l),l===p.MentionType.CHANNEL?f.mentioned_user_ids=[]:Array.isArray(c)&&0<c.length&&(f.mentioned_user_ids=c),h&&(f.metaarray=h),new this("FEDI",f)}},{key:"bRead",value:function(e){var n=e.channelUrl,t={};return t.channel_url=n,new this("READ",t)}},{key:"bMessageAck",value:function(e){var n=e.channelUrl,t=e.messageId,r={};return r.channel_url=n,r.msg_id=t,new this("MACK",r)}},{key:"bTypeStart",value:function(e){var n=e.channelUrl,t=e.time,r={};return r.channel_url=n,r.time=t,new this("TPST",r)}},{key:"bTypeEnd",value:function(e){var n=e.channelUrl,t=e.time,r={};return r.channel_url=n,r.time=t,new this("TPEN",r)}},{key:"bEnter",value:function(e){var n=e.channelUrl,t={};return t.channel_url=n,new this("ENTR",t)}},{key:"bExit",value:function(e){var n=e.channelUrl,t={};return t.channel_url=n,new this("EXIT",t)}},{key:"generateRequestId",value:function(){return P++,String(P)}}]),i}(),F=new WeakMap,ye=function(){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};v(this,r);var n=[];if(e.hasOwnProperty("premium_feature_list"))try{var t=JSON.parse(e.premium_feature_list);n.push.apply(n,b(t))}catch(e){}F.set(this,{emojiHash:e.hasOwnProperty("emoji_hash")?e.emoji_hash:"",uploadSizeLimit:e.hasOwnProperty("file_upload_size_limit")?1048576*e.file_upload_size_limit:Number.MAX_VALUE,useReaction:e.hasOwnProperty("use_reaction")&&e.use_reaction,premiumFeatureList:n})}return s(r,[{key:"emojiHash",get:function(){return F.get(this).emojiHash}},{key:"uploadSizeLimit",get:function(){return F.get(this).uploadSizeLimit}},{key:"premiumFeatureList",get:function(){return F.get(this).premiumFeatureList}},{key:"isUsingReaction",get:function(){return F.get(this).useReaction}}]),r}(),G=function(){function e(){v(this,e),this.messageId=null,this.userId=null,this.key=null,this.operation="",this.updatedAt=null}return s(e,null,[{key:"createFromJson",value:function(e){var n=e.msg_id,t=e.user_id,r=e.operation,i=e.reaction,a=e.updated_at;if(("string"==typeof n||"number"==typeof n)&&n&&"string"==typeof t&&"string"==typeof r&&0<=["add","delete"].indexOf(r.toLowerCase())&&"string"==typeof i&&i&&"number"==typeof a){var s=new this;return s.messageId=parseInt(n),s.userId=t,s.key=i,s.operation=r.toLowerCase(),s.updatedAt=a,s}return null}}]),e}();var q=function(){function e(){v(this,e)}return s(e,null,[{key:"serialize",value:function(e,n){var t=1<arguments.length&&void 0!==n?n:null,r=JSON.parse(JSON.stringify(e));return t&&t(r),function n(t){return Object.keys(t).forEach(function(e){t[e]&&"object"===de(t[e])&&n(t[e])}),Object.freeze(t)}(r)}},{key:"deserialize",value:function(e,n){var t=1<arguments.length&&void 0!==n?n:null,r=JSON.parse(JSON.stringify(e));return t&&t(r),r}}]),e}(),B=0,x=1,z=2;"undefined"==typeof Promise&&(Promise=function(){function l(e){var n=this;v(this,l),this.state=B,this._value=null,this._reason=null;if("function"!=typeof e)throw"Promise resolver ".concat(e," is not a function");e(function(e){n.state===B&&(n.state=x,n._value=e)},function(e){n.state===B&&(n.state=z,n._reason=e)})}return s(l,[{key:"then",value:function(e,n){var t=this,r=this;switch(this.state){case B:setTimeout(function(){return t.then(e,n)},100);break;case x:e&&"function"==typeof e&&(r=e(this._value));break;case z:n&&"function"==typeof n&&(r=n(this._reason))}return r instanceof l?r:this}},{key:"catch",value:function(e){var n=this,t=this;switch(this.state){case B:setTimeout(function(){return n.catch(e)},100);break;case x:break;case z:t=e(this._reason)}return t instanceof l?t:this}},{key:"finally",value:function(e){var n=this,t=this;switch(this.state){case B:setTimeout(function(){return n.finally(e)},100);break;case x:case z:t=e()}return t instanceof l?t:this}},{key:"length",get:function(){return 1}}],[{key:"all",value:function(o){return new l(function(r,i){if(Array.isArray(o)||"string"==typeof o)if(0<o.length){var e=[];for(var n in o)o[n]instanceof l?e.push(o[n]):e.push(l.resolve(o[n]));var a=new Array(e.length).fill(null),s=e.length,t=function(e,n,t){n?i(n):(s--,a[e]=t,s<=0&&r(a))};e.forEach(function(e,n){e.then(function(e){t(n,null,e)}).catch(function(e){t(n,e,null)})})}else r([]);else i(new Error("Uncaught (in promise) TypeError: ".concat(de(o)," ").concat(o," is not iterable")))})}},{key:"resolve",value:function(n){return new l(function(e){e(n)})}},{key:"reject",value:function(t){return new l(function(e,n){n(t)})}}]),l}());function j(t,e,r){return void 0===r?new Promise(function(t,r){e(function(e,n){return e?r(e):t(n)})}):e(function(e,n){r&&(pe.get(t).container.isErrorFirstInCallback?r(e,n):r(n,e))})}var Q={TIMESTAMP:"timestamp",MESSAGE_ID:"messageId"},Y=new WeakMap,K=function(){function n(e){v(this,n),this.messageId=0,this.messageType=n.MESSAGE_TYPE_BASE,this.channelUrl="",this.data=null,this.customType=null,this.createdAt=0,this.updatedAt=0,this.channelType=null,this.metaArrays=[],this.reactions=[],this.mentionType=null,this.mentionedUsers=[],Y.set(this,0),this.parentMessageId=0,this.parentMessageText=null,this.threadInfo=null,e&&this.__update(e)}return s(n,[{key:"serialize",value:function(){return q.serialize(this,function(e){e.hasOwnProperty("_sender")&&(e.sender=e._sender,delete e._sender)})}},{key:"isIdentical",value:function(e){return!("object"!==de(e)||!e.hasOwnProperty("messageId"))&&(0!==this.messageId&&0!==e.messageId?this.messageId===e.messageId:this.reqId===e.reqId)}},{key:"isEqual",value:function(e){return ge.deepEqual(this,e)}},{key:"isOpenChannel",value:function(){var e=D.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_OPEN}},{key:"isGroupChannel",value:function(){var e=D.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_GROUP}},{key:"isUserMessage",value:function(){return this.messageType===n.MESSAGE_TYPE_USER}},{key:"isAdminMessage",value:function(){return this.messageType===n.MESSAGE_TYPE_ADMIN}},{key:"isFileMessage",value:function(){return this.messageType===n.MESSAGE_TYPE_FILE}},{key:"__update",value:function(e){var t=this,n=D.get(this._iid),r=n.User,i=n.BaseChannel,a=n.BaseMessageParams,s=n.Reaction,o=n.MessageMetaArray,l=n.ThreadInfo;e.hasOwnProperty("msg_id")&&(this.messageId=parseInt(e.msg_id)),e.hasOwnProperty("message_id")&&(this.messageId=parseInt(e.message_id)),this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?String(e.custom_type):"",this.createdAt=e.hasOwnProperty("ts")?parseInt(e.ts):0,e.hasOwnProperty("created_at")&&(this.createdAt=parseInt(e.created_at)),this.updatedAt=e.hasOwnProperty("updated_at")?parseInt(e.updated_at):0,this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):i.CHANNEL_TYPE_GROUP;var u=e.hasOwnProperty("metaarray")?e.metaarray:{},c=e.hasOwnProperty("metaarray_key_order")?e.metaarray_key_order:Object.keys(u).sort(function(e,n){return e.localeCompare(n)});this.metaArrays=[];for(var d=0;d<c.length;d++){var h=c[d];this.metaArrays.push(new o(h,u[h]||[]))}if(e.hasOwnProperty("sorted_metaarray")){var p=e.sorted_metaarray;Array.isArray(p)&&(this.metaArrays=p.map(function(e){return new o(e.key,e.value)}))}if(this.reactions=[],e.hasOwnProperty("reactions")&&Array.isArray(e.reactions))for(var f in e.reactions){var _=s.createFromJson(e.reactions[f]);_&&this.reactions.push(_)}this.mentionType=e.hasOwnProperty("mention_type")?e.mention_type:a.MentionType.USERS,this.mentionedUsers=[],e.hasOwnProperty("mentioned_users")&&e.mentioned_users.forEach(function(e){var n=new r(e);t.mentionedUsers.push(n)});e.hasOwnProperty("root_message_id")&&Y.set(this,parseInt(e.root_message_id)),e.hasOwnProperty("parent_message_id")&&(this.parentMessageId=parseInt(e.parent_message_id)),e.hasOwnProperty("parent_message_text")&&(this.parentMessageText=e.parent_message_text),this.threadInfo=new l(e.thread_info)}},{key:"getMetaArraysByKeys",value:function(n){return Array.isArray(n)?this.metaArrays.filter(function(e){return-1<n.indexOf(e.key)}):[]}},{key:"getMetaArrayByKeys",value:function(e){var n={};return this.getMetaArraysByKeys(e).forEach(function(e){n[e.key]=e.value}),n}},{key:"applyReactionEvent",value:function(e){var n,t=this,r=D.get(this._iid).Reaction,i=C(O.parse(arguments,[new O({type:G,constraint:function(e){return parseInt(e.messageId)===parseInt(t.messageId)}})]),2);if(n=i[0],e=i[1],!n){var a=!1;for(var s in this.reactions)if(this.reactions[s].key===e.key){this.reactions[s]._applyEvent(e),this.reactions[s].isEmpty&&this.reactions.splice(s,1),a=!0;break}a||"add"!==e.operation||this.reactions.push(new r(e.key,[e.userId],e.updatedAt))}}},{key:"_getThreadedMessageList",value:function(r,i,a,e){var n,o=this,t=D.get(this._iid).ThreadedMessageListParams,s=C(O.parse(arguments,[new O({type:"number"}),new O({type:"string",constraint:function(e){return Object.values(Q).includes(e)}}),new O({type:t,constraint:function(e){return e._validate()}}),new O({type:"callback"})]),5);return n=s[0],r=s[1],i=s[2],a=s[3],e=s[4],j(this._iid,function(s){if(n)s(n,null);else{var e=D.get(o._iid).GroupChannel;o.isGroupChannel()&&e.getChannel(o.channelUrl,function(e,n){if(SendBird.getInstance(o._iid).getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}n?s(n,null):pe.get(o._iid).container.apiClient.getMessageList(_(_({channel:e,token:r,tokenType:i},a),{},{shouldReverse:a.reverse,rootMessageId:o.messageId,includeReplies:!0,includeThreadInfo:!0}),function(e,n){if(e)s(e,null);else{var t=D.get(o._iid).BaseChannel,r=n.messages.map(function(e){return t.buildMessage(e,o)}).filter(function(e){return null!==e}),i=r.filter(function(e){return e.messageId===o.messageId})[0],a=r.filter(function(e){return e.parentMessageId===o.messageId});s(null,{parentMessage:i,threadedReplies:a})}})})}},e)}},{key:"getThreadedMessagesByTimestamp",value:function(e,n,t){return this._getThreadedMessageList(e,Q.TIMESTAMP,n,t)}},{key:"applyThreadInfoUpdateEvent",value:function(e){var n,t=D.get(this._iid),r=t.ThreadInfo,i=t.ThreadInfoUpdateEvent,a=Y.get(this),s=C(O.parse(arguments,[new O({type:i,constraint:function(e){return parseInt(e.targetMessageId)===parseInt(a)}})]),2);if(n=s[0],e=s[1],n)return!1;var o=e.threadInfo;return this.threadInfo=new r(o),!0}},{key:"metaArray",get:function(){var n={};return this.metaArrays.forEach(function(e){n[e.key]=e.value}),n},set:function(e){if("object"===de(e)&&e){var n=D.get(this._iid).MessageMetaArray,t=[];for(var r in e)t.push(new n(r,e[r]));this.metaArrays=t}}}],[{key:"getMessage",value:function(t,e){var n,a=this,r=D.get(this._iid),s=r.BaseChannel,i=r.MessageRetrievalParams,o=C(O.parse(arguments,[new O({type:i,constraint:function(e){return e._validate()}}),new O({type:"callback"})]),3);return n=o[0],t=o[1],e=o[2],j(this._iid,function(i){if(n)i(n,null);else{var e=D.get(a._iid).GroupChannel;t.channelType===s.CHANNEL_TYPE_GROUP&&e.getChannel(t.channelUrl,function(r,e){if(SendBird.getInstance(a._iid).getErrorFirstCallback()){var n=[r,e];e=n[0],r=n[1]}e?i(e,null):pe.get(a._iid).container.apiClient.getMessage(_({channel:r},t),function(e,n){if(e)i(e,null);else{var t=s.buildMessage(n,r);i(null,t)}})})}},e)}},{key:"MESSAGE_TYPE_BASE",get:function(){return"base"}},{key:"MESSAGE_TYPE_ADMIN",get:function(){return"admin"}},{key:"MESSAGE_TYPE_USER",get:function(){return"user"}},{key:"MESSAGE_TYPE_FILE",get:function(){return"file"}},{key:"SendingStatus",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",CANCELED:"canceled",SUCCEEDED:"succeeded"}}}]),n}(),V=function(){function n(e){v(this,n),this.nickname="",this.profileUrl="",this.userId="",this.connectionStatus="",this.lastSeenAt=null,this.metaData={},this.isActive=!0,this.friendDiscoveryKey=null,this.friendName=null,this._preferredLanguages=null,e&&this.__update(e)}return s(n,[{key:"__update",value:function(e){e.hasOwnProperty("guest_id")&&(this.userId=String(e.guest_id)),e.hasOwnProperty("user_id")&&(this.userId=String(e.user_id)),e.hasOwnProperty("name")&&(this.nickname=String(e.name)),e.hasOwnProperty("nickname")&&(this.nickname=String(e.nickname)),e.hasOwnProperty("image")&&(this.profileUrl=String(e.image)),e.hasOwnProperty("profile_url")&&(this.profileUrl=String(e.profile_url)),e.hasOwnProperty("is_online")?e.is_online===n.NON_AVAILABLE?this.connectionStatus=n.NON_AVAILABLE:this.connectionStatus=e.is_online?n.ONLINE:n.OFFLINE:this.connectionStatus=n.NON_AVAILABLE,e.hasOwnProperty("last_seen_at")?this.lastSeenAt=parseInt(e.last_seen_at):this.lastSeenAt=0,e.hasOwnProperty("metadata")?this.metaData=e.metadata:this.metaData={},e.hasOwnProperty("is_active")?this.isActive=void 0===e.is_active||e.is_active:this.isActive=!0,e.hasOwnProperty("friend_discovery_key")?this.friendDiscoveryKey=e.friend_discovery_key:this.friendDiscoveryKey=null,e.hasOwnProperty("friend_name")?this.friendName=e.friend_name:this.friendName=null,e.hasOwnProperty("preferred_languages")?this._preferredLanguages=e.preferred_languages||null:this._preferredLanguages=null}},{key:"_updateMetaData",value:function(e,n){var t=1<arguments.length&&void 0!==n&&n,r=D.get(this._iid).GroupChannel;for(var i in e)t?delete this.metaData[i]:this.metaData[i]=e[i];for(var a in r.cachedChannels)if(r.cachedChannels.hasOwnProperty(a)){var s=r.cachedChannels[a];if(s.memberMap.hasOwnProperty(this.userId))s.memberMap[this.userId].metaData=this.metaData}}},{key:"serialize",value:function(){return q.serialize(this,function(e){e.hasOwnProperty("_preferredLanguages")&&(e.preferredLanguages=e._preferredLanguages,delete e._preferredLanguages)})}},{key:"getOriginalProfileUrl",value:function(){var e="";if((-1<(e=(e=-1<this.profileUrl.indexOf("://")?this.profileUrl.split("/")[2]:this.profileUrl.split("/")[0]).split("?")[0]).indexOf("sendbird.com")||-1<e.indexOf("intoz.com")||-1<e.indexOf("file-local"))&&-1<this.profileUrl.indexOf(e+"/profile_images/")){var n=this.profileUrl.replace("profile_images/","");return n===this.profileUrl?"":n}return""}},{key:"createMetaData",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"object",constraint:function(e){return 0<Object.keys(e).length&&!Array.isArray(e)}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.createUserMetaData({metaData:e},function(e,n){e||i._updateMetaData(n),t(e,n)})},n)}},{key:"updateMetaData",value:function(e,n,t){var r,i=this,a=C(O.parse(arguments,[new O({type:"object",constraint:function(n){return!Array.isArray(n)&&0<Object.keys(n).length&&Object.keys(n).map(function(e){return n[e]}).every(function(e){return"string"==typeof e})}}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"callback"})]),4);return r=a[0],e=a[1],n=a[2],t=a[3],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.updateUserMetaData({metaData:e,upsert:n},function(e,n){e||i._updateMetaData(n),t(e,n)})},t)}},{key:"deleteMetaData",value:function(e,n){var i,a=this,t=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),3);return i=t[0],e=t[1],n=t[2],j(this._iid,function(t){if(i)t(i,null);else{var r={};r[e]="",pe.get(a._iid).container.apiClient.deleteUserMetaData({metaDataKey:e},function(e,n){e||a._updateMetaData(r,!0),t(e,n)})}},n)}},{key:"deleteAllMetaData",value:function(e){var i=this;return j(this._iid,function(t){var r=i.metaData;pe.get(i._iid).container.apiClient.deleteAllUserMetaData({},function(e,n){e||i._updateMetaData(r,!0),t(e,n)})},e)}},{key:"preferredLanguages",get:function(){return this._preferredLanguages}}],[{key:"build",value:function(e,n,t,r,i,a,s,o,l,u){return{user_id:e,nickname:n,profile_url:t,is_online:r,last_seen_at:i,metadata:a,is_active:s,friend_discovery_key:o,friend_name:l,preferred_languages:u}}},{key:"buildFromSerializedData",value:function(e){var n=D.get(this._iid).User,t=q.deserialize(e);return new n(n.build.apply(n,b(["userId","nickname","profileUrl","connectionStatus","lastSeenAt","metaData","isActive","friendDiscoveryKey","friendName","preferredLanguages"].map(function(e){return t[e]}))))}},{key:"NON_AVAILABLE",get:function(){return"nonavailable"}},{key:"ONLINE",get:function(){return"online"}},{key:"OFFLINE",get:function(){return"offline"}}]),n}(),W={TIMESTAMP:"timestamp",MESSAGE_ID:"messageId"},J=function(){function n(e){v(this,n),this.url="",this.channelType=n.CHANNEL_TYPE_BASE,this.name="",this.coverUrl="",this.createdAt=0,this.data=null,this.customType=null,this.isFrozen=!1,this.isEphemeral=!1,e&&(this.__update(e),e.__wk&&(this.__wk=e.__wk))}return s(n,[{key:"__update",value:function(e){this.url=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.name=e.hasOwnProperty("name")?String(e.name):"",this.coverUrl=e.hasOwnProperty("cover_url")?String(e.cover_url):"",this.createdAt=e.hasOwnProperty("created_at")?1e3*e.created_at:0,this.data=e.hasOwnProperty("data")?String(e.data):"",this.customType=e.hasOwnProperty("custom_type")?e.custom_type:"",this.isFrozen=!!e.hasOwnProperty("freeze")&&e.freeze,this.isEphemeral=!!e.hasOwnProperty("is_ephemeral")&&e.is_ephemeral}},{key:"isGroupChannel",value:function(){var e=D.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_GROUP}},{key:"isOpenChannel",value:function(){var e=D.get(this._iid).BaseChannel;return this.channelType===e.CHANNEL_TYPE_OPEN}},{key:"createOperatorListQuery",value:function(){return new(D.get(this._iid).OperatorListQuery)(this)}},{key:"createMessageListQuery",value:function(){return new(D.get(this._iid).MessageListQuery)(this)}},{key:"createPreviousMessageListQuery",value:function(){return new(D.get(this._iid).PreviousMessageListQuery)(this)}},{key:"serialize",value:function(){return q.serialize(this,function(e){if(null!==e.lastMessage&&"object"===de(e.lastMessage)){var n=e.lastMessage;n.hasOwnProperty("_sender")&&(n.sender=n._sender,delete n._sender,e.lastMessage=n)}e.hasOwnProperty("_messageOffsetTimestamp")&&(e.messageOffsetTimestamp=e._messageOffsetTimestamp,delete e._messageOffsetTimestamp)})}},{key:"getMessageChangeLogsByTimestamp",value:function(e,n,t,r){var a,s=this,i=C(O.parse(arguments,[new O({type:"number",constraint:function(e){return 0<=e}}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"callback"})]),5);return a=i[0],e=i[1],n=i[2],t=i[3],r=i[4],j(this._iid,function(i){a?i(a,null):pe.get(s._iid).container.apiClient.getMessageChangeLogs({channelUrl:s.url,ts:e,token:null,isOpenChannel:s.isOpenChannel(),includeMetaArray:n,includeReaction:t},function(e,n){var t=null;if(!e){var r=D.get(s._iid).BaseChannel;t={updatedMessages:n.updated.map(function(e){return r.buildMessage(e,s)}),deletedMessageIds:n.deleted.map(function(e){return e.message_id}),hasMore:n.has_more,token:n.next}}i(e,t)})},r)}},{key:"getMessageChangeLogsByToken",value:function(e,n,t,r){var a,s=this,i=C(O.parse(arguments,[new O({type:"string",nullable:!0}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"callback"})]),5);return a=i[0],e=i[1],n=i[2],t=i[3],r=i[4],j(this._iid,function(i){a?i(a,null):pe.get(s._iid).container.apiClient.getMessageChangeLogs({channelUrl:s.url,ts:null,token:e,isOpenChannel:s.isOpenChannel(),includeMetaArray:n,includeReaction:t},function(e,n){var t=null;if(!e){var r=D.get(s._iid).BaseChannel;t={updatedMessages:n.updated.map(function(e){return r.buildMessage(e,s)}),deletedMessageIds:n.deleted.map(function(e){return e.message_id}),hasMore:n.has_more,token:n.next}}i(e,t)})},r)}},{key:"getMessageChangeLogsSinceToken",value:function(e,n,t){var i,a=this,r=D.get(this._iid),s=r.BaseChannel,o=r.MessageChangeLogsParams,l=C(O.parse(arguments,[new O({type:"string",nullable:!0}),new O({type:o}),new O({type:"callback"})]),4);return i=l[0],e=l[1],n=l[2],t=l[3],j(this._iid,function(r){i?r(i,null):pe.get(a._iid).container.apiClient.getMessageChangeLogs(_({channelUrl:a.url,ts:null,token:e,isOpenChannel:a.isOpenChannel()},n),function(e,n){var t=null;e||(t={updatedMessages:n.updated.map(function(e){return s.buildMessage(e,a)}),deletedMessageIds:n.deleted.map(function(e){return e.message_id}),hasMore:n.has_more,token:n.next}),r(e,t)})},t)}},{key:"getMessageChangeLogsSinceTimestamp",value:function(e,n,t){var i,a=this,r=D.get(this._iid),s=r.BaseChannel,o=r.MessageChangeLogsParams,l=C(O.parse(arguments,[new O({type:"number",constraint:function(e){return 0<=e}}),new O({type:o}),new O({type:"callback"})]),4);return i=l[0],e=l[1],n=l[2],t=l[3],j(this._iid,function(r){i?r(i,null):pe.get(a._iid).container.apiClient.getMessageChangeLogs(_({channelUrl:a.url,timestamp:e,token:null,isOpenChannel:a.isOpenChannel()},n),function(e,n){var t=null;e||(t={updatedMessages:n.updated.map(function(e){return s.buildMessage(e,a)}),deletedMessageIds:n.deleted.map(function(e){return e.message_id}),hasMore:n.has_more,token:n.next}),r(e,t)})},t)}},{key:"getMyMutedInfo",value:function(e){var n=this;return j(this._iid,function(r){var e=En.getInstance(n._iid);pe.get(n._iid).container.apiClient.getMyMutedInfo({channelUrl:n.url,userId:e.currentUser?e.currentUser.userId:null,isGroupChannel:n.isGroupChannel()},function(e,n){var t=null;e||(t={isMuted:n.is_muted,startAt:n.start_at,endAt:n.end_at,remainingDuration:n.remaining_duration,description:n.description}),r(e,t)})},e)}},{key:"_parseMessageListParams",value:function(e){for(var n=new(D.get(this._iid).MessageListParams),t=null,r=!1,i=0,a=0,s=!1,o="",l="",u=null,c=!1,d=!1,h=null,p=arguments.length,f=new Array(1<p?p-1:0),_=1;_<p;_++)f[_-1]=arguments[_];switch(e){case"prev":var g=C(O.parse(f,[new O({type:"number"}),new O({type:"boolean"}),new O({type:"number"}),new O({type:"boolean"}),new O({type:"string"}),new O({type:"string"}),new O({type:"array",optional:!0}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"callback"})]),11);t=g[0],g[1],r=g[2],i=g[3],s=g[4],o=g[5],l=g[6],u=g[7],c=g[8],d=g[9],h=g[10];break;case"next":var y=C(O.parse(f,[new O({type:"number"}),new O({type:"boolean"}),new O({type:"number"}),new O({type:"boolean"}),new O({type:"string"}),new O({type:"string"}),new O({type:"array",optional:!0}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"callback"})]),11);t=y[0],y[1],r=y[2],a=y[3],s=y[4],o=y[5],l=y[6],u=y[7],c=y[8],d=y[9],h=y[10];break;case"prevnext":var m=C(O.parse(f,[new O({type:"number"}),new O({type:"number"}),new O({type:"number"}),new O({type:"boolean"}),new O({type:"string"}),new O({type:"string"}),new O({type:"array",optional:!0}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"callback"})]),11);t=m[0],m[1],i=m[2],a=m[3],s=m[4],o=m[5],l=m[6],u=m[7],c=m[8],d=m[9],h=m[10],r=!0}return t?[null,h]:(n.isInclusive=r,n.prevResultSize=i,n.nextResultSize=a,n.reverse=s,n.messageType=o,n.customType=l,n.senderUserIds=u,n.includeMetaArray=c,n.includeReaction=d,[n,h])}},{key:"_getMessageList",value:function(e,n,t,r){var a,s=this,i=D.get(this._iid).MessageListParams,o=C(O.parse(arguments,[new O({type:"number"}),new O({type:"string",constraint:function(e){return Object.values(W).includes(e)}}),new O({type:i,constraint:function(e){return e._validate()}}),new O({type:"callback"})]),5);return a=o[0],e=o[1],n=o[2],t=o[3],r=o[4],j(this._iid,function(i){a?i(a,null):pe.get(s._iid).container.apiClient.getMessageList(_(_({channel:s,token:e,tokenType:n},t),{},{shouldReverse:t.reverse}),function(e,n){if(e)i(e,null);else{var t=D.get(s._iid).BaseChannel,r=n.messages.map(function(e){return t.buildMessage(e,s)}).filter(function(e){return null!==e});i(null,r)}})},r)}},{key:"getPreviousMessagesByTimestamp",value:function(e){var n=C(this._parseMessageListParams.apply(this,["prev"].concat(b(O.toArray(arguments)))),2),t=n[0],r=n[1];return this._getMessageList(e,W.TIMESTAMP,t,r)}},{key:"getNextMessagesByTimestamp",value:function(e){var n=C(this._parseMessageListParams.apply(this,["next"].concat(b(O.toArray(arguments)))),2),t=n[0],r=n[1];return this._getMessageList(e,W.TIMESTAMP,t,r)}},{key:"getPreviousAndNextMessagesByTimestamp",value:function(e){var n=C(this._parseMessageListParams.apply(this,["prevnext"].concat(b(O.toArray(arguments)))),2),t=n[0],r=n[1];return this._getMessageList(e,W.TIMESTAMP,t,r)}},{key:"getPreviousMessagesByID",value:function(e){var n=C(this._parseMessageListParams.apply(this,["prev"].concat(b(O.toArray(arguments)))),2),t=n[0],r=n[1];return this._getMessageList(e,W.MESSAGE_ID,t,r)}},{key:"getNextMessagesByID",value:function(e){var n=C(this._parseMessageListParams.apply(this,["next"].concat(b(O.toArray(arguments)))),2),t=n[0],r=n[1];return this._getMessageList(e,W.MESSAGE_ID,t,r)}},{key:"getPreviousAndNextMessagesByID",value:function(e){var n=C(this._parseMessageListParams.apply(this,["prevnext"].concat(b(O.toArray(arguments)))),2),t=n[0],r=n[1];return this._getMessageList(e,W.MESSAGE_ID,t,r)}},{key:"getMessagesByTimestamp",value:function(e,n,t){return this._getMessageList(e,W.TIMESTAMP,n,t)}},{key:"getMessagesByMessageId",value:function(e,n,t){return this._getMessageList(e,W.MESSAGE_ID,n,t)}},{key:"_sendUserMessage",value:function(e){var s=this,n=e.message,t=e.data,r=e.customType,i=e.metaArrays,a=e.mentionType,o=e.mentionedUserIds,l=e.translationTargetLanguages,u=e.pushNotificationDeliveryOption,c=e.reqId,d=e.rootMessageId,h=e.parentMessageId,p=e.callback,f=D.get(this._iid),_=f.Command,g=f.GroupChannel,y=f.UserMessage;c=c||_.generateRequestId();var m=En.getInstance(this._iid),v=y.build(c,0,m.currentUser,this,n,t,r,l,!1,(new Date).getTime(),0,i,null,a,null,d,h,null,null,o),C=new y(v);if(C.requestState=m.MessageRequestState.PENDING,C.sendingStatus=m.MessageSendingStatus.PENDING,C.requestedMentionUserIds=o,!m.currentUser){var E=new fe("Connection should be made first.",fe.CONNECTION_REQUIRED),U=new y(v);return U.requestState=m.MessageRequestState.FAILED,U.sendingStatus=m.MessageSendingStatus.FAILED,U.requestedMentionUserIds=o,U.errorCode=E.code,p(E,U),C}var b=_.bMessage({channelUrl:this.url,message:n,data:t,customType:r,metaArrays:i,mentionType:a,mentionedUserIds:o,translationTargetLanguages:l,pushNotificationDeliveryOption:u,requestId:c,rootMessageId:d,parentMessageId:h});(C.reqId=b.requestId,this.isGroupChannel()&&m.getConnectionState()!==m.ConnectionState.OPEN&&m.currentUser&&!m.connecting&&!m.reconnecting&&"string"==typeof r&&0===r.indexOf("SB_VIDEOCHAT"))?pe.get(m._iid).container.apiClient.sendUserMessage({channelUrl:this.url,isOpenChannel:this.isOpenChannel(),message:n,data:t,customType:r,translationTargetLanguages:l,metaArrays:i,mentionType:a,mentionedUserIds:o,pushNotificationDeliveryOption:u,rootMessageId:d,parentMessageId:h},function(e,n){var t=null;e?((t=new y(v)).requestState=m.MessageRequestState.FAILED,t.sendingStatus=m.MessageSendingStatus.FAILED,e.code===fe.REQUEST_CANCELED&&(t.sendingStatus=m.MessageSendingStatus.CANCELED),t.requestedMentionUserIds=o,t.errorCode=e.code):((t=new y(n)).requestState=m.MessageRequestState.SUCCEEDED,t.sendingStatus=m.MessageSendingStatus.SUCCEEDED),p(e,t)}):m.sendCommand(b,function(e,n){if(m.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n){var r=new y(v);r.reqId=b.requestId,r.requestState=m.MessageRequestState.FAILED,r.sendingStatus=m.MessageSendingStatus.FAILED,n.code===fe.REQUEST_CANCELED&&(r.sendingStatus=m.MessageSendingStatus.CANCELED),r.requestedMentionUserIds=o,r.errorCode=n.code,p(new fe(n.message,n.code),r)}else{var i=new y(e.getJsonElement()),a=m.currentUser;a&&i._sender&&a.userId===i._sender.userId&&(a.nickname!==i._sender.nickname&&(a.nickname=i._sender.nickname),a.profileUrl!==i._sender.profileUrl&&(a.profileUrl=i._sender.profileUrl),ge.deepEqual(a.metaData,i._sender.metaData)||(a.metaData=i._sender.metaData)),s.isGroupChannel()?g.getChannel(s.url,function(e,n){if(m.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)i.requestState=m.MessageRequestState.SUCCEEDED,i.sendingStatus=m.MessageSendingStatus.SUCCEEDED,p(n,i);else{if(!ge.isVideoChatSignalingMessage(i))for(var r in e.lastMessage=i,m.channelHandlers){m.channelHandlers[r].onChannelChanged(e)}i.requestState=m.MessageRequestState.SUCCEEDED,i.sendingStatus=m.MessageSendingStatus.SUCCEEDED,p(null,i)}}):(i.requestState=m.MessageRequestState.SUCCEEDED,i.sendingStatus=m.MessageSendingStatus.SUCCEEDED,p(null,i))}});return C}},{key:"sendUserMessage",value:function(){var e=O.toArray(arguments),t=e.pop(),n=null,r=null,i=D.get(this._iid),a=i.UserMessageParams;i.MessageMetaArray;if("function"==typeof t)if(e[0]instanceof a)null===(r=e[0]).data&&(r.data=""),null===r.customType&&(r.customType="");else if("string"==typeof e[0])switch((r=new a).message=e[0],e.length){case 1:break;case 2:r.data=e[1]||"";break;case 3:r.data=e[1]||"",r.customType=e[2]||"";break;case 4:r.data=e[1]||"",r.customType=e[2]||"",r.translationTargetLanguages=Array.isArray(e[3])?e[3]:[e[3]];break;default:n=O.error}else n=O.error;else n=O.error;var s=pe.get(this._iid).container.isErrorFirstInCallback;return!n&&r._validate()&&r.message?this._sendUserMessage(_(_({},r),{},{metaArrays:r.metaArrays,mentionType:r.mentionType,mentionedUserIds:r._mentionedUserIds,rootMessageId:r.rootMessageId,parentMessageId:r.parentMessageId,translationTargetLanguages:r._translationTargetLanguages,callback:function(e,n){s?t(e,n):t(n,e)}})):(s?t(O.error,null):t(null,O.error),null)}},{key:"resendUserMessage",value:function(t,e){var r=this,n=D.get(this._iid),i=n.UserMessage,a=n.UserMessageParams,s=null,o=C(O.parse(arguments,[new O({type:i,constraint:function(e){return 0===e.messageId&&e.isResendable()&&e.reqId&&e.channelUrl===r.url&&"string"==typeof e.message&&"string"==typeof e.data&&"string"==typeof e.customType&&Array.isArray(e.translations)}}),new O({type:"callback"})]),3);return s=o[0],t=o[1],e=o[2],j(this._iid,function(e){if(s)s.message+=" Please check if the failed message is resend-able with `message.isResendable().`",e(s,null);else{var n=a.PushNotificationDeliveryOption.DEFAULT;r._sendUserMessage(_(_({},t),{},{mentionedUserIds:t.requestedMentionUserIds,translationTargetLanguages:t.translations,pushNotificationDeliveryOption:n,reqId:t.reqId,callback:e}))}},e)}},{key:"updateUserMessage",value:function(n,e,t,r,i){var s=this,a=D.get(this._iid),o=a.Command,l=a.UserMessage,u=a.UserMessageParams,c=arguments,d=null,h=null;if("number"==typeof n)switch(c.length){case 3:var p=C(O.parse(c,[new O({type:"number"}),new O({type:u}),new O({type:"callback"})]),4);d=p[0],n=p[1],h=p[2],i=p[3];break;case 5:h=new u;var f=C(O.parse(c,[new O({type:"number"}),new O({type:"string",nullable:!0}),new O({type:"string",nullable:!0}),new O({type:"string",nullable:!0}),new O({type:"callback"})]),6);d=f[0],n=f[1],e=f[2],t=f[3],r=f[4],i=f[5],h.message=e,h.data=t,h.customType=r}return j(this._iid,function(i){if(!d&&h&&h._validate()){var e=o.bUpdateUserMessage(_(_({channelUrl:s.url,messageId:n},h),{},{mentionType:h._mentionType,mentionedUserIds:h._mentionedUserIds})),a=En.getInstance(s._iid);a.sendCommand(e,function(e,n){if(a.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}var r=null;n||(r=new l(e.getJsonElement())),i(n,r)})}else i(O.error,null)},i)}},{key:"translateUserMessage",value:function(e,n,t){var i,a=this,r=En.getInstance(this._iid),s=D.get(this._iid).UserMessage,o=C(O.parse(arguments,[new O({type:s,constraint:function(e){return e.channelUrl===a.url&&e.sendingStatus===r.MessageSendingStatus.SUCCEEDED}}),new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),4);return i=o[0],e=o[1],n=o[2],t=o[3],j(this._iid,function(r){i?r(i,null):pe.get(a._iid).container.apiClient.translateUserMessage({channelUrl:a.url,isOpenChannel:a.isOpenChannel(),messageId:e.messageId,translationTargetLanguages:n},function(e,n){var t=null;e||(t=new s(n)),r(e,t)})},t)}},{key:"_parseFileMessageArguments",value:function(e){var n=D.get(this._iid),t=n.BaseMessageParams,r=n.FileMessageParams,i={error:null,file:null,name:null,type:null,size:null,data:"",customType:"",thumbnailSizes:[],metaArrays:[],mentionType:t.MentionType.USERS,mentionedUserIds:[],pushNotificationDeliveryOption:r.PushNotificationDeliveryOption.DEFAULT,rootMessageId:null,parentMessageId:null,progressHandler:null,callback:null};if("function"==typeof e[e.length-1]&&(i.callback=e.pop()),"function"==typeof e[e.length-1]&&(i.progressHandler=e.pop()),e[0]instanceof r)i.file=e[0].file||e[0].fileUrl,i.name=e[0].fileName,i.type=e[0].mimeType,i.size=e[0].fileSize,i.data=e[0].data,i.customType=e[0].customType,i.thumbnailSizes=e[0].thumbnailSizes,i.metaArrays=e[0].metaArrays,i.mentionType=e[0]._mentionType,i.mentionedUserIds=e[0]._mentionedUserIds,i.pushNotificationDeliveryOption=e[0].pushNotificationDeliveryOption?e[0].pushNotificationDeliveryOption:r.PushNotificationDeliveryOption.DEFAULT,i.rootMessageId=e[0].rootMessageId,i.parentMessageId=e[0].parentMessageId,e[0]._validate()||(i.error=O.error);else if(ge.isFile(e[0])||"string"==typeof e[0]){switch(i.file=e[0],e.length){case 1:break;case 2:i.data=e[1];break;case 3:i.data=e[1],i.customType=e[2];break;case 4:i.data=e[1],i.customType=e[2],i.thumbnailSizes=e[3];break;case 5:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4];break;case 6:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4],i.customType=e[5];break;case 7:i.name=e[1],i.type=e[2],i.size=e[3],i.data=e[4],i.customType=e[5],i.thumbnailSizes=e[6]}var a=C(O.parse([i.file,i.name,i.type,i.size,i.data,i.customType,i.thumbnailSizes],[new O({type:["file","string"]}),new O({type:"string",nullable:!0}),new O({type:"string",nullable:!0}),new O({type:"number",nullable:!0,constraint:function(e){return 0<=e}}),new O({type:"string",nullable:!0}),new O({type:"string",nullable:!0}),new O({type:"array"})]),8);i.error=a[0],i.file=a[1],i.name=a[2],i.type=a[3],i.size=a[4],i.data=a[5],i.customType=a[6],i.thumbnailSizes=a[7]}else i.error=O.error;return ge.isFile(i.file)&&(i.name=i.name||i.file.name,i.type=i.type||i.file.type,i.size=i.size||i.file.size),i}},{key:"_createTempFileMessage",value:function(e){try{var n=En.getInstance(this._iid),t=D.get(this._iid),r=t.Command,i=t.FileMessage,a=i.build(r.generateRequestId(),0,n.currentUser,this,"string"==typeof e.file?e.file:"",e.name,e.type,e.size,e.data,e.customType,!1,(new Date).getTime(),e.thumbnailSizes.map(function(e){return{url:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}}),e.requireAuth,null,e.metaArrays,null,e.mentionType,null,0,0,null,null,e.mentionedUserIds,n.MessageSendingStatus.PENDING);return new i(a)}catch(e){return null}}},{key:"sendFileMessage",value:function(){var e=this._parseFileMessageArguments(O.toArray(arguments)),n=null,t=D.get(this._iid).Command.generateRequestId();e.error||((n=this._createTempFileMessage(e)).requestedMentionUserIds=e.mentionedUserIds,t=n.reqId);var r=En.getInstance(this._iid);r&&r.currentUser||(e.error=new fe("Connection should be made first.",fe.CONNECTION_REQUIRED));var i=D.get(this._iid).FileMessageQueue;return i.create(this).addJob(new i.Job({fileInfo:e,pendingMessage:n,requestId:t,error:e.error,response:null})),n}},{key:"sendFileMessages",value:function(r,e){var n=this,t=1<arguments.length&&void 0!==e?e:{},i=t.progress?t.progress:function(){},a=t.sent?t.sent:function(){},s=t.complete?t.complete:function(){};if(Array.isArray(r)&&0<r.length&&r.length<=20){var o=[];return r.forEach(function(e,t){o.push(n.sendFileMessage(e,i,function(e,n){a(e,n),t===r.length-1&&s(null)}))}),o}return s(O.error),null}},{key:"resendFileMessage",value:function(t,r,e){var i=this,n=D.get(this._iid),a=n.FileMessage,s=n.FileMessageParams,o=null,l=C(O.parse(arguments,[new O({type:a,constraint:function(e){return 0===e.messageId&&e.isResendable()&&e.reqId&&e.channelUrl===i.url&&"string"==typeof e.data&&"string"==typeof e.customType&&Array.isArray(e.thumbnails)}}),new O({type:"file",optionalIf:function(e){return!!e[0].url},defaultValue:null}),new O({type:"callback"})]),4);return o=l[0],t=l[1],r=l[2],e=l[3],j(this._iid,function(e){if(o)o.message+=" Please check if the failed message is resend-able with `message.isResendable().`",e(o,null);else{var n=new s;t.url?n.fileUrl=t.url:n.file=r,n.fileName=t.name,n.fileSize=t.size,n.mimeType=t.type,n.data=t.data,n.customType=t.customType,n.mentionType=t.mentionType,n.mentionedUserIds=t.requestedMentionUserIds,n.metaArrays=t.metaArrays,n.thumbnailSizes=t.thumbnails.map(function(e){return{maxWidth:e.width,maxHeight:e.height}}),i.sendFileMessage(n,e)}},e)}},{key:"updateFileMessage",value:function(n,e,t,r){var s=this,i=D.get(this._iid),o=i.Command,l=i.FileMessage,a=i.FileMessageParams,u=arguments,c=null,d=null;if("number"==typeof n)switch(u.length){case 3:var h=C(O.parse(u,[new O({type:"number"}),new O({type:a}),new O({type:"callback"})]),4);c=h[0],n=h[1],d=h[2],r=h[3],d&&(d._isUpdate=!0);break;case 4:d=new a;var p=C(O.parse(u,[new O({type:"number"}),new O({type:"string",nullable:!0}),new O({type:"string",nullable:!0}),new O({type:"callback"})]),5);c=p[0],n=p[1],e=p[2],t=p[3],r=p[4],d.data=e,d.customType=t,d._isUpdate=!0}return j(this._iid,function(i){if(!c&&d&&d._validate()){var e=o.bUpdateFileMessage(_(_({channelUrl:s.url,messageId:n},d),{},{mentionType:d._mentionType,mentionedUserIds:d._mentionedUserIds})),a=En.getInstance(s._iid);a.sendCommand(e,function(e,n){if(a.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}var r=null;n||(r=new l(e.getJsonElement())),i(n,r)})}else i(O.error,null)},r)}},{key:"cancelUploadingFileMessage",value:function(e,t){var n,r=C(O.parse(arguments,[new O({type:["number","string"]}),new O({type:"callback"})]),3);n=r[0],e=r[1],t=r[2];var i=pe.get(this._iid).container.isErrorFirstInCallback;return n?(i?t(n,null):t(null,n),!1):D.get(this._iid).FileMessageQueue.create(this).cancelUploadItemByRequestId(e,function(e,n){return i?t(e,n):t(n,e)})}},{key:"addReaction",value:function(i,e,n){var t,a=this,s=En.getInstance(this._iid),o=D.get(this._iid).ReactionEvent,r=C(O.parse(arguments,[new O({type:K}),new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),4);return t=r[0],i=r[1],e=r[2],n=r[3],j(this._iid,function(r){t?r(t,null):i.sendingStatus===s.MessageSendingStatus.SUCCEEDED?pe.get(a._iid).container.apiClient.addReaction({isGroupChannel:i.isGroupChannel(),channelUrl:i.channelUrl,messageId:i.messageId,key:e},function(e,n){var t=null;e||(t=o.createFromJson(_(_({},n),{},{msg_id:i.messageId}))),r(e,t)}):r(new fe("Cannot add reaction to a non-succeeded message.",fe.REQUEST_FAILED),null)},n)}},{key:"deleteReaction",value:function(i,e,n){var t,a=this,s=En.getInstance(this._iid),o=D.get(this._iid).ReactionEvent,r=C(O.parse(arguments,[new O({type:K}),new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),4);return t=r[0],i=r[1],e=r[2],n=r[3],j(this._iid,function(r){t?r(t,null):i.sendingStatus===s.MessageSendingStatus.SUCCEEDED?pe.get(a._iid).container.apiClient.deleteReaction({isGroupChannel:i.isGroupChannel(),channelUrl:i.channelUrl,messageId:i.messageId,key:e},function(e,n){var t=null;e||(t=o.createFromJson(_(_({},n),{},{msg_id:i.messageId}))),r(e,t)}):r(new fe("Cannot remove reaction to a non-succeeded message.",fe.REQUEST_FAILED),null)},n)}},{key:"deleteMessage",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"object",constraint:function(e){return!Array.isArray(e)&&null!==e&&e.hasOwnProperty("messageId")}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.deleteMessage({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),messageId:e.messageId},function(e,n){return t(e,null)})},n)}},{key:"getMetaCounters",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"array",constraint:function(n){return Object.keys(n).map(function(e){return n[e]}).every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.getMetaCounters({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),keys:e},function(e,n){return t(e,n)})},n)}},{key:"getAllMetaCounters",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.getMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),keys:[]},function(e,n){return t(e,n)})},e)}},{key:"createMetaCounters",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"object",constraint:function(n){return n&&!Array.isArray(n)&&0<Object.keys(n).length&&Object.keys(n).map(function(e){return n[e]}).every(function(e){return"number"==typeof e})}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.createMetaCounters({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),metaCounter:e},function(e,n){return t(e,n)})},n)}},{key:"updateMetaCounters",value:function(e,n,t){var r,i=this,a=C(O.parse(arguments,[new O({type:"object",constraint:function(n){return n&&!Array.isArray(n)&&0<Object.keys(n).length&&Object.keys(n).map(function(e){return n[e]}).every(function(e){return"number"==typeof e})}}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"callback"})]),4);return r=a[0],e=a[1],n=a[2],t=a[3],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.updateMetaCounters({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),metaCounter:e,upsert:n,mode:"set"},function(e,n){return t(e,n)})},t)}},{key:"increaseMetaCounters",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"object",constraint:function(n){return n&&!Array.isArray(n)&&0<Object.keys(n).length&&Object.keys(n).map(function(e){return n[e]}).every(function(e){return"number"==typeof e})}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.updateMetaCounters({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),metaCounter:e,upsert:!1,mode:"increase"},function(e,n){return t(e,n)})},n)}},{key:"decreaseMetaCounters",value:function(e,n){var t,r=this,i=C(O.parse(arguments,[new O({type:"object",constraint:function(n){return n&&!Array.isArray(n)&&0<Object.keys(n).length&&Object.keys(n).map(function(e){return n[e]}).every(function(e){return"number"==typeof e})}}),new O({type:"callback"})]),3);return t=i[0],e=i[1],n=i[2],j(this._iid,function(i){t?i(t,null):pe.get(r._iid).container.apiClient.updateMetaCounters({channelUrl:r.url,isOpenChannel:r.isOpenChannel(),metaCounter:e,upsert:!1,mode:"decrease"},function(e,n){var t=null;if(!e)for(var r in t={},n)t[r]=n[r];i(e,t)})},n)}},{key:"deleteMetaCounter",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.deleteMetaCounter({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),key:e},function(e,n){return t(e,n)})},n)}},{key:"deleteAllMetaCounters",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.deleteAllMetaCounters({channelUrl:n.url,isOpenChannel:n.isOpenChannel()},function(e,n){return t(e,n)})},e)}},{key:"getMetaData",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"array",constraint:function(n){return Object.keys(n).map(function(e){return n[e]}).every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.getMetaData({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),keys:e},function(e,n){return t(e,n)})},n)}},{key:"getAllMetaData",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.getMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel(),keys:[]},function(e,n){return t(e,n)})},e)}},{key:"createMetaData",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"object",constraint:function(n){return n&&!Array.isArray(n)&&0<Object.keys(n).length&&Object.keys(n).map(function(e){return n[e]}).every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.createMetaData({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),metaData:e},function(e,n){return t(e,n)})},n)}},{key:"updateMetaData",value:function(e,n,t){var r,i=this,a=C(O.parse(arguments,[new O({type:"object",constraint:function(n){return n&&!Array.isArray(n)&&0<Object.keys(n).length&&Object.keys(n).map(function(e){return n[e]}).every(function(e){return"string"==typeof e})}}),new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"callback"})]),4);return r=a[0],e=a[1],n=a[2],t=a[3],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.updateMetaData({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),metaData:e,upsert:n},function(e,n){return t(e,n)})},t)}},{key:"deleteMetaData",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.deleteMetaData({channelUrl:i.url,isOpenChannel:i.isOpenChannel(),key:e},function(e,n){return t(e,n)})},n)}},{key:"deleteAllMetaData",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.deleteAllMetaData({channelUrl:n.url,isOpenChannel:n.isOpenChannel()},function(e,n){return t(e,n)})},e)}},{key:"_updateMessageMetaArray",value:function(r,u,c,e){var d=this;return j(this._iid,function(i){var e=D.get(d._iid),n=e.Command,a=e.UserMessage,s=e.FileMessage,o=e.AdminMessage,t=null;if(u.isUserMessage()?t=n.bUpdateUserMessage({channelUrl:r,messageId:u.messageId,metaArrayParams:c}):u.isFileMessage()&&(t=n.bUpdateFileMessage({channelUrl:r,messageId:u.messageId,metaArrayParams:c})),t){var l=En.getInstance(d._iid);l.sendCommand(t,function(e,n){if(l.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}var r=null;n||(u.isUserMessage()?r=new a(e.getJsonElement()):u.isFileMessage()?r=new s(e.getJsonElement()):u.isAdminMessage()&&(r=new o(e.getJsonElement()))),i(n,r)})}else i(O.error,null)},e)}},{key:"createMessageMetaArrayKeys",value:function(e,n,t){var r,i=D.get(this._iid).MessageMetaArray,a=C(O.parse(arguments,[new O({type:K}),new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e&&""!==e})}}),new O({type:"callback"})]),4);if(r=a[0],e=a[1],n=a[2],t=a[3],r)return j(this._iid,function(e){e(r,null)},t);var s=[];if(Array.isArray(n))for(var o=0;o<n.length;o++){var l=n[o];s.push(new i(l,[]))}return this._updateMessageMetaArray(this.url,e,{array:s.map(function(e){return e.encode()}),mode:"add",upsert:!0},t)}},{key:"deleteMessageMetaArrayKeys",value:function(e,n,t){var r,i=D.get(this._iid).MessageMetaArray,a=C(O.parse(arguments,[new O({type:K}),new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e&&""!==e})}}),new O({type:"callback"})]),4);if(r=a[0],e=a[1],n=a[2],t=a[3],r)return j(this._iid,function(e){e(r,null)},t);var s=[];if(Array.isArray(n))for(var o=0;o<n.length;o++){var l=n[o];s.push(new i(l,[]))}return this._updateMessageMetaArray(this.url,e,{array:s.map(function(e){return e.encode()}),mode:"remove",upsert:!0},t)}},{key:"addMessageMetaArrayValues",value:function(e,n,t){var r,i=D.get(this._iid).MessageMetaArray,a=C(O.parse(arguments,[new O({type:K}),new O({type:"object",constraint:function(n){return n&&(Array.isArray(n)&&n.every(function(e){return e instanceof i})||Object.keys(n).every(function(e){return Array.isArray(n[e])&&n[e].every(function(e){return"string"==typeof e&&0<e.length})}))}}),new O({type:"callback"})]),4);if(r=a[0],e=a[1],n=a[2],t=a[3],r)return j(this._iid,function(e){e(r,null)},t);var s=Array.isArray(n)?n.map(function(e){return e.encode()}):Object.keys(n).map(function(e){return{key:e,value:n[e]}});return this._updateMessageMetaArray(this.url,e,{array:s,mode:"add",upsert:!0},t)}},{key:"removeMessageMetaArrayValues",value:function(e,n,t){var r,i=D.get(this._iid).MessageMetaArray,a=C(O.parse(arguments,[new O({type:K}),new O({type:"object",constraint:function(n){return n&&(Array.isArray(n)&&n.every(function(e){return e instanceof i})||Object.keys(n).every(function(e){return Array.isArray(n[e])&&n[e].every(function(e){return"string"==typeof e&&0<e.length})}))}}),new O({type:"callback"})]),4);if(r=a[0],e=a[1],n=a[2],t=a[3],r)return j(this._iid,function(e){e(r,null)},t);var s=Array.isArray(n)?n.map(function(e){return e.encode()}):Object.keys(n).map(function(e){return{key:e,value:n[e]}});return this._updateMessageMetaArray(this.url,e,{array:s,mode:"remove",upsert:!0},t)}},{key:"report",value:function(n,r,e){var i,a=this,t=D.get(this._iid).BaseChannel,s=C(O.parse(arguments,[new O({type:t.ReportCategory}),new O({type:"string"}),new O({type:"callback"})]),4);return i=s[0],n=s[1],r=s[2],e=s[3],j(this._iid,function(t){if(i)t(i,null);else{var e=En.getInstance(a._iid);pe.get(a._iid).container.apiClient.report({channelUrl:a.url,isOpenChannel:a.isOpenChannel(),reportCategory:n,reportingUserId:e.currentUser?e.currentUser.userId:null,reportDescription:r},function(e,n){t(e,null)})}},e)}},{key:"reportUser",value:function(n,r,i,e){var a,s=this,t=D.get(this._iid).BaseChannel,o=C(O.parse(arguments,[new O({type:V}),new O({type:t.ReportCategory}),new O({type:"string"}),new O({type:"callback"})]),5);return a=o[0],n=o[1],r=o[2],i=o[3],e=o[4],j(this._iid,function(t){if(a)t(a,null);else{var e=En.getInstance(s._iid);pe.get(s._iid).container.apiClient.reportUser({channelUrl:s.url,isOpenChannel:s.isOpenChannel(),reportCategory:r,offendingUserId:n.userId,reportingUserId:e.currentUser?e.currentUser.userId:null,reportDescription:i},function(e,n){t(e,null)})}},e)}},{key:"reportMessage",value:function(n,r,i,e){var a,s=this,t=D.get(this._iid).BaseChannel,o=C(O.parse(arguments,[new O({type:K}),new O({type:t.ReportCategory}),new O({type:"string"}),new O({type:"callback"})]),5);return a=o[0],n=o[1],r=o[2],i=o[3],e=o[4],j(this._iid,function(t){if(a)t(a,null);else{var e=En.getInstance(s._iid);pe.get(s._iid).container.apiClient.reportMessage({messageId:n.messageId,channelUrl:s.url,isOpenChannel:s.isOpenChannel(),reportCategory:r,offendingUserId:n.sender.userId,reportingUserId:e.currentUser?e.currentUser.userId:null,reportDescription:i},function(e,n){t(e,null)})}},e)}}],[{key:"buildMessage",value:function(e,n){var t=D.get(this._iid),r=t.Sender,i=t.UserMessage,a=t.FileMessage,s=t.AdminMessage,o=t.BaseMessageParams,l=t.MessageMetaArray;if(e)switch(e.type){case"MESG":return new i(i.build(e.req_id,parseInt(e.message_id),new r(e.user),n,e.message,e.data||"",e.custom_type||"",e.translations||{},e.is_global_block||!1,parseInt(e.created_at),parseInt(e.updated_at),e.sorted_metaarray?e.sorted_metaarray.map(function(e){return new l(e.key,e.value||[])}):[],e.reactions,e.mention_type||o.MentionType.USERS,e.mentioned_users||[],parseInt(e.root_message_id||0),parseInt(e.parent_message_id||0),e.parent_message_text,e.thread_info,e.mentioned_user_ids,e.sending_status,e.requested_mention_user_ids||[],e.error_code||0,e.message_survival_seconds||-1));case"FILE":var u=e.file;return new a(a.build(e.req_id,parseInt(e.message_id),new r(e.user),n,String(u.url),String(u.name),String(u.type),parseInt(u.size)||0,u.data||"",e.custom_type||"",e.is_global_block||!1,parseInt(e.created_at),e.thumbnails||[],e.require_auth||!1,parseInt(e.updated_at),e.sorted_metaarray?e.sorted_metaarray.map(function(e){return new l(e.key,e.value||[])}):[],e.reactions,e.mention_type||o.MentionType.USERS,e.mentioned_users||[],parseInt(e.root_message_id||0),parseInt(e.parent_message_id||0),e.parent_message_text,e.thread_info,e.mentioned_user_ids,e.sending_status,e.requested_mention_user_ids||[],e.error_code||0,e.message_survival_seconds||-1));case"BRDM":case"ADMM":return new s(s.build(parseInt(e.message_id),n,e.message,e.data||"",e.custom_type||"",e.translations||{},parseInt(e.created_at),parseInt(e.updated_at),e.sorted_metaarray?e.sorted_metaarray.map(function(e){return new l(e.key,e.value||[])}):[],e.reactions,e.mention_type||o.MentionType.USERS,e.mentioned_users||[],parseInt(e.root_message_id||0),parseInt(e.parent_message_id||0),e.parent_message_text,e.thread_info))}return null}},{key:"CHANNEL_TYPE_OPEN",get:function(){return"open"}},{key:"CHANNEL_TYPE_GROUP",get:function(){return"group"}},{key:"CHANNEL_TYPE_BASE",get:function(){return"base"}},{key:"MessageTypeFilter",get:function(){return{ALL:"",USER:"MESG",FILE:"FILE",ADMIN:"ADMM"}}},{key:"ReportCategory",get:function(){return{SPAM:"spam",HARASSING:"harassing",SUSPICIOUS:"suspicious",INAPPROPRIATE:"inappropriate"}}}]),n}(),me=function(){function n(e){v(this,n),e&&(this.category=e.hasOwnProperty("cat")?parseInt(e.cat):0,this.data=e.hasOwnProperty("data")?e.data:null,this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):J.CHANNEL_TYPE_GROUP)}return s(n,[{key:"isGroupChannel",value:function(){return this.channelType===J.CHANNEL_TYPE_GROUP}},{key:"isOpenChannel",value:function(){return this.channelType===J.CHANNEL_TYPE_OPEN}}]),n}();me.CATEGORY_NONE=0,me.CATEGORY_CHANNEL_ENTER=10102,me.CATEGORY_CHANNEL_EXIT=10103,me.CATEGORY_USER_CHANNEL_MUTE=10201,me.CATEGORY_USER_CHANNEL_UNMUTE=10200,me.CATEGORY_USER_CHANNEL_BAN=10601,me.CATEGORY_USER_CHANNEL_UNBAN=10600,me.CATEGORY_CHANNEL_FREEZE=10701,me.CATEGORY_CHANNEL_UNFREEZE=10700,me.CATEGORY_TYPING_START=10900,me.CATEGORY_TYPING_END=10901,me.CATEGORY_CHANNEL_JOIN=1e4,me.CATEGORY_CHANNEL_LEAVE=10001,me.CATEGORY_CHANNEL_OPERATOR_UPDATE=10002,me.CATEGORY_CHANNEL_INVITE=10020,me.CATEGORY_CHANNEL_DECLINE_INVITE=10022,me.CATEGORY_CHANNEL_PROP_CHANGED=11e3,me.CATEGORY_CHANNEL_DELETED=12e3,me.CATEGORY_CHANNEL_META_DATA_CHANGED=11100,me.CATEGORY_CHANNEL_META_COUNTERS_CHANGED=11200,me.CATEGORY_CHANNEL_HIDE=13e3,me.CATEGORY_CHANNEL_UNHIDE=13001;function ve(e){v(this,ve),e&&(this.category=e.hasOwnProperty("cat")?parseInt(e.cat):0)}ve.CATEGORY_USER_BLOCK=20001,ve.CATEGORY_USER_UNBLOCK=2e4,ve.CATEGORY_FRIEND_DISCOVERED=20900;var X=function(){function n(e){v(this,n),this.sb=e,this.cls=D.get(this.sb._iid)}return s(n,[{key:"onRawCommandReceived",value:function(e){var v=this,n=this.cls,t=n.Command,d=n.User,h=n.Member,r=n.BaseChannel,p=n.GroupChannel,o=n.OpenChannel,i=n.UserMessage,a=n.FileMessage,s=n.AdminMessage,C=n.BaseMessageParams,l=n.ReactionEvent,u=n.ReadStatus,c=n.ThreadInfoUpdateEvent,f=pe.get(this.sb._iid),_=f.container,g=_.pinger,y=_.auth,m=_.subscribedUnreadMessageCount,E=_.ackStateMap,U=new t(e),b=U.getJsonElement();if(b.hasOwnProperty("unread_cnt")&&"object"===de(b.unread_cnt)){var S=!1,A=b.unread_cnt.ts;if("number"==typeof A&&A>m.ts){if(m.all!==b.unread_cnt.all&&(S=!0),m.all=0<=b.unread_cnt.all?b.unread_cnt.all:0,b.unread_cnt.custom_types)for(var I in b.unread_cnt.custom_types)m.custom_types[I]!==b.unread_cnt.custom_types[I]&&(S=!0),m.custom_types[I]=b.unread_cnt.custom_types[I];S=S&&0<m.ts,m.ts=A}if(S)for(var N in this.sb.userEventHandlers)this.sb.userEventHandlers[N].onTotalUnreadMessageCountUpdated(m.all,m.custom_types)}var k=U.requestId;if(k){var M=E[k];if(M){clearTimeout(M.timer);var R=M.handler;R&&("EROR"===U.command?R(new fe(b.message,b.code),null):R(null,U)),E.hasOwnProperty(k)&&delete E[k]}}else switch(g&&"LOGI"!==U.command&&g.start(),U.command){case"LOGI":this.sb.loginTimer&&(clearTimeout(this.sb.loginTimer),this.sb.loginTimer=null,this.sb.onLoginTimerCancel=null,b.hasOwnProperty("error")?(this.sb.isSessionOpened=!1,this.sb.loginHandler(new fe(b.message,b.code),null)):(this.sb.isSessionOpened=!0,b.hasOwnProperty("key")&&(y.sessionKey=b.key),b.hasOwnProperty("ekey")&&(y.eKey=b.ekey),b.hasOwnProperty("user_id")&&(this.sb.currentUser=new d(b)),"number"==typeof b.ping_interval&&0<b.ping_interval&&f.set("pingInterval",1e3*b.ping_interval),"number"==typeof b.pong_timeout&&0<b.pong_timeout&&f.set("pongTimeout",1e3*b.pong_timeout),"number"==typeof b.login_ts&&f.set("connectedAt",1e3*b.login_ts),"number"==typeof b.max_unread_cnt_on_super_group?f.set("maxUnreadCountOfSuperGroupChannel",b.max_unread_cnt_on_super_group):f.set("maxUnreadCountOfSuperGroupChannel",he.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL),g&&g.start(),b.hasOwnProperty("file_upload_size_limit")&&b.hasOwnProperty("premium_feature_list")&&b.hasOwnProperty("emoji_hash")&&f.set("appInfo",new ye(b)),this.sb.loginHandler(null,this.sb.currentUser)),this.sb.connecting=!1,this.sb.reconnecting=!1);break;case"MESG":case"FILE":case"BRDM":case"ADMM":var T=null,O=!1,L=!1;if("MESG"===U.command?T=new i(b):"FILE"===U.command?T=new a(b):(T=new s(b),b.hasOwnProperty("silent")&&(L=b.silent)),b.hasOwnProperty("force_update_last_message")&&(O=b.force_update_last_message),T){var w=this.sb.currentUser?this.sb.currentUser.userId:null;if(T.isGroupChannel()){var P=t.bMessageAck({channelUrl:T.channelUrl,messageId:T.messageId});this.sb.sendCommand(P);var D=p.cachedChannels.hasOwnProperty(T.channelUrl);p.getChannel(T.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(!n){if(e.isHidden=!1,e.hiddenState=p.HiddenState.UNHIDDEN,p.cachedChannels[e.url]=e,T._sender&&e.memberMap.hasOwnProperty(T._sender.userId)){var r=e.memberMap[T._sender.userId];r.nickname!==T._sender.nickname&&(r.nickname=T._sender.nickname),r.profileUrl!==T._sender.profileUrl&&(r.profileUrl=T._sender.profileUrl),ge.deepEqual(r.metaData,T._sender.metaData)||(r.metaData=T._sender.metaData),r.isBlockedByMe!==T._sender.isBlockedByMe&&(r.isBlockedByMe=T._sender.isBlockedByMe)}var i=v.sb.currentUser;i&&T._sender&&w===T._sender.userId&&(i.nickname!==T._sender.nickname&&(i.nickname=T._sender.nickname),i.profileUrl!==T._sender.profileUrl&&(i.profileUrl=T._sender.profileUrl),ge.deepEqual(i.metaData,T._sender.metaData)||(i.metaData=T._sender.metaData));var a=!1;if(T.mentionType===C.MentionType.CHANNEL)T.sender&&T.sender.userId===w||(a=!0);else if(T.mentionType===C.MentionType.USERS)for(var s=0;s<T.mentionedUsers.length;s++)if((!T.sender||T.sender.userId!==w)&&T.mentionedUsers[s].userId===w){a=!0;break}if(!ge.isVideoChatSignalingMessage(T)&&(L||(e.isEphemeral?((!e.lastMessage||e.lastMessage.createdAt<T.createdAt)&&(e.lastMessage=T),T.sender&&T.sender.userId===w||e._setGroupChannelUnreadCount(e.unreadMessageCount+1,e.unreadMentionCount+(a?1:0))):D&&((!e.lastMessage||e.lastMessage.createdAt<T.createdAt)&&(e.lastMessage=T),T.sender&&T.sender.userId===w||e._setGroupChannelUnreadCount(e.unreadMessageCount+1,e.unreadMentionCount+(a?1:0)))),O&&(!e.lastMessage||e.lastMessage.createdAt<T.createdAt)&&(e.lastMessage=T),!L))for(var o in v.sb.channelHandlers){v.sb.channelHandlers[o].onChannelChanged(e)}for(var l in v.sb.channelHandlers){var u=v.sb.channelHandlers[l];u.onMessageReceived(e,T),a&&u.onMentionReceived(e,T)}}})}else T.isOpenChannel()&&o.getChannel(T.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(!n){var r=!1;if(T.mentionType===C.MentionType.CHANNEL)r=!0;else if(T.mentionType===C.MentionType.USERS)for(var i=0;i<T.mentionedUsers.length;i++)if(T.mentionedUsers[i].userId===w){r=!0;break}for(var a in v.sb.channelHandlers){var s=v.sb.channelHandlers[a];o.enteredChannels[e.url]&&s.onMessageReceived(e,T),r&&s.onMentionReceived(e,T)}}})}break;case"MEDI":case"FEDI":case"AEDI":var H=null,F=!1;if("MEDI"===U.command?H=new i(b):"FEDI"===U.command?H=new a(b):(H=new s(b),b.hasOwnProperty("silent")&&(F=b.silent)),H){var G=this.sb.currentUser?this.sb.currentUser.userId:null;if(H.isGroupChannel()){var q=p.cachedChannels.hasOwnProperty(H.channelUrl);p.getChannel(H.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(!n){var r=e.cachedReadReceiptStatus[G],i=r&&r>=H.createAt,a=v.sb.currentUser;a&&H._sender&&a.userId===H._sender.userId&&(a.nickname!==H._sender.nickname&&(a.nickname=H._sender.nickname),a.profileUrl!==H._sender.profileUrl&&(a.profileUrl=H._sender.profileUrl),ge.deepEqual(a.metaData,H._sender.metaData)||(a.metaData=H._sender.metaData));var s=!1;if((!H.sender||H.sender.userId!==G)&&!i&&b&&b.hasOwnProperty("old_values")){var o=b.old_values.mention_type||H.mentionType,l=b.old_values.mentioned_user_ids||H.mentionedUsers.map(function(e){return e.userId});if(o===C.MentionType.USERS&&H.mentionType===C.MentionType.USERS){for(var u=!1,c=!1,d=0;d<l.length;d++)if(l[d]===G){u=!0;break}for(var h=0;h<H.mentionedUsers.length;h++)if(H.mentionedUsers[h].userId===G){c=!0;break}!u&&c&&(s=!0,q&&e._setGroupChannelUnreadCount(e.unreadMessageCount,e.unreadMentionCount+1))}else if(o===C.MentionType.USERS&&H.mentionType===C.MentionType.CHANNEL){for(var p=!1,f=0;f<l.length;f++)if(l[f]===G){p=!0;break}p||(s=!0,q&&e._setGroupChannelUnreadCount(e.unreadMessageCount,e.unreadMentionCount+1))}}var _=!1;if(e.lastMessage&&e.lastMessage.messageId===H.messageId&&(q?e.lastMessage.updatedAt<H.updatedAt&&(e.lastMessage=H,_=!0):_=!0),!F&&(_||s))for(var g in v.sb.channelHandlers){v.sb.channelHandlers[g].onChannelChanged(e)}for(var y in v.sb.channelHandlers){var m=v.sb.channelHandlers[y];m.onMessageUpdated(e,H),s&&m.onMentionReceived(e,H)}}})}else H.isOpenChannel()&&o.getChannel(H.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(!n)for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onMessageUpdated(e,H)}})}break;case"DELM":var B=String(b.channel_type),x=String(b.channel_url),z=String(b.msg_id);switch(B){case r.CHANNEL_TYPE_GROUP:p.getChannel(x,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command);else for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onMessageDeleted(e,z)}});break;case r.CHANNEL_TYPE_OPEN:o.getChannel(x,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command);else for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onMessageDeleted(e,z)}})}break;case"READ":var j=new u(b),Q=p.cachedChannels.hasOwnProperty(j.channelUrl);p.getChannel(j.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(!n&&(Q&&e.updateReadReceipt(j.reader.userId,j.timestamp),v.sb.currentUser))if(j.reader.userId===v.sb.currentUser.userId){if(Q){if(0<e.unreadMessageCount||0<e.unreadMentionCount)for(var r in e._setGroupChannelUnreadCount(0,0),v.sb.channelHandlers){v.sb.channelHandlers[r].onChannelChanged(e)}}else if(0===e.unreadMessageCount||0===e.unreadMentionCount)for(var i in v.sb.channelHandlers){v.sb.channelHandlers[i].onChannelChanged(e)}}else for(var a in v.sb.channelHandlers){v.sb.channelHandlers[a].onReadReceiptUpdated(e)}});break;case"MRCT":var Y=String(b.channel_type),K=String(b.channel_url),V=l.createFromJson(b);switch(Y){case r.CHANNEL_TYPE_GROUP:p.getChannel(K,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command);else for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onReactionUpdated(e,V)}});break;case r.CHANNEL_TYPE_OPEN:o.getChannel(K,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command);else for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onReactionUpdated(e,V)}})}break;case"DLVR":var W=String(b.channel_url),J=b.hasOwnProperty("updated")?b.updated:null,X=p.cachedChannels.hasOwnProperty(W);p.getChannel(W,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(!n){var r=!1;for(var i in J)v.sb.currentUser&&i===v.sb.currentUser.userId&&(r=!0),X&&e.updateDeliveryReceipt(i,parseInt(J[i]));if(p.cachedChannels[e.url]=e,!r||1!==Object.keys(J).length)for(var a in v.sb.channelHandlers){v.sb.channelHandlers[a].onDeliveryReceiptUpdated(e)}}});break;case"MTHD":var Z=String(b.channel_url),$=String(b.channel_type),ee=c.createFromJson(b);switch($){case r.CHANNEL_TYPE_GROUP:p.getChannel(Z,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(!n)for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onThreadInfoUpdated(e,ee)}})}break;case"SYEV":var ne=new me(b);switch(ne.category){case me.CATEGORY_CHANNEL_JOIN:case me.CATEGORY_CHANNEL_LEAVE:p.getChannel(ne.channelUrl,function(r,e){if(v.sb.getErrorFirstCallback()){var n=[r,e];e=n[0],r=n[1]}if(e)_e.debug("Discard command",U.command,ne.category);else{var i=ne.data.hasOwnProperty("member_count")?ne.data.member_count:null,a=ne.data.hasOwnProperty("joined_member_count")?ne.data.joined_member_count:null;if(ne.category===me.CATEGORY_CHANNEL_JOIN){(ne.data.hasOwnProperty("users")?ne.data.users:[ne.data]).forEach(function(e){r.isSuper||r.isBroadcast?r.setLatestMemberCount(i,a,b.ts):(e.state=h.JOINED,r.addMember(new h(e)),r.updateJoinedMemberCount());var n=new d(e);for(var t in v.sb.currentUser&&n.userId===v.sb.currentUser.userId&&(r.myMemberState="joined",p.cachedChannels[r.url]=r),v.sb.channelHandlers){v.sb.channelHandlers[t].onUserJoined(r,n)}})}else{var t=new d(ne.data);for(var s in v.sb.currentUser&&t.userId===v.sb.currentUser.userId?(r.isPublic||p.removeCachedChannel(ne.channelUrl),r.myMemberState="none",r.invitedAt=0,r._setGroupChannelUnreadCount(0,0)):p.cachedChannels[r.url]=r,r.isSuper||r.isBroadcast?r.setLatestMemberCount(i,a,b.ts):(r.removeMember(t),r.updateJoinedMemberCount()),v.sb.channelHandlers){v.sb.channelHandlers[s].onUserLeft(r,t)}}}});break;case me.CATEGORY_CHANNEL_OPERATOR_UPDATE:ne.isGroupChannel()?p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=ne.data.operators.map(function(e){return new d(e)}),i=r.map(function(e){return e.userId});for(var a in e.members)e.members[a].role=0<=i.indexOf(e.members[a].userId)?p.Role.OPERATOR:p.Role.NONE;for(var s in e.myRole=v.sb.currentUser&&0<=i.indexOf(v.sb.currentUser.userId)?p.Role.OPERATOR:p.Role.NONE,v.sb.channelHandlers){v.sb.channelHandlers[s].onOperatorUpdated(e,r)}}}):ne.isOpenChannel()&&o.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else for(var r in e.operators=ne.data.operators.map(function(e){return new d(e)}),v.sb.channelHandlers){v.sb.channelHandlers[r].onOperatorUpdated(e,e.operators)}});break;case me.CATEGORY_CHANNEL_INVITE:p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=null;ne.data&&ne.data.inviter&&0<Object.keys(ne.data.inviter).length&&(r=new d(ne.data.inviter));for(var i=[],a=0;a<ne.data.invitees.length;a++){var s=new d(ne.data.invitees[a]);i.push(s),ne.data.invitees[a].state=h.INVITED;var o=new h(ne.data.invitees[a]);if(e.isSuper||e.isBroadcast){var l=ne.data.hasOwnProperty("member_count")?ne.data.member_count:null,u=ne.data.hasOwnProperty("joined_member_count")?ne.data.joined_member_count:null;e.setLatestMemberCount(l,u,b.ts)}else e.addMember(o);v.sb.currentUser&&o.userId===v.sb.currentUser.userId&&(e.isHidden=!1,"joined"!==e.myMemberState&&(e.myMemberState="invited"),e.invitedAt=b.ts,p.cachedChannels[e.url]=e)}for(var c in v.sb.channelHandlers){v.sb.channelHandlers[c].onUserReceivedInvitation(e,r,i)}}});break;case me.CATEGORY_CHANNEL_DECLINE_INVITE:p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=null;ne.data&&ne.data.inviter&&0<Object.keys(ne.data.inviter).length&&(r=new d(ne.data.inviter));var i=new d(ne.data.invitee);if(v.sb.currentUser&&i.userId===v.sb.currentUser.userId&&(e.invitedAt=0,e.myMemberState="none",e.isPublic||p.removeCachedChannel(ne.channelUrl)),e.isSuper||e.isBroadcast){var a=ne.data.hasOwnProperty("member_count")?ne.data.member_count:null,s=ne.data.hasOwnProperty("joined_member_count")?ne.data.joined_member_count:null;e.setLatestMemberCount(a,s,b.ts)}else e.removeMember(i);for(var o in v.sb.currentUser&&i.userId!==v.sb.currentUser.userId&&(p.cachedChannels[e.url]=e),v.sb.channelHandlers){v.sb.channelHandlers[o].onUserDeclinedInvitation(e,r,i)}}});break;case me.CATEGORY_TYPING_START:case me.CATEGORY_TYPING_END:p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=new d(ne.data);for(var i in ne.category===me.CATEGORY_TYPING_START?e.updateTypingStatus(r,!0):e.updateTypingStatus(r,!1),v.sb.channelHandlers){v.sb.channelHandlers[i].onTypingStatusUpdated(e)}}});break;case me.CATEGORY_CHANNEL_ENTER:case me.CATEGORY_CHANNEL_EXIT:o.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{ne.data.hasOwnProperty("participant_count")&&(e.participantCount=ne.data.participant_count);var r=new d(ne.data);if(ne.category===me.CATEGORY_CHANNEL_ENTER)for(var i in v.sb.channelHandlers){v.sb.channelHandlers[i].onUserEntered(e,r)}else for(var a in v.sb.channelHandlers){v.sb.channelHandlers[a].onUserExited(e,r)}}});break;case me.CATEGORY_USER_CHANNEL_MUTE:case me.CATEGORY_USER_CHANNEL_UNMUTE:ne.isOpenChannel()?o.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=new d(ne.data);if(ne.category===me.CATEGORY_USER_CHANNEL_MUTE)for(var i in v.sb.channelHandlers){v.sb.channelHandlers[i].onUserMuted(e,r)}else for(var a in v.sb.channelHandlers){v.sb.channelHandlers[a].onUserUnmuted(e,r)}}}):p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=new d(ne.data);if(v.sb.currentUser&&r.userId===v.sb.currentUser.userId&&(e.myMutedState=ne.category===me.CATEGORY_USER_CHANNEL_MUTE?"muted":"unmuted"),ne.category===me.CATEGORY_USER_CHANNEL_MUTE)for(var i in v.sb.channelHandlers){v.sb.channelHandlers[i].onUserMuted(e,r)}else for(var a in v.sb.channelHandlers){v.sb.channelHandlers[a].onUserUnmuted(e,r)}}});break;case me.CATEGORY_USER_CHANNEL_BAN:case me.CATEGORY_USER_CHANNEL_UNBAN:ne.isOpenChannel()?o.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=new d(ne.data);if(ne.category===me.CATEGORY_USER_CHANNEL_BAN){if(v.sb.currentUser&&r.userId===v.sb.currentUser.userId)delete o.enteredChannels[ne.channelUrl],v.cls.FileMessageQueue.delete(ne.channelUrl);for(var i in v.sb.channelHandlers){v.sb.channelHandlers[i].onUserBanned(e,r)}}else for(var a in v.sb.channelHandlers){v.sb.channelHandlers[a].onUserUnbanned(e,r)}}}):p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=new d(ne.data);if(ne.category===me.CATEGORY_USER_CHANNEL_BAN){if(v.sb.currentUser&&r.userId===v.sb.currentUser.userId&&(e.isPublic||p.removeCachedChannel(ne.channelUrl),e.myMemberState="none",e.invitedAt=0,e._setGroupChannelUnreadCount(0,0)),e.isSuper||e.isBroadcast){var i=ne.data.hasOwnProperty("member_count")?ne.data.member_count:null,a=ne.data.hasOwnProperty("joined_member_count")?ne.data.joined_member_count:null;e.setLatestMemberCount(i,a,b.ts)}else e.removeMember(r),e.updateJoinedMemberCount();for(var s in v.sb.channelHandlers){v.sb.channelHandlers[s].onUserBanned(e,r)}}else for(var o in v.sb.channelHandlers){v.sb.channelHandlers[o].onUserUnbanned(e,r)}}});break;case me.CATEGORY_CHANNEL_FREEZE:case me.CATEGORY_CHANNEL_UNFREEZE:ne.isOpenChannel()?o.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else if(e.isFrozen=ne.data.freeze,o.cachedChannels[e.url]=e,ne.category===me.CATEGORY_CHANNEL_FREEZE)for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onChannelFrozen(e)}else for(var i in v.sb.channelHandlers){v.sb.channelHandlers[i].onChannelUnfrozen(e)}}):p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else if(e.isFrozen=ne.data.freeze,p.cachedChannels[e.url]=e,ne.category===me.CATEGORY_CHANNEL_FREEZE)for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onChannelFrozen(e)}else for(var i in v.sb.channelHandlers){v.sb.channelHandlers[i].onChannelUnfrozen(e)}});break;case me.CATEGORY_CHANNEL_DELETED:for(var te in ne.isGroupChannel()?p.removeCachedChannel(ne.channelUrl):o.removeCachedChannel(ne.channelUrl),this.sb.channelHandlers){this.sb.channelHandlers[te].onChannelDeleted(ne.channelUrl,ne.isGroupChannel()?"group":"open")}break;case me.CATEGORY_CHANNEL_PROP_CHANGED:ne.isOpenChannel()?o.getChannelWithoutCache(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else for(var r in v.sb.channelHandlers){v.sb.channelHandlers[r].onChannelChanged(e)}}):p.getChannelWithoutCache(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else{var r=e.unreadMessageCount,i=e.unreadMentionCount;for(var a in e.myCountPreference!==p.CountPreference.ALL&&(e.myCountPreference===p.CountPreference.UNREAD_MESSAGE_COUNT_ONLY?i=0:e.myCountPreference===p.CountPreference.UNREAD_MENTION_COUNT_ONLY?r=0:i=r=0),e._setGroupChannelUnreadCount(r,i),v.sb.channelHandlers){v.sb.channelHandlers[a].onChannelChanged(e)}}});break;case me.CATEGORY_CHANNEL_META_DATA_CHANGED:case me.CATEGORY_CHANNEL_META_COUNTERS_CHANGED:var re=ne.data.hasOwnProperty("created"),ie=ne.data.hasOwnProperty("updated"),ae=ne.data.hasOwnProperty("deleted");ne.isOpenChannel()?o.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else for(var r in v.sb.channelHandlers){var i=v.sb.channelHandlers[r];ne.category===me.CATEGORY_CHANNEL_META_DATA_CHANGED?(re&&i.onMetaDataCreated(e,ne.data.created),ie&&i.onMetaDataUpdated(e,ne.data.updated),ae&&i.onMetaDataDeleted(e,ne.data.deleted)):(re&&i.onMetaCountersCreated(e,ne.data.created),ie&&i.onMetaCountersUpdated(e,ne.data.updated),ae&&i.onMetaCountersDeleted(e,ne.data.deleted))}}):p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else for(var r in v.sb.channelHandlers){var i=v.sb.channelHandlers[r];ne.category===me.CATEGORY_CHANNEL_META_DATA_CHANGED?(re&&i.onMetaDataCreated(e,ne.data.created),ie&&i.onMetaDataUpdated(e,ne.data.updated),ae&&i.onMetaDataDeleted(e,ne.data.deleted)):(re&&i.onMetaCountersCreated(e,ne.data.created),ie&&i.onMetaCountersUpdated(e,ne.data.updated),ae&&i.onMetaCountersDeleted(e,ne.data.deleted))}});break;case me.CATEGORY_CHANNEL_HIDE:case me.CATEGORY_CHANNEL_UNHIDE:p.getChannel(ne.channelUrl,function(e,n){if(v.sb.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)_e.debug("Discard command",U.command,ne.category);else if(ne.category===me.CATEGORY_CHANNEL_HIDE)for(var r in e.isHidden=!0,ne.data&&(ne.data.hasOwnProperty("allow_auto_unhide")&&(e.hiddenState=ne.data.allow_auto_unhide?p.HiddenState.HIDDEN_ALLOW_AUTO_UNHIDE:p.HiddenState.HIDDEN_PREVENT_AUTO_UNHIDE),ne.data.hasOwnProperty("hide_previous_messages")&&ne.data.hide_previous_messages&&e._setGroupChannelUnreadCount(0,0)),b.hasOwnProperty("ts_message_offset")&&(e._messageOffsetTimestamp=b.ts_message_offset),p.cachedChannels[e.url]=e,v.sb.channelHandlers){v.sb.channelHandlers[r].onChannelHidden(e)}else for(var i in e.isHidden=!1,e.hiddenState=p.HiddenState.UNHIDDEN,p.cachedChannels[e.url]=e,v.sb.channelHandlers){v.sb.channelHandlers[i].onChannelChanged(e)}})}break;case"USEV":var se=new me(b);switch(se.category){case ve.CATEGORY_USER_BLOCK:case ve.CATEGORY_USER_UNBLOCK:var oe=se.data.blocker.user_id,le=se.data.blockee.user_id;Object.keys(p.cachedChannels).forEach(function(e){var n=p.cachedChannels[e];try{v.sb.currentUser&&(v.sb.currentUser.userId===oe?n.memberMap[le].isBlockedByMe=se.category===ve.CATEGORY_USER_BLOCK:v.sb.currentUser.userId===le&&(n.memberMap[oe].isBlockingMe=se.category===ve.CATEGORY_USER_BLOCK))}catch(e){}});break;case ve.CATEGORY_FRIEND_DISCOVERED:var ue=se.data.friend_discoveries.map(function(e){return new d(e)});for(var ce in this.sb.userEventHandlers){this.sb.userEventHandlers[ce].onFriendsDiscovered(ue)}}break;case"LEAV":case"JOIN":case"PONG":case"MTIO":case"TPST":case"TPEN":break;default:_e.debug("Discard command",U.command)}}}]),n}(),Z={},$={},ee=function(){function n(e){v(this,n),this.channel=e,this.uploadQueue=[],this.messageQueue=[],this.latestTimestampToSendMessage=0,D.get(this._iid).FileMessageQueue.queueMap[e.url]=this}return s(n,[{key:"_handleMessageQueueUpdated",value:function(e){var t=this;switch(_e.debug("fileMessageQueue message queue updated: ",this.messageQueue),e){case"add":this.uploadQueue.length<6&&this._moveFirstPendingMessageToUploadQueue();break;case"update":case"remove":if(0<this.messageQueue.length){var r=D.get(this._iid).FileMessageQueue,i=this.messageQueue[0];if(i)if(i.state===r.State.UPLOADED){if(i&&i.state===r.State.UPLOADED){for(i.state=r.State.SENDING,0===this.latestTimestampToSendMessage&&(this.latestTimestampToSendMessage=(new Date).getTime()-200);(new Date).getTime()-this.latestTimestampToSendMessage<200;);this.latestTimestampToSendMessage=(new Date).getTime(),this._sendUploadedMessage(i,function(e,n){i.state=r.State.SENT,i.error=e||null,i.response=n||null,t._handleMessageQueueUpdated("update")})}}else i.state===r.State.SENT&&this._finalizeMessage()}}}},{key:"_handleUploadQueueUpdated",value:function(e,n){var t=this;switch(_e.debug("fileMessageQueue upload queue updated: ",this.uploadQueue),e){case"add":var r=D.get(this._iid).FileMessageQueue;if(n.state=r.State.UPLOADING,n.error)-1<this.messageQueue.map(function(e){return e.requestId}).indexOf(n.requestId)&&(n.state=r.State.SENT,this._handleMessageQueueUpdated("update")),this._finalizeUpload(n.requestId);else this._uploadFile(n,function(e){n.error&&n.state===r.State.SENT||(n.state=r.State.UPLOADED),n.fileInfo=e,t._handleMessageQueueUpdated("update"),t._finalizeUpload(n.requestId)});break;case"update":break;case"remove":this.uploadQueue.length<6&&this._moveFirstPendingMessageToUploadQueue()}}},{key:"_moveFirstPendingMessageToUploadQueue",value:function(){var n=D.get(this._iid).FileMessageQueue,e=this.messageQueue.filter(function(e){return e.state===n.State.PENDING});if(0<e.length){var t=e[0];this.uploadQueue.push(t),this._handleUploadQueueUpdated("add",t)}}},{key:"_sendUploadedMessage",value:function(e,a){var n=D.get(this._iid),t=n.Command,s=n.FileMessage,o=e.fileInfo,l=t.bFile(_(_({},o),{},{requestId:e.requestId,channelUrl:this.channel.url,url:o.file,metaArrays:o.metaArrays})),u=En.getInstance(this._iid),r=pe.get(this._iid);u.getConnectionState()!==u.ConnectionState.OPEN&&u.currentUser&&!u.connecting?r.container.apiClient.sendFileMessage(_(_({channelUrl:this.channel.url,isOpenChannel:this.channel.isOpenChannel()},o),{},{fileUrl:o.file,fileName:o.name,fileSize:o.size,fileType:o.type,metaArrays:o.metaArrays}),function(e,n){var t=new s(e?l.getJsonElement():n);e&&(t.requestedMentionUserIds=o.mentionedUserIds),a(e,t)}):u.sendCommand(l,function(e,n){if(u.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n){var r=new s(l.getJsonElement());r.requestedMentionUserIds=o.mentionedUserIds,a(n,r)}else{var i=new s(e.getJsonElement());a(null,i)}})}},{key:"_uploadFile",value:function(r,i){var a=r.fileInfo,e=r.pendingMessage;if("string"!=typeof a.file&&a.file){var s=D.get(this._iid).FileMessageQueue;pe.get(this._iid).container.apiClient.uploadFile(_(_({},a),{},{fileType:a.type,channelUrl:this.channel.url,reqId:e?e.reqId:null}),function(e,n){if(e)r.state=s.State.SENT,r.error=e,r.response=null,i(a);else{var t="object"===de(n)?n:JSON.parse(n);a.file=t.url,a.thumbnailSizes=t.hasOwnProperty("thumbnails")?t.thumbnails:[],a.requireAuth=!!t.hasOwnProperty("require_auth")&&t.require_auth,i(a)}})}else a.thumbnailSizes=[],a.requireAuth=!1,i(a)}},{key:"_finalizeUpload",value:function(e){var n=this.uploadQueue.map(function(e){return e.requestId}).indexOf(e);if(-1<n){var t=this.uploadQueue.splice(n,1);0<t.length&&this._handleUploadQueueUpdated("remove",t[0])}}},{key:"_finalizeMessage",value:function(){var i=this,a=pe.get(this._iid).container.isErrorFirstInCallback,s=En.getInstance(this._iid),e=D.get(this._iid),n=e.GroupChannel,t=(e.BaseMessage,e.FileMessageQueue),r=this.messageQueue[0];if(r&&r.state===t.State.SENT){r.state=t.State.DONE;var o=r.response,l=r.error,u=r.fileInfo.callback;if(o&&!l){var c=s.currentUser;if(c&&o._sender&&c.userId===o._sender.userId&&(c.nickname!==o._sender.nickname&&(c.nickname=o._sender.nickname),c.profileUrl!==o._sender.profileUrl&&(c.profileUrl=o._sender.profileUrl)),this.channel.isGroupChannel())return void n.getChannel(this.channel.url,function(e,n){if(s.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(n)a?u(null,o):u(o,null),i.messageQueue.shift(),i._handleMessageQueueUpdated("remove");else{for(var r in e.lastMessage=o,s.channelHandlers){s.channelHandlers[r].onChannelChanged(e)}a?u(n,o):u(o,n),i.messageQueue.shift(),i._handleMessageQueueUpdated("remove")}})}l&&(o=r.pendingMessage)&&(l.code!==fe.INVALID_PARAMETER?(o.requestState=s.MessageRequestState.FAILED,o.sendingStatus=s.MessageSendingStatus.FAILED,l.code!==fe.FILE_UPLOAD_CANCEL_FAILED&&l.code!==fe.REQUEST_CANCELED||(o.sendingStatus=s.MessageSendingStatus.CANCELED),o.requestedMentionUserIds=r.fileInfo.mentionedUserIds,o.errorCode=l.code):o=null),a?u(l,o):u(o,l),this.messageQueue.shift(),this._handleMessageQueueUpdated("remove")}}},{key:"addJob",value:function(e){this.messageQueue.push(e),this._handleMessageQueueUpdated("add")}},{key:"cancelUploadItemByRequestId",value:function(e,n){this._finalizeUpload(e);var t=this.messageQueue.map(function(e){return e.requestId}).indexOf(e);if(-1<t){var r=D.get(this._iid).FileMessageQueue,i=this.messageQueue[t];!i||i.state!==r.State.UPLOADING&&i.state!==r.State.PENDING||(i.state=r.State.SENT,i.response=null,i.error=new fe("Uploading has been completed or canceled.",fe.FILE_UPLOAD_CANCEL_FAILED),this._handleMessageQueueUpdated("update"));var a=r.uploadRequest[e];if(a)return a.upload?a.upload.onabort=function(){n(null,!0)}:n(null,!0),a.isAbort=!0,a.abort(),!0;n(new fe("Uploading has been completed or canceled.",fe.FILE_UPLOAD_CANCEL_FAILED),!1)}else n(new fe("Uploading has been completed or canceled.",fe.FILE_UPLOAD_CANCEL_FAILED),!1);return!1}}],[{key:"getByChannelUrl",value:function(e){return D.get(this._iid).FileMessageQueue.queueMap[e]}},{key:"create",value:function(e){var n=D.get(this._iid).FileMessageQueue;return n.queueMap.hasOwnProperty(e.url)||(n.queueMap[e.url]=new n(e)),n.queueMap[e.url]}},{key:"delete",value:function(e){var n=D.get(this._iid).FileMessageQueue;n.queueMap.hasOwnProperty(e)&&delete n.queueMap[e]}},{key:"clear",value:function(){$[this._iid]={}}},{key:"State",get:function(){return{PENDING:"pending",UPLOADING:"uploading",UPLOADED:"uploaded",SENDING:"sending",SENT:"sent",DONE:"done"}}},{key:"queueMap",get:function(){return $[this._iid]||($[this._iid]={}),$[this._iid]}},{key:"uploadRequest",get:function(){return Z[this._iid]||(Z[this._iid]={}),Z[this._iid]}}]),n}();ee.Job=function(){return function e(n){var t=n.fileInfo,r=n.requestId,i=n.pendingMessage,a=n.state,s=n.error,o=void 0===s?null:s,l=n.response,u=void 0===l?null:l;v(this,e),this.fileInfo=t,this.requestId=r,this.pendingMessage=i,this.state=a||ee.State.PENDING,this.error=o,this.response=u}}();function ne(){v(this,ne),this.channelCustomTypesFilter=[],this.superChannelFilter=Ee.SuperChannelFilter.ALL}function te(){v(this,te),this.onReconnectStarted=function(){},this.onReconnectSucceeded=function(){},this.onReconnectFailed=function(){}}function re(){v(this,re),this.onFriendsDiscovered=function(e){},this.onTotalUnreadMessageCountUpdated=function(e,n){}}function ie(){v(this,ie),this.onMessageReceived=function(e,n){},this.onMessageUpdated=function(e,n){},this.onMessageDeleted=function(e,n){},this.onReadReceiptUpdated=function(e){},this.onReactionUpdated=function(e,n){},this.onDeliveryReceiptUpdated=function(e){},this.onTypingStatusUpdated=function(e){},this.onUserJoined=function(e,n){},this.onUserLeft=function(e,n){},this.onOperatorUpdated=function(e,n){},this.onUserEntered=function(e,n){},this.onUserExited=function(e,n){},this.onUserMuted=function(e,n){},this.onUserUnmuted=function(e,n){},this.onUserBanned=function(e,n){},this.onUserUnbanned=function(e,n){},this.onChannelFrozen=function(e){},this.onChannelUnfrozen=function(e){},this.onChannelChanged=function(e){},this.onChannelDeleted=function(e,n){},this.onUserReceivedInvitation=function(e,n,t){},this.onUserDeclinedInvitation=function(e,n,t){},this.onMetaDataCreated=function(e,n){},this.onMetaDataUpdated=function(e,n){},this.onMetaDataDeleted=function(e,n){},this.onMetaCountersCreated=function(e,n){},this.onMetaCountersUpdated=function(e,n){},this.onMetaCountersDeleted=function(e,n){},this.onChannelHidden=function(e){},this.onMentionReceived=function(e,n){},this.onThreadInfoUpdated=function(e,n){}}function ae(e){if(v(this,ae),e){var n=D.get(this._iid),t=n.User,r=n.BaseChannel;this.reader=new t(e.user),this.timestamp=parseInt(e.ts),this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this.channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):r.CHANNEL_TYPE_GROUP}}var se=function(){function e(){v(this,e)}return s(e,null,[{key:"create",value:function(){return"".concat(parseInt(1e5*Math.random()),"-").concat((new Date).getTime())}}]),e}(),oe={},le={},ue=new WeakMap,ce=new WeakMap,Ce=new WeakMap,Ee=function(){o(a,J);var t=h(a);function a(e){var n;return v(this,a),(n=t.call(this,e)).channelType=J.CHANNEL_TYPE_GROUP,n.isDistinct=!1,n.isSuper=!1,n.isBroadcast=!1,n.isPublic=!1,n.unreadMessageCount=0,n.inviter=null,n.members=[],n.memberMap={},n.lastMessage=null,n.memberCount=0,n.joinedMemberCount=0,n.cachedReadReceiptStatus={},n.cachedDeliveryReceiptStatus=null,n.myPushTriggerOption=a.PushTriggerOption.DEFAULT,n.isPushEnabled,n.isHidden=!1,n.hiddenState=a.HiddenState.UNHIDDEN,n.isDiscoverable=!0,n.myLastRead=0,n.messageSurvivalSeconds=-1,n._messageOffsetTimestamp=0,n._cachedLastDeliveredReceipt={sentAt:0,timeout:null},ue.set(d(n),{}),ce.set(d(n),{start:0,end:0}),Ce.set(d(n),0),e&&n._update(e),n}return s(a,[{key:"_setGroupChannelUnreadCount",value:function(e,n){try{if("number"==typeof e&&0<=e)if("all"===this.myCountPreference||"unread_message_count_only"===this.myCountPreference)if(this.isSuper||this.isBroadcast){var t=pe.get(this._iid).container.maxUnreadCountOfSuperGroupChannel;this.unreadMessageCount=t<=e?t:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;"number"==typeof n&&0<=n&&("all"===this.myCountPreference||"unread_mention_count_only"===this.myCountPreference?this.unreadMentionCount=n:this.unreadMentionCount=0)}catch(e){}}},{key:"_update",value:function(e){var n=D.get(this._iid),t=n.BaseChannel,r=n.GroupChannel,i=n.User,a=n.Member;if(this.isAccessCodeRequired=!!e.is_access_code_required&&e.is_access_code_required,this.isDistinct=!!e.is_distinct&&e.is_distinct,this.isPushEnabled=!!e.is_push_enabled&&e.is_push_enabled,this.isHidden=!!e.hasOwnProperty("is_hidden")&&e.is_hidden,this.myPushTriggerOption=e.push_trigger_option?e.push_trigger_option:r.PushTriggerOption.DEFAULT,this.myCountPreference=e.hasOwnProperty("count_preference")?e.count_preference:r.CountPreference.ALL,this.unreadMessageCount=0,this.unreadMentionCount=0,this._setGroupChannelUnreadCount(parseInt(e.unread_message_count),parseInt(e.unread_mention_count)),e.hasOwnProperty("read_receipt"))for(var s in this.cachedReadReceiptStatus={},e.read_receipt){var o=e.read_receipt[s];this.updateReadReceipt(s,parseInt(o))}if(e.hasOwnProperty("delivery_receipt")&&"object"===de(e.delivery_receipt)&&null!==e.delivery_receipt)for(var l in this.cachedDeliveryReceiptStatus||(this.cachedDeliveryReceiptStatus={}),e.delivery_receipt){var u=e.delivery_receipt[l];this.updateDeliveryReceipt(l,parseInt(u))}if(e.hasOwnProperty("user_last_read")&&"number"==typeof e.user_last_read?this.myLastRead=e.user_last_read:this.myLastRead=0,e.hasOwnProperty("members")){this.members=[],this.memberMap={};for(var c=0;c<e.members.length;c++){var d=new a(e.members[c]);this.members.push(d),this.memberMap[d.userId]=d}}this.myMemberState=e.member_state||"none",this.myRole=e.my_role||r.Role.NONE,e.hasOwnProperty("is_muted")?"string"==typeof e.is_muted?this.myMutedState=e.is_muted:"boolean"==typeof e.is_muted?this.myMutedState=e.is_muted?"muted":"unmuted":this.myMutedState="unmuted":this.myMutedState="unmuted",e.hasOwnProperty("member_count")&&(this.memberCount=parseInt(e.member_count)),e.hasOwnProperty("joined_member_count")&&(this.joinedMemberCount=parseInt(e.joined_member_count)),e.hasOwnProperty("last_message")&&"object"===de(e.last_message)&&e.last_message?e.last_message instanceof K?this.lastMessage=e.last_message:this.lastMessage=t.buildMessage(e.last_message,this):this.lastMessage=null,e.hasOwnProperty("inviter")&&null!==e.inviter&&"object"===de(e.inviter)&&0<Object.keys(e.inviter).length?this.inviter=new i(e.inviter):this.inviter=null,this.invitedAt=e.invited_at||0,e.hasOwnProperty("is_super")&&"boolean"==typeof e.is_super?this.isSuper=e.is_super:this.isSuper=!1,e.hasOwnProperty("is_broadcast")&&"boolean"==typeof e.is_broadcast?this.isBroadcast=e.is_broadcast:this.isBroadcast=!1,e.hasOwnProperty("is_public")&&"boolean"==typeof e.is_public?this.isPublic=e.is_public:this.isPublic=!1,e.hasOwnProperty("hidden_state")?this.hiddenState=e.hidden_state:this.hiddenState=r.HiddenState.UNHIDDEN,e.hasOwnProperty("is_discoverable")&&"boolean"==typeof e.is_discoverable?this.isDiscoverable=e.is_discoverable:this.isDiscoverable=this.isPublic,e.hasOwnProperty("ts_message_offset")&&(this._messageOffsetTimestamp=e.ts_message_offset),e.hasOwnProperty("message_survival_seconds")&&"number"==typeof e.message_survival_seconds&&(this.messageSurvivalSeconds=e.message_survival_seconds)}},{key:"addMember",value:function(e){if(!this.isSuper&&!this.isBroadcast){var n=D.get(this._iid).Member,t=this.removeMember(e);t&&t.state===n.JOINED&&(e.state=n.JOINED),this.memberMap[e.userId]=e,this.members.push(e),this.memberCount++,this.updateReadReceipt(e.userId,0),this.updateDeliveryReceipt(e.userId,0)}}},{key:"removeMember",value:function(e){var n=null;if(!this.isSuper&&!this.isBroadcast&&this.memberMap.hasOwnProperty(e.userId)){delete this.memberMap[e.userId];for(var t=0;t<this.members.length;t++){var r=this.members[t];if(r.userId===e.userId){n=r,this.members.splice(t,1);break}}this.memberCount--}return n}},{key:"parse",value:function(e){this._update(e)}},{key:"update",value:function(e){this.__update(e),this._update(e)}},{key:"isIdentical",value:function(e){return e&&this.url===e.url}},{key:"isEqual",value:function(e){return ge.deepEqual(this,e)}},{key:"createMemberListQuery",value:function(){return new(D.get(this._iid).MemberListQuery)(this.url)}},{key:"createBannedUserListQuery",value:function(){return new(D.get(this._iid).BannedUserListQuery)({channelUrl:this.url,isOpenChannel:this.isOpenChannel()})}},{key:"refresh",value:function(e){return D.get(this._iid).GroupChannel.getChannelWithoutCache(this.url,e)}},{key:"updateChannel",value:function(){var n=this,t=O.toArray(arguments),e=void 0;"function"==typeof t[t.length-1]&&(e=t.pop());var r=D.get(this._iid),i=r.GroupChannel,a=r.GroupChannelParams;if(t[0]instanceof a&&1===t.length)return j(this._iid,function(r){var e=t[0];(e.channelUrl=n.url,e._validate())?pe.get(n._iid).container.apiClient.updateGroupChannel(_({},e),function(e,n){var t=null;e||(t=i.upsert(n)),r(e,t)}):r(O.error,null)},e);if(3===t.length){var s=new a;return s.channelUrl=this.url,s.name=t[0],"string"==typeof t[1]?s.coverUrl=t[1]:s.coverImage=t[1],s.data=t[2],this.updateChannel(s,e)}if(4===t.length){var o=new a;return o.channelUrl=this.url,o.isDistinct=t[0],o.name=t[1],"string"==typeof t[1]?o.coverUrl=t[2]:o.coverImage=t[2],o.data=t[3],this.updateChannel(o,e)}if(5!==t.length)return j(this._iid,function(e){return e(O.error,null)},e);var l=new a;return l.channelUrl=this.url,l.isDistinct=t[0],l.name=t[1],"string"==typeof t[2]?l.coverUrl=t[2]:l.coverImage=t[2],l.data=t[3],l.customType=t[4],this.updateChannel(l,e)}},{key:"invite",value:function(e,n){var t,r=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return 0<e.length&&e.every(function(e){return!!e.userId&&"string"==typeof e.userId})}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],t?j(this._iid,function(e){return e(O.error,null)},n):this.inviteWithUserIds(e.map(function(e){return e.userId}),n)}},{key:"inviteWithUserIds",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.inviteToGroupChannel({channelUrl:i.url,userIds:e},function(e,n){var t=null;e||(t=D.get(i._iid).GroupChannel.upsert(n));r(e,t)})},n)}},{key:"acceptInvitation",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"string",optional:!0,defaultValue:null}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.acceptInvitation({channelUrl:i.url,accessCode:e},function(e,n){var t=null;e||((t=D.get(i._iid).GroupChannel.upsert(n)).myMemberState="joined");r(e,t)})},n)}},{key:"declineInvitation",value:function(e){var a=this;return j(this._iid,function(i){pe.get(a._iid).container.apiClient.declineInvitation({channelUrl:a.url},function(e,n){var t=null;if(!e){var r=D.get(a._iid).GroupChannel;(t=r.upsert(n)).myMemberState="none",a.isPublic||r.removeCachedChannel(a.url)}i(e,t)})},e)}},{key:"join",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"string",optional:!0,defaultValue:null}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.joinGroupChannel({channelUrl:i.url,accessCode:e},function(e,n){var t=null;e||((t=D.get(i._iid).GroupChannel.upsert(n)).myMemberState="joined");r(e,t)})},n)}},{key:"leave",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.leaveGroupChannel({channelUrl:n.url},function(e,n){return t(e,null)})},e)}},{key:"muteUser",value:function(e,n,t,r){return this.muteUserWithUserId(e?e.userId:null,n,t,r)}},{key:"muteUserWithUserId",value:function(e,n,r,t){var i,a=this,s=C(O.parse(arguments,[new O({type:"string"}),new O({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return-1<=e}}),new O({type:"string",optional:!0,defaultValue:""}),new O({type:"callback"})]),5);return i=s[0],e=s[1],n=s[2],r=s[3],t=s[4],j(this._iid,function(t){i?t(i,null):pe.get(a._iid).container.apiClient.muteUser({channelUrl:a.url,userId:e,description:r,seconds:n,isGroupChannel:!0},function(e,n){t(e,null)})},t)}},{key:"unmuteUser",value:function(e,n){return this.unmuteUserWithUserId(e?e.userId:null,n)}},{key:"unmuteUserWithUserId",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.unmuteUser({channelUrl:i.url,userId:e,isGroupChannel:!0},function(e,n){t(e,null)})},n)}},{key:"banUser",value:function(e,n,t,r){return this.banUserWithUserId(e?e.userId:null,n,t,r)}},{key:"banUserWithUserId",value:function(e,n,r,t){var i,a=this,s=C(O.parse(arguments,[new O({type:"string"}),new O({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return-1<=e}}),new O({type:"string"}),new O({type:"callback"})]),5);return i=s[0],e=s[1],n=s[2],r=s[3],t=s[4],j(this._iid,function(t){i?t(i,null):pe.get(a._iid).container.apiClient.banUser({channelUrl:a.url,userId:e,description:r,seconds:n,isGroupChannel:!0},function(e,n){t(e,null)})},t)}},{key:"unbanUser",value:function(e,n){return this.unbanUserWithUserId(e?e.userId:null,n)}},{key:"unbanUserWithUserId",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.unbanUser({channelUrl:i.url,userId:e,isGroupChannel:!0},function(e,n){t(e,null)})},n)}},{key:"updateJoinedMemberCount",value:function(){if(!this.isSuper&&!this.isBroadcast){var n=D.get(this._iid).Member;this.joinedMemberCount=this.members.filter(function(e){return e.state===n.JOINED}).length}}},{key:"setLatestMemberCount",value:function(e,n,t){"number"==typeof e&&"number"==typeof n&&"number"==typeof t&&t>=Ce.get(this)&&(Ce.set(this,t),this.memberCount=e,this.joinedMemberCount=n)}},{key:"hide",value:function(i,a,e){var n,s=this,t=C(O.parse(arguments,[new O({type:"boolean",optional:!0,defaultValue:!1}),new O({type:"boolean",optional:!0,defaultValue:!0}),new O({type:"callback"})]),4);return n=t[0],i=t[1],a=t[2],e=t[3],j(this._iid,function(r){n?r(n,null):pe.get(s._iid).container.apiClient.hideGroupChannel({channelUrl:s.url,hidePreviousMessages:i,allowAutoUnhide:a},function(e,n){if(!e){var t=D.get(s._iid).GroupChannel;s.isHidden=!0,s.hiddenState=a?t.HiddenState.HIDDEN_ALLOW_AUTO_UNHIDE:t.HiddenState.HIDDEN_PREVENT_AUTO_UNHIDE,i&&s._setGroupChannelUnreadCount(0,0),n.hasOwnProperty("ts_message_offset")&&(s._messageOffsetTimestamp=n.ts_message_offset),t.cachedChannels[s.url]=s}r(e,n)})},e)}},{key:"unhide",value:function(e){var i=this;return j(this._iid,function(r){pe.get(i._iid).container.apiClient.unhideGroupChannel({channelUrl:i.url},function(e,n){if(!e){var t=D.get(i._iid).GroupChannel;i.isHidden=!1,i.hiddenState=t.HiddenState.UNHIDDEN,t.cachedChannels[i.url]=i}r(e,n)})},e)}},{key:"freeze",value:function(e){var r=this;return j(this._iid,function(t){pe.get(r._iid).container.apiClient.freeze({channelUrl:r.url,isGroupChannel:!0,freezing:!0},function(e,n){e||D.get(r._iid).GroupChannel.upsert(n);t(e,null)})},e)}},{key:"unfreeze",value:function(e){var r=this;return j(this._iid,function(t){pe.get(r._iid).container.apiClient.freeze({channelUrl:r.url,isGroupChannel:!0,freezing:!1},function(e,n){e||D.get(r._iid).GroupChannel.upsert(n);t(e,null)})},e)}},{key:"delete",value:function(e){var r=this;return j(this._iid,function(t){pe.get(r._iid).container.apiClient.deleteGroupChannel({channelUrl:r.url},function(e,n){e||D.get(r._iid).GroupChannel.removeCachedChannel(r.url);t(e,n)})},e)}},{key:"markAsRead",value:function(){var i=this,e=D.get(this._iid).Command,a=En.getInstance(this._iid),n=e.bRead({channelUrl:this.url});a.sendCommand(n,function(e,n){if(a.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}if(!n&&a.currentUser&&(i.updateReadReceipt(a.currentUser.userId,e.getJsonElement().ts),0<i.unreadMessageCount||0<i.unreadMentionCount))for(var r in i._setGroupChannelUnreadCount(0,0),a.channelHandlers){a.channelHandlers[r].onChannelChanged(i)}})}},{key:"getReadReceipt",value:function(e){var n=En.getInstance(this._iid);if(e instanceof K&&!e.isAdminMessage()&&n.currentUser&&!this.isSuper&&!this.isBroadcast){for(var t=0,r=e.createdAt,i=this.members,a=0;a<i.length;a++){var s=i[a];if(n.currentUser.userId!==s.userId&&(!e.sender||e.sender.userId!==s.userId))(this.cachedReadReceiptStatus[s.userId]||0)<r&&t++}return t}return 0}},{key:"markAsDelivered",value:function(){function e(){var e=En.getInstance(i._iid),r=e.currentUser?e.currentUser.userId:null;pe.get(i._iid).container.apiClient.markAsDelivered({channelUrl:i.url,userId:r},function(e,n){if(e)_e.debug(e);else{var t=n.hasOwnProperty("ts")?n.ts:0;i.updateDeliveryReceipt(r,t)}})}var i=this,n=this._cachedLastDeliveredReceipt;n&&Date.now()-n.sentAt<1e3?(n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(function(){n.sentAt=Date.now(),e()},n.sentAt+1e3-Date.now())):(n.sentAt=Date.now(),e())}},{key:"getDeliveryReceipt",value:function(e){var n=En.getInstance(this._iid);if(this.cachedDeliveryReceiptStatus&&e instanceof K&&!e.isAdminMessage()&&n.currentUser&&!this.isSuper&&!this.isBroadcast){for(var t=e.createdAt,r=0,i=0;i<this.members.length;i++){var a=this.members[i];n.currentUser.userId===a.userId||e.sender&&e.sender.userId===a.userId||this.cachedDeliveryReceiptStatus[a.userId]<t&&r++}return r}return 0}},{key:"getReadMembers",value:function(e,n){var t=1<arguments.length&&void 0!==n&&n,r=En.getInstance(this._iid);if(r.currentUser&&!this.isSuper&&!this.isBroadcast&&e instanceof K&&!e.isAdminMessage()){for(var i=[],a=0;a<this.members.length;a++){var s=this.members[a];if(t||s.userId!==r.currentUser.userId&&s.userId!==e.sender.userId)(this.cachedReadReceiptStatus[s.userId]||0)>=e.createdAt&&i.push(s)}return i}return[]}},{key:"getUnreadMembers",value:function(e,n){var t=1<arguments.length&&void 0!==n&&n,r=En.getInstance(this._iid);if(r.currentUser&&!this.isSuper&&!this.isBroadcast&&e instanceof K&&!e.isAdminMessage()){for(var i=[],a=0;a<this.members.length;a++){var s=this.members[a];if(t||s.userId!==r.currentUser.userId&&s.userId!==e.sender.userId)(this.cachedReadReceiptStatus[s.userId]||0)<e.createdAt&&i.push(s)}return i}return[]}},{key:"getReadStatus",value:function(e){var r=this,i=0<arguments.length&&void 0!==e&&e,a=En.getInstance(this._iid);if(!a.currentUser||this.isSuper||this.isBroadcast)return{};function n(n){if(!i&&n===a.currentUser.userId)return"continue";var e=r.cachedReadReceiptStatus[n],t=r.members.filter(function(e){return e.userId===n});s[n]={user:0<t.length?t[0]:null,last_seen_at:parseInt(e)}}var s={};for(var t in this.cachedReadReceiptStatus)n(t);return s}},{key:"updateReadReceipt",value:function(e,n){var t=this.cachedReadReceiptStatus[e];if(!t||t<n){this.cachedReadReceiptStatus[e]=n;var r=En.getInstance(this._iid);r.currentUser&&e===r.currentUser.userId&&(this.myLastRead=n)}}},{key:"updateDeliveryReceipt",value:function(e,n){if(this.cachedDeliveryReceiptStatus)if(this.cachedDeliveryReceiptStatus.hasOwnProperty(e)){var t=this.cachedDeliveryReceiptStatus[e];(!t||t<n)&&(this.cachedDeliveryReceiptStatus[e]=n)}else this.cachedDeliveryReceiptStatus[e]=n}},{key:"startTyping",value:function(){var e=En.getInstance(this._iid),n=(new Date).getTime(),t=e.Options.typingIndicatorThrottle;("number"!=typeof t||t<1e3||9e3<t)&&(t=1e3);var r=ce.get(this);if(n-r.start>=t){r.end=0,r.start=n;var i=D.get(this._iid).Command.bTypeStart({channelUrl:this.url,time:r.start});e.sendCommand(i,null)}}},{key:"endTyping",value:function(){var e=En.getInstance(this._iid),n=(new Date).getTime(),t=e.Options.typingIndicatorThrottle;("number"!=typeof t||t<1e3||9e3<t)&&(t=1e3);var r=ce.get(this);if(n-r.end>=t){r.start=0,r.end=n;var i=D.get(this._iid).Command.bTypeEnd({channelUrl:this.url,time:r.end});e.sendCommand(i,null)}}},{key:"invalidateTypingStatus",value:function(){var e=ue.get(this),n=(new Date).getTime(),t=!1;for(var r in e){1e4<=n-e[r]&&(delete e[r],t=!0)}return t}},{key:"getTypingMembers",value:function(){var e=ue.get(this),n=[];for(var t in e){var r=this.memberMap[t];r&&n.push(r)}return n}},{key:"updateTypingStatus",value:function(e,n){var t=ue.get(this);n?t[e.userId]=(new Date).getTime():delete t[e.userId]}},{key:"isTyping",value:function(){var e=ue.get(this);return 0!==Object.keys(e).length}},{key:"registerScheduledUserMessage",value:function(e,n){var t,a=this,r=D.get(this._iid),s=r.ScheduledUserMessage,i=r.ScheduledUserMessageParams,o=C(O.parse(arguments,[new O({type:i,constraint:function(e){return"string"==typeof e.message&&"string"==typeof e._getScheduleString()}}),new O({type:"callback"})]),3);return t=o[0],e=o[1],n=o[2],j(this._iid,function(i){t?i(t,null):pe.get(a._iid).container.apiClient.registerScheduledUserMessage({groupChannelParams:e,channelUrl:a.url,isOpenChannel:!1},function(e,n){var t=null;if(!e){t=new s(n);var r=En.getInstance(a._iid).currentUser;r&&t._sender&&r.userId===t._sender.userId&&(r.nickname=t._sender.nickname,r.profileUrl=t._sender.profileUrl,r.metaData=t._sender.metaData)}i(e,t)})},n)}},{key:"getPushPreference",value:function(e){var i=this;return j(this._iid,function(r){pe.get(i._iid).container.apiClient.getMyPushTriggerOption({channelUrl:i.url},function(e,n){var t=null;if(!e){try{t=n.enable}catch(e){t=!1}i.isPushEnabled=t}r&&r(e,t)})},e)}},{key:"setPushPreference",value:function(e,n){var i=this;return j(this._iid,function(t){var r=D.get(i._iid).GroupChannel;pe.get(i._iid).container.apiClient.setMyPushTriggerOption({channelUrl:i.url,enable:e},function(e,n){e||(i.isPushEnabled=n.enable,i.isPushEnabled||(i.myPushTriggerOption=r.PushTriggerOption.OFF)),t(e,n)})},n)}},{key:"getMyPushTriggerOption",value:function(e){var i=this;return j(this._iid,function(r){pe.get(i._iid).container.apiClient.getMyPushTriggerOption({channelUrl:i.url},function(e,n){var t=null;if(!e){try{t=n.push_trigger_option||a.PushTriggerOption.DEFAULT}catch(e){_e.debug(e)}i.myPushTriggerOption=t}r(e,t)})},e)}},{key:"setMyPushTriggerOption",value:function(e,n){var t,i=this,r=D.get(this._iid).GroupChannel,a=C(O.parse(arguments,[new O({type:r.PushTriggerOption}),new O({type:"callback"})]),3);return t=a[0],e=a[1],n=a[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.setMyPushTriggerOption({channelUrl:i.url,pushTriggerOption:e},function(e,n){var t=null;if(!e){try{t=n.push_trigger_option}catch(e){_e.debug(e)}i.myPushTriggerOption=t}r(e,t)})},n)}},{key:"setMyCountPreference",value:function(e,n){var t,i=this,a=D.get(this._iid).GroupChannel,r=C(O.parse(arguments,[new O({type:a.CountPreference}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.setMyCountPreference({channelUrl:i.url,countPreference:e},function(e,n){var t=null;e||(t=i.myCountPreference=n.count_preference,i._setGroupChannelUnreadCount(i.unreadMessageCount,i.unreadMentionCount),a.cachedChannels[i.url]=i),r(e,t)})},n)}},{key:"resetMyHistory",value:function(e){var i=this;return j(this._iid,function(r){pe.get(i._iid).container.apiClient.resetMyHistory({channelUrl:i.url},function(e,n){if(!e&&n.hasOwnProperty("ts_message_offset")){var t=D.get(i._iid).GroupChannel;i._messageOffsetTimestamp=n.ts_message_offset,t.cachedChannels[i.url]=i}r(e,n)})},e)}},{key:"messageOffsetTimestamp",get:function(){return this._messageOffsetTimestamp}}],[{key:"buildFromSerializedData",value:function(e){var n,t=D.get(this._iid),r=t.User,i=t.Member,a=t.GroupChannel,s=t.BaseMessage,o=t.UserMessage,l=t.FileMessage,u=t.AdminMessage,c=q.deserialize(e);return new a({channel_url:c.url,name:c.name,cover_url:c.coverUrl,data:c.data,custom_type:c.customType,invited_at:c.invitedAt,created_at:c.createdAt/1e3,is_access_code_required:c.isAccessCodeRequired,is_distinct:c.isDistinct,is_super:c.isSuper,is_broadcast:c.isBroadcast,is_public:c.isPublic,is_discoverable:c.isDiscoverable,freeze:c.isFrozen,is_ephemeral:c.isEphemeral,unread_message_count:c.unreadMessageCount,unread_mention_count:c.unreadMentionCount,is_push_enabled:c.isPushEnabled,push_trigger_option:c.myPushTriggerOption,count_preference:c.myCountPreference,is_hidden:c.isHidden,hidden_state:c.hiddenState,member_count:c.memberCount,joined_member_count:c.joinedMemberCount,member_state:c.myMemberState,my_role:c.myRole,is_muted:c.myMutedState,user_last_read:c.myLastRead,ts_message_offset:c.messageOffsetTimestamp,message_survival_seconds:c.messageSurvivalSeconds,read_receipt:c.cachedReadReceiptStatus,delivery_receipt:c.cachedDeliveryReceiptStatus,members:c.members.map(function(e){return i.build(r.build(e.userId,e.nickname,e.profileUrl,e.connectionStatus,e.lastSeenAt,e.metaData,e.isActive,e.friendDiscoveryKey,e.friendName),e.state,e.role,e.isBlockedByMe,e.isBlockingMe)}),last_message:null!=(n=c.lastMessage)&&"object"===de(n)?n.messageType===s.MESSAGE_TYPE_USER?new o(o.build(n.reqId,n.messageId,n.user,{url:n.channelUrl,channelType:n.channelType},n.message,n.data,n.customType,n.translations,n.isGlobalBlocked,n.createdAt,n.updatedAt,n.metaArrays,n.reactions,n.mentionType,n.mentionedUsers,n.rootMessageId,n.parentMessageId,n.parentMessageText,n.threadInfo,n.mentionedUserIds,n.sendingStatus,n.requestedMentionUserIds,n.errorCode,n.messageSurvivalSeconds)):n.messageType===s.MESSAGE_TYPE_FILE?new l(l.build(n.reqId,n.messageId,n.user,{url:n.channelUrl,channelType:n.channelType},n.url,n.name,n.type,n.size,n.data,n.customType,n.isGlobalBlocked,n.createdAt,n.thumbnails,n.requireAuth,n.updatedAt,n.metaArrays,n.reactions,n.mentionType,n.mentionedUsers,n.rootMessageId,n.parentMessageId,n.parentMessageText,n.threadInfo,n.mentionedUserIds,n.sendingStatus,n.requestedMentionUserIds,n.errorCode,n.requestedMentionUserIds)):new u(u.build(n.messageId,{url:n.channelUrl,channelType:n.channelType},n.message,n.data,n.customType,n.translations,n.createdAt,n.updatedAt,n.metaArrays,n.reactions,n.mentionType,n.mentionedUsers,n.rootMessageId,n.parentMessageId,n.parentMessageText,n.threadInfo)):null,inviter:null!==c.inviter&&void 0!==c.inviter&&"object"===de(c.inviter)?r.build.apply(r,b(["userId","nickname","profileUrl","connectionStatus","lastSeenAt","metaData","isActive","friendDiscoveryKey","friendName"].map(function(e){return c.inviter[e]}))):null,__wk:c.__wk})}},{key:"upsert",value:function(e){var n=D.get(this._iid).GroupChannel,t=new n(e);if(n.cachedChannels.hasOwnProperty(t.url)){if(t.isEphemeral){var r=n.cachedChannels[t.url];e.last_message=r.lastMessage,e.unread_message_count=r.unreadMessageCount}n.cachedChannels[t.url].update(e)}else n.cachedChannels[t.url]=t;return n.cachedChannels[t.url]}},{key:"removeCachedChannel",value:function(e){var n=D.get(this._iid),t=n.GroupChannel,r=n.FileMessageQueue;t.cachedChannels[e]&&delete t.cachedChannels[e],r.delete(e)}},{key:"clearCache",value:function(){oe[this._iid]={},D.get(this._iid).FileMessageQueue.clear()}},{key:"getChannel",value:function(n,e){var t,r=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);if(t=r[0],n=r[1],e=r[2],t)return j(this._iid,function(e){e(t,null)},e);var i=D.get(this._iid).GroupChannel;return i.cachedChannels[n]?j(this._iid,function(e){e(null,i.cachedChannels[n])},e):i.getChannelWithoutCache(n,e)}},{key:"getChannelWithoutCache",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.getGroupChannel({channelUrl:e,showMember:!0},function(e,n){var t=null;e||(t=D.get(i._iid).GroupChannel.upsert(n));r(e,t)})},n)}},{key:"createDistinctChannelIfNotExist",value:function(e,n){var t,a=this,r=D.get(this._iid).GroupChannelParams,i=C(O.parse(arguments,[new O({type:r,constraint:function(e){return e._validate()}}),new O({type:"callback"})]),3);return t=i[0],e=i[1],n=i[2],j(this._iid,function(i){t?i(t,null):(e.isPublic||(e.accessCode=null),pe.get(a._iid).container.apiClient.createGroupChannel(_(_({},e),{},{isDistinct:!0}),function(e,n){var t=null;if(!e){var r=D.get(a._iid).GroupChannel;t={channel:new r(n),isCreated:n.is_created},r.cachedChannels[t.channel.url]=t.channel}i(e,t)}))},n)}},{key:"createChannel",value:function(){var n=this,t=O.toArray(arguments),e=void 0;"function"==typeof t[t.length-1]&&(e=t.pop());var r=D.get(this._iid),i=r.GroupChannel,a=r.GroupChannelParams;if(t[0]instanceof a&&1===t.length)return j(this._iid,function(r){var e=t[0];(e.isPublic||(e.accessCode=null),e._validate())?pe.get(n._iid).container.apiClient.createGroupChannel(e,function(e,n){var t=null;e||(t=new i(n),i.cachedChannels[t.url]=t),r(e,t)}):r(O.error,null)},e);if(Array.isArray(t[0])){var s=new a;switch(t.length){case 1:s.addUsers(t[0]);break;case 2:s.addUsers(t[0]),s.isDistinct=t[1];break;case 3:s.addUsers(t[0]),s.isDistinct=t[1],s.customType=t[2];break;case 5:s.addUsers(t[0]),s.isDistinct=t[1],s.name=t[2],"string"==typeof t[3]?s.coverUrl=t[3]:s.coverImage=t[3],s.data=t[4];break;case 6:s.addUsers(t[0]),s.isDistinct=t[1],s.name=t[2],"string"==typeof t[3]?s.coverUrl=t[3]:s.coverImage=t[3],s.data=t[4],s.customType=t[5];break;default:return j(this._iid,function(e){return e(O.error,null)},e)}return e?i.createChannel(s,e):i.createChannel(s)}return j(this._iid,function(e){return e(O.error,null)},e)}},{key:"createChannelWithUserIds",value:function(){var e=O.toArray(arguments),n=void 0;"function"==typeof e[e.length-1]&&(n=e.pop());var t=D.get(this._iid),r=t.GroupChannel,i=new t.GroupChannelParams;switch(e.length){case 1:i.addUserIds(e[0]);break;case 2:i.addUserIds(e[0]),i.isDistinct=e[1];break;case 3:i.addUserIds(e[0]),i.isDistinct=e[1],i.customType=e[2];break;case 5:i.addUserIds(e[0]),i.isDistinct=e[1],i.name=e[2],"string"==typeof e[3]?i.coverUrl=e[3]:i.coverImage=e[3],i.data=e[4];break;case 6:i.addUserIds(e[0]),i.isDistinct=e[1],i.name=e[2],"string"==typeof e[3]?i.coverUrl=e[3]:i.coverImage=e[3],i.data=e[4],i.customType=e[5];break;default:return j(this._iid,function(e){return e(O.error,null)},n)}return r.createChannel(i,n)}},{key:"createMyGroupChannelListQuery",value:function(){return new(D.get(this._iid).GroupChannelListQuery)}},{key:"createPublicGroupChannelListQuery",value:function(){return new(D.get(this._iid).PublicGroupChannelListQuery)}},{key:"getChannelCount",value:function(e,n){return En.getInstance(this._iid).getGroupChannelCount(e,n)}},{key:"getUnreadItemCount",value:function(e,n){return En.getInstance(this._iid).getUnreadItemCount(e,n)}},{key:"getTotalUnreadMessageCount",value:function(){var e=O.toArray(arguments),n="function"==typeof e[e.length-1]?e.pop():null,t=En.getInstance(this._iid);return t.getTotalUnreadMessageCount.apply(t,b(e).concat([n]))}},{key:"getTotalUnreadChannelCount",value:function(e){return En.getInstance(this._iid).getTotalUnreadChannelCount(e)}},{key:"MemberStateFilter",get:function(){return{ALL:"all",JOINED:"joined_only",INVITED:"invited_only",INVITED_BY_FRIEND:"invited_by_friend",INVITED_BY_NON_FRIEND:"invited_by_non_friend"}}},{key:"PushTriggerOption",get:function(){return{DEFAULT:"default",ALL:"all",MENTION_ONLY:"mention_only",OFF:"off"}}},{key:"CountPreference",get:function(){return{ALL:"all",UNREAD_MESSAGE_COUNT_ONLY:"unread_message_count_only",UNREAD_MENTION_COUNT_ONLY:"unread_mention_count_only",OFF:"off"}}},{key:"HiddenState",get:function(){return{UNHIDDEN:"unhidden",HIDDEN_ALLOW_AUTO_UNHIDE:"hidden_allow_auto_unhide",HIDDEN_PREVENT_AUTO_UNHIDE:"hidden_prevent_auto_unhide"}}},{key:"PublicChannelFilter",get:function(){return{ALL:"all",PUBLIC:"public",PRIVATE:"private"}}},{key:"SuperChannelFilter",get:function(){return{ALL:"all",SUPER:"super",NON_SUPER:"nonsuper"}}},{key:"UnreadChannelFilter",get:function(){return{ALL:"all",UNREAD_MESSAGE:"unread_message"}}},{key:"HiddenChannelFilter",get:function(){return{UNHIDDEN:"unhidden_only",HIDDEN:"hidden_only",HIDDEN_ALLOW_AUTO_UNHIDE:"hidden_allow_auto_unhide",HIDDEN_PREVENT_AUTO_UNHIDE:"hidden_prevent_auto_unhide"}}},{key:"Role",get:function(){return{OPERATOR:"operator",NONE:"none"}}},{key:"UnreadItemKey",get:function(){return{GROUP_CHANNEL_UNREAD_MENTION_COUNT:"group_channel_unread_mention_count",NONSUPER_UNREAD_MENTION_COUNT:"non_super_group_channel_unread_mention_count",SUPER_UNREAD_MENTION_COUNT:"super_group_channel_unread_mention_count",GROUP_CHANNEL_UNREAD_MESSAGE_COUNT:"group_channel_unread_message_count",NONSUPER_UNREAD_MESSAGE_COUNT:"non_super_group_channel_unread_message_count",SUPER_UNREAD_MESSAGE_COUNT:"super_group_channel_unread_message_count",GROUP_CHANNEL_INVITATION_COUNT:"group_channel_invitation_count",NONSUPER_INVITATION_COUNT:"non_super_group_channel_invitation_count",SUPER_INVITATION_COUNT:"super_group_channel_invitation_count"}}},{key:"cachedChannels",get:function(){return oe[this._iid]||(oe[this._iid]={}),oe[this._iid]}},{key:"markAsReadAllLastSentAt",get:function(){return le[this._iid]||0},set:function(e){le[this._iid]=e}}]),a}(),Ue=function(){o(r,V);var t=h(r);function r(e){var n;return v(this,r),(n=t.call(this,e)).state="",n.role="",n.isBlockedByMe=!1,n.isBlockingMe=!1,e&&n._update(e),n}return s(r,[{key:"_update",value:function(e){this.state=e.state,this.role=e.role||Ee.Role.NONE,e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me),e.hasOwnProperty("is_blocking_me")&&(this.isBlockingMe=e.is_blocking_me)}},{key:"parse",value:function(e){this._update(e)}}],[{key:"build",value:function(e,n,t,r,i){var a=e;return a.state=n,a.role=t||"",a.is_blocked_by_me=r||!1,a.is_blocking_me=i||!1,a}},{key:"buildFromSerializedData",value:function(e){var n=D.get(this._iid),t=n.User,r=n.Member,i=q.deserialize(e);return new r(r.build(t.build(i.userId,i.nickname,i.profileUrl,i.connectionStatus,i.lastSeenAt,i.metaData,i.isActive,i.friendDiscoveryKey,i.friendName),i.state,i.role,i.isBlockedByMe,i.isBlockingMe))}},{key:"JOINED",get:function(){return"joined"}},{key:"INVITED",get:function(){return"invited"}}]),r}(),be=function(){o(r,V);var t=h(r);function r(e){var n;return v(this,r),(n=t.call(this,e)).isBlockedByMe=!1,e&&n._update(e),n}return s(r,[{key:"parse",value:function(e){this._update(e)}},{key:"_update",value:function(e){e.hasOwnProperty("is_blocked_by_me")&&(this.isBlockedByMe=e.is_blocked_by_me)}}],[{key:"build",value:function(e,n){var t=e;return t.is_blocked_by_me=n||!1,t}},{key:"buildFromSerializedData",value:function(e){var n=D.get(this._iid),t=n.User,r=n.Sender,i=q.deserialize(e);return new r(r.build(t.build.apply(t,b(["userId","nickname","profileUrl","connectionStatus","lastSeenAt","metaData","isActive","friendDiscoveryKey","friendName"].map(function(e){return i[e]}))),i.isBlockedByMe))}}]),r}(),Se=function(){function n(e){v(this,n),this.emojiHash=null,this.emojiCategories=null,e&&this._update(e)}return s(n,[{key:"_update",value:function(e){var n=D.get(this._iid).EmojiCategory;this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map(function(e){return new n(e)}):[]}}]),n}(),Ae=function(){function n(e){v(this,n),this.id=null,this.name=null,this.url=null,this.emojis=null,e&&this._update(e)}return s(n,[{key:"_update",value:function(e){var n=D.get(this._iid).Emoji;this.id=e.id||"",this.name=e.name||"",this.url=e.url||"",this.emojis=e.emojis?e.emojis.map(function(e){return new n(e)}):[]}}]),n}(),Ie=function(){function n(e){v(this,n),this.key=null,this.url=null,e&&this._update(e)}return s(n,[{key:"_update",value:function(e){this.key=e.key,this.url=e.url}}]),n}(),Ne={},ke={},Me=function(){o(r,J);var t=h(r);function r(e){var n;return v(this,r),(n=t.call(this,e)).channelType=J.CHANNEL_TYPE_OPEN,n.participantCount=0,n.operators=[],e&&n._update(e),n}return s(r,[{key:"_update",value:function(e){var n=D.get(this._iid).User;if(e.hasOwnProperty("participant_count")&&(this.participantCount=parseInt(e.participant_count)),e.hasOwnProperty("operators")&&e.operators){this.operators=[];for(var t=0;t<e.operators.length;t++){var r=new n(e.operators[t]);this.operators.push(r)}}}},{key:"parse",value:function(e){this._update(e)}},{key:"update",value:function(e){this.__update(e),this._update(e)}},{key:"createParticipantListQuery",value:function(){return new(D.get(this._iid).ParticipantListQuery)({channelUrl:this.url})}},{key:"createMutedUserListQuery",value:function(){return new(D.get(this._iid).MutedUserListQuery)({channelUrl:this.url,isOpenChannel:!0})}},{key:"createBannedUserListQuery",value:function(){return new(D.get(this._iid).BannedUserListQuery)({channelUrl:this.url,isOpenChannel:!0})}},{key:"isOperator",value:function(e){return!!e&&this.isOperatorWithUserId(e.userId)}},{key:"isOperatorWithUserId",value:function(e){return-1<this.operators.map(function(e){return e.userId}).indexOf(e)}},{key:"refresh",value:function(e){return D.get(this._iid).OpenChannel.getChannelWithoutCache(this.url,e)}},{key:"enter",value:function(e){var a=this;return j(this._iid,function(r){var e=D.get(a._iid).Command.bEnter({channelUrl:a.url}),i=En.getInstance(a._iid);i.sendCommand(e,function(e,n){if(i.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}n?(n=n?new fe(n.message,n.code):null,r(n,null)):(D.get(a._iid).OpenChannel.enteredChannels[a.url]=a).refresh(function(){return r(null,null)})})},e)}},{key:"exit",value:function(e){var s=this;return j(this._iid,function(r){var e=D.get(s._iid),n=e.Command,i=e.FileMessageQueue,t=n.bExit({channelUrl:s.url}),a=En.getInstance(s._iid);a.sendCommand(t,function(e,n){if(a.getErrorFirstCallback()){var t=[e,n];n=t[0],e=t[1]}n?(n=n?new fe(n.message,n.code):null,r(n,null)):(delete D.get(s._iid).OpenChannel.enteredChannels[s.url],i.delete(s.url),r(null,null))})},e)}},{key:"updateChannel",value:function(e,n,t,i,a,r){var s,o=this,l=C(O.parse(arguments,[new O({type:"string",nullable:!0}),new O({type:["string","file"],nullable:!0}),new O({type:"string",nullable:!0}),new O({type:"array",nullable:!0,optional:!0,defaultValue:null,constraint:function(e){return e.map(function(e){return"string"==typeof e})}}),new O({type:"string",nullable:!0,optional:!0}),new O({type:"callback"})]),7);return s=l[0],e=l[1],n=l[2],t=l[3],i=l[4],a=l[5],r=l[6],j(this._iid,function(r){s?r(s,null):pe.get(o._iid).container.apiClient.updateOpenChannel({channelUrl:o.url,name:e,coverUrlOrImage:n,data:t,operatorUserIds:i,customType:a},function(e,n){var t=null;e||(t=D.get(o._iid).OpenChannel.upsert(n));r(e,t)})},r)}},{key:"updateChannelWithOperatorUserIds",value:function(){var e=O.toArray(arguments),n=void 0;switch("function"==typeof e[e.length-1]&&(n=e.pop()),e.length){case 4:case 5:return this.updateChannel.apply(this,b(e).concat([n]));default:return j(this._iid,function(e){return e(O.error,null)},n)}}},{key:"muteUser",value:function(e,n,t,r){return this.muteUserWithUserId(e?e.userId:null,n,t,r)}},{key:"muteUserWithUserId",value:function(e,n,r,t){var i,a=this,s=C(O.parse(arguments,[new O({type:"string"}),new O({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return-1<=e}}),new O({type:"string",optional:!0,defaultValue:""}),new O({type:"callback"})]),5);return i=s[0],e=s[1],n=s[2],r=s[3],t=s[4],j(this._iid,function(t){i?t(i,null):pe.get(a._iid).container.apiClient.muteUser({channelUrl:a.url,userId:e,description:r,seconds:n,isGroupChannel:!1},function(e,n){t(e,null)})},t)}},{key:"unmuteUser",value:function(e,n){return this.unmuteUserWithUserId(e?e.userId:null,n)}},{key:"unmuteUserWithUserId",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.unmuteUser({channelUrl:i.url,userId:e,isGroupChannel:!1},function(e,n){t(e,null)})},n)}},{key:"banUser",value:function(e,n,t){return this.banUserWithUserId(e?e.userId:null,n,t)}},{key:"banUserWithUserId",value:function(e,n,t){var r,i=this,a=C(O.parse(arguments,[new O({type:"string"}),new O({type:"number",optional:!0,defaultValue:-1,constraint:function(e){return-1<=e}}),new O({type:"callback"})]),4);return r=a[0],e=a[1],n=a[2],t=a[3],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.banUser({channelUrl:i.url,userId:e,description:null,seconds:n,isGroupChannel:!1},function(e,n){t(e,null)})},t)}},{key:"unbanUser",value:function(e,n){return this.unbanUserWithUserId(e?e.userId:null,n)}},{key:"unbanUserWithUserId",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.unbanUser({channelUrl:i.url,userId:e,isGroupChannel:!1},function(e,n){t(e,null)})},n)}},{key:"delete",value:function(e){var r=this;return j(this._iid,function(t){pe.get(r._iid).container.apiClient.deleteOpenChannel({channelUrl:r.url},function(e,n){e||(delete D.get(r._iid).OpenChannel.cachedChannels[r.url],D.get(r._iid).FileMessageQueue.delete(r.url));t(e,n)})},e)}}],[{key:"buildFromSerializedData",value:function(e){var n=D.get(this._iid),t=n.User,r=n.OpenChannel,i=q.deserialize(e);return new r({channel_url:i.url,name:i.name,cover_url:i.coverUrl,data:i.data,custom_type:i.customType,created_at:i.createdAt/1e3,freeze:i.isFrozen,is_ephemeral:i.isEphemeral,participant_count:i.participantCount,operators:i.operators.map(function(n){return t.build.apply(t,b(["userId","nickname","profileUrl","connectionStatus","lastSeenAt","metaData","isActive","friendDiscoveryKey","friendName"].map(function(e){return n[e]})))}),__wk:i.__wk})}},{key:"getChannel",value:function(n,e){var t,r=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),3);if(t=r[0],n=r[1],e=r[2],t)return j(this._iid,function(e){e(t,null)},e);var i=D.get(this._iid).OpenChannel;return i.cachedChannels[n]?j(this._iid,function(e){e(null,i.cachedChannels[n])},e):i.getChannelWithoutCache(n,e)}},{key:"getChannelWithoutCache",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.getOpenChannel({channelUrl:e},function(e,n){var t=null;e||(t=D.get(i._iid).OpenChannel.upsert(n));r(e,t)})},n)}},{key:"createChannel",value:function(e,n,t,i,a,r){var s,o=this,l=C(O.parse(arguments,[new O({type:"string",nullable:!0,ignoreIf:function(e){return 0===e.length}}),new O({type:["string","file"],nullable:!0,ignoreIf:function(e){return 0===e.length}}),new O({type:"string",nullable:!0,ignoreIf:function(e){return 0===e.length}}),new O({type:"array",nullable:!0,ignoreIf:function(e){return e.length<4},constraint:function(e){return e.map(function(e){return"string"==typeof e})}}),new O({type:"string",nullable:!0,ignoreIf:function(e){return e.length<5}}),new O({type:"callback"})]),7);return s=l[0],e=l[1],n=l[2],t=l[3],i=l[4],a=l[5],r=l[6],j(this._iid,function(r){s?r(s,null):pe.get(o._iid).container.apiClient.createOpenChannel({name:e,coverUrlOrImage:n,data:t,operatorUserIds:i,customType:a},function(e,n){var t=null;e||(t=D.get(o._iid).OpenChannel.upsert(n));r(e,t)})},r)}},{key:"createChannelWithOperatorUserIds",value:function(){var e=O.toArray(arguments),n=void 0;switch("function"==typeof e[e.length-1]&&(n=e.pop()),e.length){case 4:case 5:return this.createChannel.apply(this,b(e).concat([n]));default:return j(this._iid,function(e){return e(O.error,null)},n)}}},{key:"upsert",value:function(e){var n=new(D.get(this._iid).OpenChannel)(e);return this.cachedChannels.hasOwnProperty(n.url)?this.cachedChannels[n.url].update(e):this.cachedChannels[n.url]=n,this.cachedChannels[n.url]}},{key:"removeCachedChannel",value:function(e){this.cachedChannels[e]&&delete this.cachedChannels[e],D.get(this._iid).FileMessageQueue.delete(e)}},{key:"clearCache",value:function(){Ne[this._iid]={},D.get(this._iid).FileMessageQueue.clear()}},{key:"clearEnteredChannels",value:function(){ke[this._iid]={}}},{key:"createOpenChannelListQuery",value:function(){return new(D.get(this._iid).OpenChannelListQuery)}},{key:"cachedChannels",get:function(){return Ne[this._iid]||(Ne[this._iid]={}),Ne[this._iid]}},{key:"enteredChannels",get:function(){return ke[this._iid]||(ke[this._iid]={}),ke[this._iid]}}]),r}(),Re=function(){o(r,K);var t=h(r);function r(e){var n;return v(this,r),(n=t.call(this,e)).messageType=K.MESSAGE_TYPE_USER,n.message=null,n._sender=null,n.reqId="",n.translations={},n.requestState=null,n.sendingStatus=null,n.requestedMentionUserIds=[],n.errorCode=0,n.messageSurvivalSeconds=-1,e&&n._update(e),n}return s(r,[{key:"_update",value:function(e){var n=En.getInstance(this._iid),t=D.get(this._iid).Sender;this.message=String(e.message),this._sender=new t(e.user),this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.translations=e.hasOwnProperty("translations")?e.translations:{},this.sendingStatus=0<this.messageId?n.MessageSendingStatus.SUCCEEDED:n.MessageSendingStatus.FAILED,e.hasOwnProperty("sending_status")&&(this.sendingStatus=e.sending_status),this.requestState=0<this.messageId?n.MessageRequestState.SUCCEEDED:n.MessageRequestState.FAILED,e.hasOwnProperty("sending_status")&&(this.requestState=e.sending_status,this.requestState===n.MessageSendingStatus.CANCELED&&(this.requestState=n.MessageRequestState.FAILED)),this.requestedMentionUserIds=[],e.hasOwnProperty("requested_mention_user_ids")&&(this.requestedMentionUserIds=e.requested_mention_user_ids),this.errorCode=0,e.hasOwnProperty("error_code")&&(this.errorCode=e.error_code),this.messageSurvivalSeconds=-1,e.hasOwnProperty("message_survival_seconds")&&(this.messageSurvivalSeconds=e.message_survival_seconds)}},{key:"isResendable",value:function(){var e=En.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.FAILED&&ge.isResendableError(this.errorCode)}},{key:"sender",get:function(){var e=En.getInstance(this._iid),n=D.get(this._iid).GroupChannel;if(e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var t=n.cachedChannels[this.channelUrl];if(t){var r=t.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.profileUrl!==r.profileUrl&&(this._sender.profileUrl=r.profileUrl),ge.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}}],[{key:"build",value:function(e,n,t,r,i,a,s,o,l,u,c,d,h,p,f,_,g,y,m,v,C,E,U,b){var S=En.getInstance(this._iid),A=D.get(this._iid),I=A.BaseChannel,N=A.BaseMessageParams,k={};e&&(k.req_id=e),k.msg_id=n;var M={user_id:"",nickname:"",profile_url:"",metadata:{},is_blocked_by_me:!1};if(t){M.user_id=t.userId,M.nickname=t.nickname,M.profile_url=t.profileUrl;try{M.metadata="string"==typeof t.metaData?JSON.parse(t.metaData):t.metaData}catch(e){M.metadata={}}M.is_blocked_by_me=t.isBlockedByMe}if(k.user=M,k.channel_url=r.url,k.channel_type=r.channelType===I.CHANNEL_TYPE_OPEN?I.CHANNEL_TYPE_OPEN:I.CHANNEL_TYPE_GROUP,k.message=i,a&&(k.data=a),s&&(k.custom_type=s),o&&(k.translations=o),k.is_global_block=!!l,k.ts=u,k.updated_at=c,d){k.metaarray={};for(var R=0;R<d.length;R++){var T=d[R].key;k.metaarray[T]=d[R].value}k.metaarray_key_order=d.map(function(e){return e.key})}return k.reactions=h||[],k.mention_type=N.MentionType.USERS,p&&(k.mention_type=p),k.mentioned_users=[],f&&(k.mentioned_users=f),_&&(k.root_message_id=_),g&&(k.parent_message_id=g),y&&(k.parent_message_text=y),m&&(k.thread_info=m),v&&(k.mentioned_user_ids=v),k.sending_status=0<n?S.MessageSendingStatus.SUCCEEDED:S.MessageSendingStatus.FAILED,C&&(k.sending_status=C),k.requested_mention_user_ids=[],E&&(k.requested_mention_user_ids=E),k.error_code=U||0,k.message_survival_seconds=b||-1,k}},{key:"buildFromSerializedData",value:function(e){var n=D.get(this._iid),t=n.User,r=n.UserMessage,i=[],a=q.deserialize(e,function(e){e.mentionedUsers.forEach(function(n){i.push(t.build.apply(t,b(["userId","nickname","profileUrl","connectionStatus","lastSeenAt","metaData","isActive","friendDiscoveryKey","friendName"].map(function(e){return n[e]}))))})});return new r(r.build(a.reqId,a.messageId,a.sender,{url:a.channelUrl,channelType:a.channelType},a.message,a.data,a.customType,a.translations,a.isGlobalBlocked,a.createdAt,a.updatedAt,a.metaArrays,a.reactions,a.mentionType,i,a.rootMessageId,a.parentMessageId,a.parentMessageText,a.threadInfo,a.mentionedUserIds,a.sendingStatus,a.requestedMentionUserIds,a.errorCode,a.messageSurvivalSeconds))}}]),r}(),Te=function(){o(r,K);var t=h(r);function r(e){var n;return v(this,r),(n=t.call(this,e)).messageType=K.MESSAGE_TYPE_FILE,n.url=null,n.name="File",n.size=0,n.type=null,n.data=null,n.thumbnails=[],n._sender=null,n.reqId="",n.requireAuth=null,n.requestState=null,n.sendingStatus=null,n.requestedMentionUserIds=[],n.errorCode=0,n.messageSurvivalSeconds=-1,e&&n._update(e),n}return s(r,[{key:"_update",value:function(e){var n=En.getInstance(this._iid),t=pe.get(this._iid).container.auth,r=D.get(this._iid).Sender;if(this._sender=new r(e.user),this.requireAuth=!!e.hasOwnProperty("require_auth")&&e.require_auth,this.url=this.requireAuth?String(e.url).split("?auth=")[0]+"?auth="+t.eKey:String(e.url).split("?auth=")[0],this.name=e.hasOwnProperty("name")?e.name:"File",this.size=parseInt(e.size)||0,this.type=String(e.type),this.data=e.hasOwnProperty("custom")?String(e.custom):"",this.reqId=e.hasOwnProperty("req_id")?String(e.req_id):"",this.thumbnails=e.hasOwnProperty("thumbnails")?e.thumbnails:[],this.requireAuth)for(var i in this.thumbnails)this.thumbnails[i].url=String(this.thumbnails[i].url).split("?auth=")[0]+"?auth="+t.eKey;this.sendingStatus=0<this.messageId?n.MessageSendingStatus.SUCCEEDED:n.MessageSendingStatus.FAILED,e.hasOwnProperty("sending_status")&&(this.sendingStatus=e.sending_status),this.requestState=0<this.messageId?n.MessageRequestState.SUCCEEDED:n.MessageRequestState.FAILED,e.hasOwnProperty("sending_status")&&(this.requestState=e.sending_status,this.requestState===n.MessageSendingStatus.CANCELED&&(this.requestState=n.MessageRequestState.FAILED)),this.requestedMentionUserIds=[],e.hasOwnProperty("requested_mention_user_ids")&&(this.requestedMentionUserIds=e.requested_mention_user_ids),this.errorCode=0,e.hasOwnProperty("error_code")&&(this.errorCode=e.error_code),this.messageSurvivalSeconds=-1,e.hasOwnProperty("message_survival_seconds")&&(this.messageSurvivalSeconds=e.message_survival_seconds)}},{key:"isResendable",value:function(){var e=En.getInstance(this._iid);return this.sendingStatus===e.MessageSendingStatus.FAILED&&ge.isResendableError(this.errorCode)}},{key:"sender",get:function(){var e=En.getInstance(this._iid),n=D.get(this._iid).GroupChannel;if(e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var t=n.cachedChannels[this.channelUrl];if(t){var r=t.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.profileUrl!==r.profileUrl&&(this._sender.profileUrl=r.profileUrl),ge.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}}],[{key:"build",value:function(e,n,t,r,i,a,s,o,l,u,c,d,h,p,f,_,g,y,m,v,C,E,U,b,S,A,I,N){var k=En.getInstance(this._iid),M=D.get(this._iid),R=M.BaseChannel,T=M.BaseMessageParams,O={};O.req_id=e,O.msg_id=n;var L={user_id:"",nickname:"",profile_url:"",metadata:{},is_global_block:!1};if(t){L.user_id=t.userId,L.nickname=t.nickname,L.profile_url=t.profileUrl;try{L.metadata=JSON.parse(t.metaData)}catch(e){L.metadata={}}L.is_blocked_by_me=t.isBlockedByMe}if(O.user=L,O.channel_url=r.url,O.channel_type=r.channelType===R.CHANNEL_TYPE_OPEN?R.CHANNEL_TYPE_OPEN:R.CHANNEL_TYPE_GROUP,O.url=i,O.name=a,O.type=s,O.size=o,O.custom=l,u&&(O.custom_type=u),O.is_global_block=c,O.ts=d,h&&(O.thumbnails=h),p&&(O.require_auth=p),O.updated_at=f,_){O.metaarray={};for(var w=0;w<_.length;w++){var P=_[w].key;O.metaarray[P]=_[w].value}O.metaarray_key_order=_.map(function(e){return e.key})}return O.reactions=g||[],O.mention_type=T.MentionType.USERS,y&&(O.mention_type=y),O.mentioned_users=[],m&&(O.mentioned_users=m),v&&(O.root_message_id=v),C&&(O.parent_message_id=C),E&&(O.parent_message_text=E),U&&(O.thread_info=U),b&&(O.mentioned_user_ids=b),O.sending_status=0<n?k.MessageSendingStatus.SUCCEEDED:k.MessageSendingStatus.FAILED,S&&(O.sending_status=S),O.requested_mention_user_ids=[],A&&(O.requested_mention_user_ids=A),O.error_code=I||0,O.message_survival_seconds=N||-1,O}},{key:"buildFromSerializedData",value:function(e){var n=D.get(this._iid),t=n.User,r=n.FileMessage,i=[],a=q.deserialize(e,function(e){e.mentionedUsers.forEach(function(n){i.push(t.build.apply(t,b(["userId","nickname","profileUrl","connectionStatus","lastSeenAt","metaData","isActive","friendDiscoveryKey","friendName"].map(function(e){return n[e]}))))})});return new r(r.build(a.reqId,a.messageId,a.sender,{url:a.channelUrl,channelType:a.channelType},a.url,a.name,a.type,a.size,a.data,a.customType,a.isGlobalBlocked,a.createdAt,a.thumbnails,a.requireAuth,a.updatedAt,a.metaArrays,a.reactions,a.mentionType,i,a.rootMessageId,a.parentMessageId,a.parentMessageText,a.threadInfo,a.mentionedUserIds,a.sendingStatus,a.requestedMentionUserIds,a.errorCode,a.messageSurvivalSeconds))}}]),r}(),Oe=function(){o(r,K);var t=h(r);function r(e){var n;return v(this,r),(n=t.call(this,e)).messageType=K.MESSAGE_TYPE_ADMIN,n.message="",n.translations={},e&&n._update(e),n}return s(r,[{key:"_update",value:function(e){this.message=String(e.message),this.translations=e.hasOwnProperty("translations")?e.translations:{}}}],[{key:"build",value:function(e,n,t,r,i,a,s,o,l,u,c,d,h,p,f,_){var g=D.get(this._iid).BaseChannel,y={msg_id:e,channel_url:n.url,channel_type:n.channelType===g.CHANNEL_TYPE_OPEN?g.CHANNEL_TYPE_OPEN:g.CHANNEL_TYPE_GROUP,ts:s,updated_at:o,message:t,data:r};if(i&&(y.custom_type=i),a&&(y.translations=a),l){y.metaarray={};for(var m=0;m<l.length;m++){var v=l[m].key;y.metaarray[v]=l[m].value}y.metaarray_key_order=l.map(function(e){return e.key})}return y.reactions=u||[],c&&(y.mention_type=c),y.mentioned_users=[],d&&(y.mentioned_users=d),h&&(y.root_message_id=h),p&&(y.parent_message_id=p),f&&(y.parent_message_text=f),_&&(y.thread_info=_),y}},{key:"buildFromSerializedData",value:function(e){var n=D.get(this._iid),t=n.AdminMessage,r=n.User,i=[],a=q.deserialize(e,function(e){e.mentionedUsers.forEach(function(n){i.push(r.build.apply(r,b(["userId","nickname","profileUrl","connectionStatus","lastSeenAt","metaData","isActive","friendDiscoveryKey","friendName"].map(function(e){return n[e]}))))})});return new t(t.build(a.messageId,{url:a.channelUrl,channelType:a.channelType},a.message,a.data,a.customType,a.translations,a.createdAt,a.updatedAt,a.metaArrays,a.reactions,a.mentionType,i,a.rootMessageId,a.parentMessageId,a.parentMessageText,a.threadInfo))}}]),r}(),Le=function(){function d(e){v(this,d);var n=D.get(this._iid),t=n.BaseMessage,r=n.BaseMessageParams;this.scheduledId=0,this.scheduledDateTimeString="",this.scheduledTimezone="",this.status=d.Status.SCHEDULED,this.createdAt=0,this.updatedAt=0,this._messageType=t.MESSAGE_TYPE_BASE,this._sender=null,this._channelType="",this.channelUrl="",this.message="",this.customType="",this.data="",this.metaArrays=[],this.mentionType=r.MentionType.USERS,this.mentionedUsers=[],this.pushNotificationDeliveryOption=r.PushNotificationDeliveryOption.DEFAULT,this.translationTargetLanguages=[],this.errorMessage="",this.errorCode=0,e&&this._update(e)}return s(d,[{key:"_update",value:function(e){var t=this,n=D.get(this._iid),r=n.User,i=n.Sender,a=n.BaseMessageParams,s=n.MessageMetaArray;this.scheduledId=e.hasOwnProperty("scheduled_id")?parseInt(e.scheduled_id):0,this.scheduledDateTimeString=e.hasOwnProperty("scheduled_dt")?String(e.scheduled_dt):"",this.scheduledTimezone=e.hasOwnProperty("scheduled_timezone")?String(e.scheduled_timezone):"",this.status=e.hasOwnProperty("status")?String(e.status):"",this.createdAt=e.hasOwnProperty("created_at")?parseInt(e.created_at):0,this.updatedAt=e.hasOwnProperty("updated_at")?parseInt(e.updated_at):0,this.channelUrl=e.hasOwnProperty("channel_url")?String(e.channel_url):"",this._channelType=e.hasOwnProperty("channel_type")?String(e.channel_type):"",this._messageType=e.hasOwnProperty("type")?String(e.type):"",this._sender=e.hasOwnProperty("user")?new i(e.user):"",this.message=e.hasOwnProperty("message")?String(e.message):"",this.customType=e.hasOwnProperty("custom_type")?String(e.custom_type):"",this.data=e.hasOwnProperty("data")?String(e.data):"";var o=e.hasOwnProperty("metaarray")?e.metaarray:{},l=e.hasOwnProperty("metaarray_key_order")?e.metaarray_key_order:Object.keys(o).sort(function(e,n){return e.localeCompare(n)});this.metaArrays=[];for(var u=0;u<l.length;u++){var c=l[u];this.metaArrays.push(new s(c,o[c]||[]))}this.mentionType=e.hasOwnProperty("mention_type")?e.mention_type:a.MentionType.USERS,this.mentionedUsers=[],e.hasOwnProperty("mentioned_users")&&e.mentioned_users.forEach(function(e){var n=new r(e);t.mentionedUsers.push(n)});this.pushNotificationDeliveryOption=e.hasOwnProperty("push_option")?e.push_option:a.PushNotificationDeliveryOption.DEFAULT,this.translationTargetLanguages=e.hasOwnProperty("translation_target_langs")?e.translation_target_langs:[],this.status===d.Status.FAILED&&(e.hasOwnProperty("error")&&e.error.hasOwnProperty("message")&&(this.errorMessage=String(e.error.message)),e.hasOwnProperty("error")&&e.error.hasOwnProperty("code")&&(this.errorCode=parseInt(e.error.code)))}},{key:"isOpenChannel",value:function(){var e=D.get(this._iid).BaseChannel;return this._channelType===e.CHANNEL_TYPE_OPEN}},{key:"isGroupChannel",value:function(){var e=D.get(this._iid).BaseChannel;return this._channelType===e.CHANNEL_TYPE_GROUP}},{key:"sender",get:function(){var e=En.getInstance(this._iid),n=D.get(this._iid).GroupChannel;if(e.Options.useMemberAsMessageSender&&this.isGroupChannel()){var t=n.cachedChannels[this.channelUrl];if(t){var r=t.memberMap[this._sender.userId];r&&(this._sender.nickname!==r.nickname&&(this._sender.nickname=r.nickname),this._sender.profileUrl!==r.profileUrl&&(this._sender.profileUrl=r.profileUrl),ge.deepEqual(this._sender.metaData,r.metaData)||(this._sender.metaData=r.metaData))}}return this._sender},set:function(e){this._sender=e}},{key:"metaArray",get:function(){var n={};return this.metaArrays.forEach(function(e){n[e.key]=e.value}),n},set:function(e){if("object"===de(e)&&e){var n=D.get(this._iid).MessageMetaArray,t=[];for(var r in e)t.push(new n(r,e[r]));this.metaArrays=t}}}],[{key:"Status",get:function(){return{SCHEDULED:"scheduled",SENT:"sent",CANCELED:"canceled",FAILED:"failed"}}}]),d}(),we=function(){function n(e){v(this,n),this.replyCount=0,this.mostRepliedUsers=[],this.lastRepliedAt=0,this.updatedAt=0,e&&this._update(e)}return s(n,[{key:"_update",value:function(e){var n=D.get(this._iid).User;e.hasOwnProperty("reply_count")&&(this.replyCount=parseInt(e.reply_count)),e.hasOwnProperty("most_replies")&&Array.isArray(e.most_replies)&&e.most_replies.every(function(e){return"object"===de(e)})&&(this.mostRepliedUsers=e.most_replies.map(function(e){return new n(e)})),e.hasOwnProperty("last_replied_at")&&(this.lastRepliedAt=parseInt(e.last_replied_at)),e.hasOwnProperty("updated_at")&&(this.updatedAt=parseInt(e.updated_at))}}],[{key:"build",value:function(e,n,t,r){var i={};i.reply_count=e,Array.isArray(n)&&n.every(function(e){return e instanceof V})&&(i.most_replies=n.map(function(e){return e.serialize()})),i.last_replied_at=t,i.updated_at=r}}]),n}(),Pe=function(){function e(){v(this,e),this.threadInfo=null,this.targetMessageId=0,this.channelUrl=null,this.channelType=null}return s(e,null,[{key:"createFromJson",value:function(e){var n=D.get(this._iid),t=n.BaseChannel,r=n.ThreadInfo,i=e.thread_info,a=e.root_message_id,s=e.channel_url,o=e.channel_type;if(!i||"object"!==de(i)||"string"!=typeof a&&"number"!=typeof a||"string"!=typeof s||"string"!=typeof o||![t.CHANNEL_TYPE_GROUP].includes(o))return null;var l=new this;return l.threadInfo=new r(i),l.targetMessageId=parseInt(a),l.channelUrl=s,l.channelType=o,l}}]),e}(),De=function(){function e(){v(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIdsFilter=[],this.metaDataKeyFilter="",this.metaDataValuesFilter=[],this._token=""}return s(e,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){"number"==typeof s.limit&&0<s.limit&&Array.isArray(s.userIdsFilter)&&"string"==typeof s.metaDataKeyFilter&&Array.isArray(s.metaDataValuesFilter)&&!!s.metaDataKeyFilter==0<s.metaDataValuesFilter.length?s.isLoading?a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasNext?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadUserList(_(_({},s),{},{token:s._token}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).User,i=String(n.next);s._token=i,s.hasNext=!!i,t=n.users.map(function(e){return new r(e)})}s.isLoading=!1,a(e,t)})):a(null,[]):a(O.error,null)},e)}}]),e}(),He=function(){function n(e){v(this,n),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._isOpenChannel=!1,this._channelUrl=null,this._token="",e.channelUrl&&(this._channelUrl=e.channelUrl),e.isOpenChannel&&(this._isOpenChannel=e.isOpenChannel)}return s(n,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){"number"==typeof s.limit&&0<s.limit?s.isLoading?a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasNext?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadBannedUserList(_(_({},s),{},{channelUrl:s._channelUrl,isOpenChannel:s._isOpenChannel,token:s._token}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).User,i=String(n.next);s._token=i,s.hasNext=!!i,t=n.banned_list.map(function(e){return new r(e.user)})}s.isLoading=!1,a(e,t)})):a(null,[]):a(O.error,null)},e)}}]),n}(),Fe=function(){function e(){v(this,e),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIdsFilter=[],this._token=""}return s(e,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){"number"==typeof s.limit&&0<s.limit&&Array.isArray(s.userIdsFilter)?s.isLoading?a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasNext?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadBlockedUserList(_(_({},s),{},{token:s._token}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).User,i=String(n.next);s._token=i,s.hasNext=!!i,t=n.users.map(function(e){return new r(e)})}s.isLoading=!1,a(e,t)})):a(null,[]):a(O.error,null)},e)}}]),e}(),Ge=function(){function e(){v(this,e),this.isLoading=!1,this.hasMore=!0,this.limit=20,this._token=""}return s(e,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){"number"==typeof s.limit&&0<s.limit?s.isLoading?a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasMore?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadFriendList(_(_({},s),{},{token:s._token}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).User,i=String(n.next);s._token=i,s.hasMore=!!i,t=n.users.map(function(e){return new r(e)})}s.isLoading=!1,a(e,t)})):a(null,[]):a(O.error,null)},e)}}]),e}(),qe=function(){function n(){v(this,n),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=n.ORDER_LATEST_LAST_MESSAGE,this._token="",this._searchFilter={},this._userIdsFilter={userIds:[],includeMode:!0,queryType:n.QueryType.AND},this._userIdsExactFilter=[],this._userIdsIncludeFilter=[],this._userIdsIncludeFilterQueryType=n.QueryType.AND,this.nicknameContainsFilter="",this.channelNameContainsFilter="",this.memberStateFilter=Ee.MemberStateFilter.ALL,this.customTypesFilter=[],this.channelUrlsFilter=[],this.superChannelFilter=Ee.SuperChannelFilter.ALL,this.publicChannelFilter=Ee.PublicChannelFilter.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=Ee.UnreadChannelFilter.ALL,this.metadataOrderKeyFilter=null,this.hiddenChannelFilter=Ee.HiddenChannelFilter.UNHIDDEN,this.includeFrozen=!0}return s(n,[{key:"setSearchFilter",value:function(e,n){Array.isArray(e)&&0!==e.length&&"string"==typeof n&&n&&(this._searchFilter={search_query:n,search_fields:e.join(",").toLocaleLowerCase()})}},{key:"serialize",value:function(){return q.serialize(this,function(e){e.isLoading=!1})}},{key:"next",value:function(e){var u=this;return j(this._iid,function(o){var e=D.get(u._iid),l=e.GroupChannel,n=e.GroupChannelListQuery;!("number"==typeof u.limit&&0<u.limit&&"boolean"==typeof u.includeEmpty&&"string"==typeof u.order&&-1<[n.ORDER_CHRONOLOGICAL,n.ORDER_LATEST_LAST_MESSAGE,n.CHANNEL_NAME_ALPHABETICAL,n.METADATA_VALUE_ALPHABETICAL].indexOf(u.order.toLowerCase())&&Array.isArray(u._userIdsExactFilter)&&Array.isArray(u._userIdsIncludeFilter)&&Array.isArray(u.customTypesFilter)&&Array.isArray(u.channelUrlsFilter)&&-1<Object.keys(n.QueryType).map(function(e){return n.QueryType[e]}).indexOf(u._userIdsIncludeFilterQueryType.toUpperCase())&&-1<Object.keys(l.MemberStateFilter).map(function(e){return l.MemberStateFilter[e]}).indexOf(u.memberStateFilter)&&-1<Object.keys(l.SuperChannelFilter).map(function(e){return l.SuperChannelFilter[e]}).indexOf(u.superChannelFilter)&&-1<Object.keys(l.PublicChannelFilter).map(function(e){return l.PublicChannelFilter[e]}).indexOf(u.publicChannelFilter)&&-1<Object.keys(l.UnreadChannelFilter).map(function(e){return l.UnreadChannelFilter[e]}).indexOf(u.unreadChannelFilter)&&-1<Object.keys(l.HiddenChannelFilter).map(function(e){return l.HiddenChannelFilter[e]}).indexOf(u.hiddenChannelFilter))||"string"!=typeof u.customTypeStartsWithFilter&&null!==u.customTypeStartsWithFilter||"string"!=typeof u.nicknameContainsFilter||"string"!=typeof u.channelNameContainsFilter||"string"!=typeof u.metadataOrderKeyFilter&&null!==u.metadataOrderKeyFilter||"boolean"!=typeof u.includeFrozen?o(O.error,null):u.isLoading?o(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):u.hasNext?(u.isLoading=!0,pe.get(u._iid).container.apiClient.loadGroupChannelList(_(_({},u),{},{token:u._token,userIdsFilter:u._userIdsFilter,searchFilter:u._searchFilter}),function(e,n){if(e)return u.isLoading=!1,void o(e,null);var t=[],r=String(n.next);u._token=r,u.hasNext=!!r;for(var i=n.channels,a=0;a<i.length;a++){var s=l.upsert(i[a]);t.push(s)}u.isLoading=!1,o(e,t)})):o(null,[])},e)}},{key:"userIdsExactFilter",get:function(){return this._userIdsExactFilter},set:function(e){Array.isArray(e)&&(this._userIdsExactFilter=e,this._userIdsIncludeFilter=[],this._userIdsFilter.userIds=this._userIdsExactFilter,this._userIdsFilter.includeMode=!1)}},{key:"userIdsIncludeFilter",get:function(){return this._userIdsIncludeFilter},set:function(e){Array.isArray(e)&&(this._userIdsIncludeFilter=e,this._userIdsExactFilter=[],this._userIdsFilter.userIds=this._userIdsIncludeFilter,this._userIdsFilter.includeMode=!0)}},{key:"userIdsIncludeFilterQueryType",get:function(){return this._userIdsIncludeFilterQueryType},set:function(e){-1<Object.keys(n.QueryType).map(function(e){return n.QueryType[e]}).indexOf(e)&&(this._userIdsIncludeFilterQueryType=e.toUpperCase(),this._userIdsFilter.queryType=this._userIdsIncludeFilterQueryType)}}],[{key:"buildFromSerializedData",value:function(e){var n=D.get(this._iid).GroupChannel,t=q.deserialize(e),r=n.createMyGroupChannelListQuery();for(var i in t)r.hasOwnProperty(i)&&(r[i]=t[i]);return r}},{key:"ORDER_LATEST_LAST_MESSAGE",get:function(){return"latest_last_message"}},{key:"ORDER_CHRONOLOGICAL",get:function(){return"chronological"}},{key:"CHANNEL_NAME_ALPHABETICAL",get:function(){return"channel_name_alphabetical"}},{key:"METADATA_VALUE_ALPHABETICAL",get:function(){return"metadata_value_alphabetical"}},{key:"QueryType",get:function(){return{AND:"AND",OR:"OR"}}},{key:"SearchField",get:function(){return{MEMBER_NICKNAME:"member_nickname",CHANNEL_NAME:"channel_name"}}}]),n}(),Be=function(){function n(e){v(this,n),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.mutedMemberFilter=n.MutedMemberFilter.ALL,this.memberStateFilter=Ee.MemberStateFilter.ALL,this.nicknameStartsWithFilter=null,this._token="",this._channelUrl=e}return s(n,[{key:"next",value:function(e){var s=this;return j(this._iid,function(i){var e=D.get(s._iid),n=e.GroupChannel,a=e.Member,t=e.MemberListQuery;if("number"==typeof s.limit&&0<s.limit&&-1<Object.keys(t.MutedMemberFilter).map(function(e){return t.MutedMemberFilter[e]}).indexOf(s.mutedMemberFilter)&&-1<Object.keys(n.MemberStateFilter).map(function(e){return n.MemberStateFilter[e]}).indexOf(s.memberStateFilter)&&("string"==typeof s.nicknameStartsWithFilter||null===s.nicknameStartsWithFilter))if(s.isLoading)i(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null);else if(s.hasNext){s.isLoading=!0;var r=t.Order.MEMBER_NICKNAME_ALPHABETICAL;pe.get(s._iid).container.apiClient.loadMemberList(_(_({},s),{},{channelUrl:s._channelUrl,order:r,token:s._token}),function(e,n){var t=null;if(!e){var r=String(n.next);s._token=r,s.hasNext=!!r,t=n.members.map(function(e){return new a(e)})}s.isLoading=!1,i(e,t)})}else i(null,[]);else i(O.error,null)},e)}}],[{key:"MutedMemberFilter",get:function(){return{ALL:"all",MUTED:"muted",UNMUTED:"unmuted"}}},{key:"Order",get:function(){return{MEMBER_NICKNAME_ALPHABETICAL:"member_nickname_alphabetical"}}}]),n}(),xe=function(){function n(e){v(this,n),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",e.channelUrl&&(this._channelUrl=e.channelUrl),e.isOpenChannel&&(this._isOpenChannel=e.isOpenChannel)}return s(n,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){"number"==typeof s.limit&&0<s.limit?s.isLoading?a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasNext?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadMutedUserList(_(_({},s),{},{channelUrl:s._channelUrl,isOpenChannel:s._isOpenChannel,token:s._token}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).User,i=String(n.next);s._token=i,s.hasNext=!!i,t=n.muted_list.map(function(e){return new r(e)})}s.isLoading=!1,a(e,t)})):a(null,[]):a(O.error,null)},e)}}]),n}(),ze=function(){function e(){v(this,e),this.limit=20,this.isLoading=!1,this.hasNext=!0,this.nameKeyword=null,this.urlKeyword=null,this.customTypes=[],this.includeFrozen=!0}return s(e,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){!("number"==typeof s.limit&&0<s.limit&&Array.isArray(s.customTypes))||"string"!=typeof s.nameKeyword&&null!==s.nameKeyword||"string"!=typeof s.urlKeyword&&null!==s.urlKeyword||"boolean"!=typeof s.includeFrozen?a(O.error,null):s.isLoading?a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasNext?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadOpenChannelList(_(_({},s),{},{token:s._token}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).OpenChannel,i=String(n.next);s._token=i,s.hasNext=!!i,t=n.channels.map(function(e){return r.upsert(e)})}s.isLoading=!1,a(e,t)})):a(null,[])},e)}}]),e}(),je=new WeakMap,Qe=function(){function n(e){v(this,n),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",je.set(this,e)}return s(n,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){if("number"==typeof s.limit&&0<s.limit)if(s.isLoading)a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null);else if(s.hasNext){s.isLoading=!0;var e=je.get(s);pe.get(s._iid).container.apiClient.loadOperatorList(_(_({},s),{},{token:s._token,channelUrl:e.url,isOpenChannel:e.isOpenChannel()}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).User,i=String(n.next);s._token=i,s.hasNext=!!i,t=n.operators.map(function(e){return new r(e)})}s.isLoading=!1,a(e,t)})}else a(null,[]);else a(O.error,null)},e)}}]),n}(),Ye=new WeakMap,Ke=function(){function n(e){v(this,n),this.isLoading=!1,this.hasNext=!0,this.limit=20,this._token="",e&&Ye.set(this,e.channelUrl)}return s(n,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){"number"==typeof s.limit&&0<s.limit?s.isLoading?a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasNext?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadParticipantList(_(_({},s),{},{channelUrl:Ye.get(s),token:s._token}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).User,i=String(n.next);s._token=i,s.hasNext=!!i,t=n.participants.map(function(e){return new r(e)})}s.isLoading=!1,a(e,t)})):a(null,[]):a(O.error,null)},e)}}]),n}(),Ve=new WeakMap,We=function(){function m(e,n){var t=n.limit,r=void 0===t?20:t,i=n.reverse,a=void 0!==i&&i,s=n.exactMatch,o=void 0!==s&&s,l=n.channelUrl,u=void 0===l?"":l,c=n.channelCustomType,d=void 0===c?"":c,h=n.messageTimestampFrom,p=void 0===h?null:h,f=n.messageTimestampTo,_=void 0===f?null:f,g=n.order,y=void 0===g?"score":g;v(this,m),this.isLoading=!1,this.hasNext=!0,Ve.set(this,{keyword:e,limit:r,reverse:a,exactMatch:o,channelUrl:u,channelCustomType:d,messageTimestampFrom:p,messageTimestampTo:_,order:y,previousToken:"",nextToken:""})}return s(m,[{key:"next",value:function(e){var h=this,n=D.get(this._iid),p=n.BaseChannel,f=n.GroupChannel,_=n.OpenChannel;return j(this._iid,function(s){var e=Ve.get(h),n=e.keyword,t=e.limit,r=e.reverse,i=e.exactMatch,a=e.channelUrl,o=e.channelCustomType,l=e.messageTimestampFrom,u=e.messageTimestampTo,c=e.order,d=e.nextToken;!("number"==typeof t&&0<t&&t<=1e3&&"boolean"==typeof r&&"boolean"==typeof i)||"string"!=typeof a&&null!==a||"string"!=typeof o&&null!==o||"number"!=typeof l&&null!==l||"number"!=typeof u&&null!==u||!(0<=["score","ts"].indexOf(c))?s(O.error,null):h.isLoading?s(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):h.hasNext?(h.isLoading=!0,pe.get(h._iid).container.apiClient.searchMessages({keyword:n,limit:t,reverse:r,exactMatch:i,channelUrl:a,channelCustomType:o,messageTimestampFrom:l,messageTimestampTo:u,order:c,nextToken:d},function(e,n){var t=null;if(!e){for(var r in t=[],n.results){var i=n.results[r],a=null;i.channel.hasOwnProperty("members")?(a=new f(i.channel),f.cachedChannels[a.url]=a):(a=new _(i.channel),_.cachedChannels[a.url]=a),t.push(p.buildMessage(i,a))}h.hasNext=n.has_next,Ve.get(h).nextToken=n.end_cursor}h.isLoading=!1,s(e,t)})):s(null,[])},e)}},{key:"key",get:function(){return Ve.get(this).keyword}},{key:"limit",get:function(){return Ve.get(this).limit}},{key:"reverse",get:function(){return Ve.get(this).reverse}},{key:"exactMatch",get:function(){return Ve.get(this).exactMatch}},{key:"channelUrl",get:function(){return Ve.get(this).channelUrl}},{key:"channelCustomType",get:function(){return Ve.get(this).channelCustomType}},{key:"messageTimestampFrom",get:function(){return Ve.get(this).messageTimestampFrom}},{key:"messageTimestampTo",get:function(){return Ve.get(this).messageTimestampTo}},{key:"order",get:function(){return Ve.get(this).order}}]),m}(),Je=new WeakMap,Xe=new WeakMap,Ze=function(){function n(e){v(this,n),this.isLoading=!1,this.hasMore=!0,this.limit=20,Xe.set(this,Number.MAX_SAFE_INTEGER),Je.set(this,e),this.reverse=!1,this.messageTypeFilter=null,this.customTypeFilter=null,this.senderUserIdsFilter=[],this.includeMetaArray=!1,this.includeReaction=!1,this.includeReplies=!1,this.includeParentMessageText=!1,this.includeThreadInfo=!1}return s(n,[{key:"load",value:function(s,e,n,t){var o=this,l=D.get(this._iid).BaseChannel,r=null,i=C(O.parse(arguments,[new O({type:"number",optional:!0,defaultValue:this.limit}),new O({type:"boolean",optional:!0,defaultValue:this.reverse}),new O({type:["string","number"],optional:!0,defaultValue:this.messageTypeFilter,constraint:function(e){return-1<Object.keys(l.MessageTypeFilter).map(function(e){return l.MessageTypeFilter[e]}).indexOf(e)||-1<[0,1,2,3].indexOf(e)}}),new O({type:"callback"})]),5);return r=i[0],s=i[1],e=i[2],n=i[3],t=i[4],j(this._iid,function(i){if(Array.isArray(o.senderUserIdsFilter)&&!o.senderUserIdsFilter.some(function(e){return"string"!=typeof e})||(r=O.error),r)i(r,null);else{if(o.limit=s,o.reverse=e,o.messageTypeFilter=n,"number"==typeof o.messageTypeFilter)switch(o.messageTypeFilter){case 0:o.messageTypeFilter=l.MessageTypeFilter.ALL;break;case 1:o.messageTypeFilter=l.MessageTypeFilter.USER;break;case 2:o.messageTypeFilter=l.MessageTypeFilter.FILE;break;case 3:o.messageTypeFilter=l.MessageTypeFilter.ADMIN}if(o.isLoading)i(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null);else if(o.hasMore){o.isLoading=!0;var a=Je.get(o);pe.get(o._iid).container.apiClient.getMessageList({channel:a,token:Xe.get(o)||(new Date).getTime()+1e4,tokenType:"timestamp",isInclusive:!1,prevResultSize:s,nextResultSize:0,shouldReverse:e,messageType:n,customType:o.customTypeFilter,senderUserIds:o.senderUserIdsFilter,includeMetaArray:o.includeMetaArray,includeReaction:o.includeReaction,includeReplies:o.includeReplies,includeParentMessageText:o.includeParentMessageText,includeThreadInfo:o.includeThreadInfo},function(e,n){var t=null;if(!e){(0===(t=n.messages.map(function(e){return l.buildMessage(e,a)})).length||t.length<s)&&(o.hasMore=!1);var r=Xe.get(o);Xe.set(o,Math.min.apply(Math,b(t.map(function(e){return e.createdAt})).concat([r])))}o.isLoading=!1,i(e,t)})}else i(null,[])}},t)}}]),n}(),$e=function(){function n(){v(this,n),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.includeEmpty=!1,this.order=qe.ORDER_LATEST_LAST_MESSAGE,this._token="",this.channelNameContainsFilter="",this.channelUrlsFilter=[],this.customTypesFilter=[],this.customTypeStartsWithFilter=null,this.superChannelFilter=Ee.SuperChannelFilter.ALL,this.membershipFilter=n.MembershipType.JOINED,this.metadataOrderKeyFilter=null,this.includeFrozen=!0}return s(n,[{key:"next",value:function(e){var s=this;return j(this._iid,function(i){var a=D.get(s._iid).GroupChannel;!("number"==typeof s.limit&&0<s.limit&&"boolean"==typeof s.includeEmpty&&"string"==typeof s.order&&-1<[n.ORDER_CHRONOLOGICAL,n.CHANNEL_NAME_ALPHABETICAL,n.METADATA_VALUE_ALPHABETICAL,n.ORDER_LATEST_LAST_MESSAGE].indexOf(s.order.toLowerCase())&&Array.isArray(s.customTypesFilter)&&Array.isArray(s.channelUrlsFilter)&&-1<Object.keys(n.MembershipType).map(function(e){return n.MembershipType[e]}).indexOf(s.membershipFilter)&&-1<Object.keys(a.SuperChannelFilter).map(function(e){return a.SuperChannelFilter[e]}).indexOf(s.superChannelFilter))||"string"!=typeof s.customTypeStartsWithFilter&&null!==s.customTypeStartsWithFilter||"string"!=typeof s.channelNameContainsFilter||"string"!=typeof s.metadataOrderKeyFilter&&null!==s.metadataOrderKeyFilter||"boolean"!=typeof s.includeFrozen?i(O.error,null):s.isLoading?i(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasNext?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadPublicGroupChannelList(_(_({},s),{},{token:s._token}),function(e,n){var t=null;if(!e){var r=String(n.next);s._token=r,s.hasNext=!!r,t=n.channels.map(function(e){return a.upsert(e)})}s.isLoading=!1,i(e,t)})):i(null,[])},e)}}],[{key:"MembershipType",get:function(){return{ALL:"all",JOINED:"joined"}}},{key:"ORDER_LATEST_LAST_MESSAGE",get:function(){return"latest_last_message"}},{key:"ORDER_CHRONOLOGICAL",get:function(){return"chronological"}},{key:"CHANNEL_NAME_ALPHABETICAL",get:function(){return"channel_name_alphabetical"}},{key:"METADATA_VALUE_ALPHABETICAL",get:function(){return"metadata_value_alphabetical"}}]),n}(),en=function(){function e(){v(this,e),this.isDistinct=null,this.isSuper=null,this.isBroadcast=null,this.isPublic=null,this.channelUrl=null,this.isEphemeral=null,this.isDiscoverable=null,this.isStrict=null,this.name=null,this.data=null,this.customType=null,this.channelCover=null,this.coverUrl=null,this.coverImage=null,this.accessCode=null,this.messageSurvivalSeconds=null,this._invitedUserIds=[];var n=null;Object.defineProperty(this,"operators",{set:function(e){Array.isArray(e)&&e.filter(function(e){return e.hasOwnProperty("userId")}).length===e.length&&(n=e.map(function(e){return e.userId}))}}),Object.defineProperty(this,"operatorUserIds",{get:function(){return n},set:function(e){Array.isArray(e)&&e.filter(function(e){return"string"==typeof e}).length===e.length&&(n=e)}})}return s(e,[{key:"_validate",value:function(){return Array.isArray(this._invitedUserIds)&&this._invitedUserIds.every(function(e){return"string"==typeof e})&&("string"==typeof this.channelUrl||null===this.channelUrl)&&("string"==typeof this.coverUrl||null===this.coverUrl)&&(ge.isFile(this.coverImage)||null===this.coverImage)&&("string"==typeof this.name||null===this.name)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&("boolean"==typeof this.isDistinct||null===this.isDistinct)&&("boolean"==typeof this.isSuper||null===this.isSuper)&&("boolean"==typeof this.isBroadcast||null===this.isBroadcast)&&("boolean"==typeof this.isPublic||null===this.isPublic)&&("boolean"==typeof this.isEphemeral||null===this.isEphemeral)&&("boolean"==typeof this.isDiscoverable||null===this.isDiscoverable)&&("boolean"==typeof this.isStrict||null===this.isStrict)&&(Array.isArray(this.operatorUserIds)&&this.operatorUserIds.every(function(e){return"string"==typeof e})||null===this.operatorUserIds)&&("string"==typeof this.accessCode||null===this.accessCode)&&("number"==typeof this.messageSurvivalSeconds||null===this.messageSurvivalSeconds)}},{key:"addUsers",value:function(e){if(Array.isArray(e)){var n,t=e.filter(function(e){return e.hasOwnProperty("userId")&&"string"==typeof e.userId}).map(function(e){return e.userId});(n=this._invitedUserIds).push.apply(n,b(t))}}},{key:"addUser",value:function(e){e.hasOwnProperty("userId")&&"string"==typeof e.userId&&this._invitedUserIds.push(e.userId)}},{key:"addUserIds",value:function(e){if(Array.isArray(e)){var n,t=e.filter(function(e){return"string"==typeof e});(n=this._invitedUserIds).push.apply(n,b(t))}}},{key:"addUserId",value:function(e){"string"==typeof e&&this._invitedUserIds.push(e)}}]),e}(),nn=new WeakMap,tn=function(){function e(){v(this,e),this._mentionType=e.MentionType.USERS,this._mentionedUserIds=[],this._cachedMentionedUsers=[],this._cachedMentionedUserIds=[],this._metaArrays=[],nn.set(this,null),this._parentMessageId=null}return s(e,[{key:"_validate",value:function(){var e=D.get(this._iid),n=e.BaseMessageParams,t=e.MessageMetaArray,r=nn.get(this);return-1<Object.keys(n.MentionType).map(function(e){return n.MentionType[e]}).indexOf(this.mentionType)&&this._mentionedUserIds.every(function(e){return"string"==typeof e})&&Array.isArray(this._metaArrays)&&this._metaArrays.every(function(e){return e instanceof t})&&("number"==typeof r||null===r)&&("number"==typeof this._parentMessageId||null===this._parentMessageId)}},{key:"mentionType",get:function(){return this._mentionType},set:function(e){var n=D.get(this._iid).BaseMessageParams;-1<Object.keys(n.MentionType).map(function(e){return n.MentionType[e]}).indexOf(e)&&(this._mentionType=e)}},{key:"mentionedUserIds",get:function(){return this._cachedMentionedUserIds},set:function(e){if(Array.isArray(e))for(var n=En.getInstance(this._iid),t=0;t<e.length;t++){var r=e[t];if("string"!=typeof r){this._cachedMentionedUserIds=[],this._mentionedUserIds=[];break}this._mentionedUserIds.indexOf(r)<0&&n.currentUser&&n.currentUser.userId!==r&&(this._cachedMentionedUserIds.push(r),this._mentionedUserIds.push(r))}}},{key:"mentionedUsers",get:function(){return this._cachedMentionedUsers},set:function(e){if(Array.isArray(e))for(var n=En.getInstance(this._iid),t=0;t<e.length;t++){var r=e[t];if(!r.hasOwnProperty("userId")){this._cachedMentionedUsers=[],this._mentionedUserIds=[];break}this._mentionedUserIds.indexOf(r.userId)<0&&n.currentUser&&n.currentUser.userId!==r.userId&&(this._cachedMentionedUsers.push(r),this._mentionedUserIds.push(r.userId))}}},{key:"metaArrayKeys",get:function(){return this._metaArrays.map(function(e){return e.key})},set:function(e){var n=D.get(this._iid).MessageMetaArray,t={};if(Array.isArray(e)){this._metaArrays=[];for(var r=0;r<e.length;r++)"string"!=typeof e[r]||t[e[r]]||(t[e[r]]=!0,this._metaArrays.push(new n(e[r])))}}},{key:"metaArrays",get:function(){return this._metaArrays},set:function(e){var n=D.get(this._iid).MessageMetaArray;if(Array.isArray(e)){this._metaArrays=[];for(var t=0;t<e.length;t++){var r=e[t];if(r instanceof n){var i,a=this._metaArrays.map(function(e){return e.key}).indexOf(r.key);if(a<0)this._metaArrays.push(r);else(i=this._metaArrays[a].value).push.apply(i,b(r.value))}}}}},{key:"rootMessageId",get:function(){return nn.get(this)}},{key:"parentMessageId",get:function(){return this._parentMessageId},set:function(e){nn.set(this,e),this._parentMessageId=e}}],[{key:"MentionType",get:function(){return{USERS:"users",CHANNEL:"channel"}}},{key:"PushNotificationDeliveryOption",get:function(){return{DEFAULT:"default",SUPPRESS:"suppress"}}}]),e}(),rn=function(){o(t,tn);var n=h(t);function t(){var e;return v(this,t),(e=n.call(this)).message=null,e.data=null,e.customType=null,e.pushNotificationDeliveryOption=null,e._translationTargetLanguages=[],e}return s(t,[{key:"_validate",value:function(){var n=D.get(this._iid).BaseMessageParams;return p(l(t.prototype),"_validate",this).call(this)&&("string"==typeof this.message||null===this.message)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&Array.isArray(this.translationTargetLanguages)&&this.translationTargetLanguages.every(function(e){return"string"==typeof e})&&(null===this.pushNotificationDeliveryOption||-1<Object.keys(n.PushNotificationDeliveryOption).map(function(e){return n.PushNotificationDeliveryOption[e]}).indexOf(this.pushNotificationDeliveryOption))}},{key:"targetLanguages",get:function(){return this.translationTargetLanguages},set:function(e){this.translationTargetLanguages=e}},{key:"translationTargetLanguages",get:function(){return this._translationTargetLanguages},set:function(e){if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("string"!=typeof e[n])return void(this._translationTargetLanguages=[]);this._translationTargetLanguages=e}}}]),t}(),an=function(){o(t,tn);var n=h(t);function t(){var e;return v(this,t),(e=n.call(this)).fileName=null,e.mimeType=null,e.fileSize=null,e.data=null,e.customType=null,e.pushNotificationDeliveryOption=null,e._isUpdate=!1,e._file=null,e._fileUrl=null,e._thumbnailSizes=[],e}return s(t,[{key:"_validate",value:function(){var n=D.get(this._iid).BaseMessageParams;return p(l(t.prototype),"_validate",this).call(this)&&(this._isUpdate||ge.isFile(this.file)||"string"==typeof this.fileUrl)&&("string"==typeof this.fileName||null===this.fileName)&&("string"==typeof this.mimeType||null===this.mimeType)&&("number"==typeof this.fileSize||null===this.fileSize)&&("string"==typeof this.data||null===this.data)&&("string"==typeof this.customType||null===this.customType)&&(null===this._thumbnailSizes||this._thumbnailSizes.every(function(e){return"object"===de(e)&&0<e.maxWidth&&0<e.maxHeight}))&&(null===this.pushNotificationDeliveryOption||-1<Object.keys(n.PushNotificationDeliveryOption).map(function(e){return n.PushNotificationDeliveryOption[e]}).indexOf(this.pushNotificationDeliveryOption))}},{key:"file",get:function(){return this._file},set:function(e){ge.isFile(e)&&(this._fileUrl=null,this._file=e)}},{key:"fileUrl",get:function(){return this._fileUrl},set:function(e){"string"==typeof e&&(this._fileUrl=e,this._file=null)}},{key:"thumbnailSizes",get:function(){return this._thumbnailSizes},set:function(e){if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("object"!==de(e[n])||"number"!=typeof e[n].maxWidth||"number"!=typeof e[n].maxHeight)return void(this._thumbnailSizes=[]);this._thumbnailSizes=e}}}]),t}(),sn=function(){o(r,rn);var t=h(r);function r(e){var n;return v(this,r),(n=t.call(this)).year=null,n.month=null,n.day=null,n.hour=null,n.min=null,n.timezone=null,n._scheduledDateTimeString=null,e&&n._update(e),n}return s(r,[{key:"_update",value:function(e){e.hasOwnProperty("message")&&(this.message=e.message),e.hasOwnProperty("year")&&(this.year=e.year),e.hasOwnProperty("month")&&(this.month=e.month),e.hasOwnProperty("day")&&(this.day=e.day),e.hasOwnProperty("hour")&&(this.hour=e.hour),e.hasOwnProperty("min")&&(this.min=e.min),e.hasOwnProperty("timezone")&&(this.timezone=e.timezone)}},{key:"_getScheduleString",value:function(){return this.scheduledDateTimeString?this.scheduledDateTimeString+" "+this.timezone:"number"==typeof this.year&&4===this.year.toString().length&&"number"==typeof this.month&&1<=this.month&&this.month<=12&&"number"==typeof this.day&&1<=this.day&&this.day<=31&&"number"==typeof this.hour&&0<=this.hour&&this.hour<=24&&"number"==typeof this.min&&0<=this.min&&this.min<=60&&"string"==typeof this.timezone&&0<this.timezone.length?this.year.toString()+"-"+("0"+this.month.toString()).substr(-2)+"-"+("0"+this.day.toString()).substr(-2)+" "+("0"+this.hour.toString()).substr(-2)+":"+("0"+this.min.toString()).substr(-2)+" "+this.timezone:null}},{key:"setSchedule",value:function(e,n,t,r,i,a){"number"==typeof e&&4===e.toString().length&&"number"==typeof n&&1<=n&&n<=12&&"number"==typeof t&&1<=t&&t<=31&&"number"==typeof r&&0<=r&&r<=24&&"number"==typeof i&&0<=i&&i<=60&&"string"==typeof a&&0<a.length&&(this.scheduledDateTimeString=e.toString()+"-"+("0"+n.toString()).substr(-2)+"-"+("0"+t.toString()).substr(-2)+" "+("0"+r.toString()).substr(-2)+":"+("0"+i.toString()).substr(-2),this.timezone=a)}},{key:"scheduledDateTimeString",get:function(){return this._scheduledDateTimeString?this._scheduledDateTimeString:"number"==typeof this.year&&4===this.year.toString().length&&"number"==typeof this.month&&1<=this.month&&this.month<=12&&"number"==typeof this.day&&1<=this.day&&this.day<=31&&"number"==typeof this.hour&&0<=this.hour&&this.hour<=24&&"number"==typeof this.min&&0<=this.min&&this.min<=60&&"string"==typeof this.timezone&&0<this.timezone.length?this.year.toString()+"-"+("0"+this.month.toString()).substr(-2)+"-"+("0"+this.day.toString()).substr(-2)+" "+("0"+this.hour.toString()).substr(-2)+":"+("0"+this.min.toString()).substr(-2):null},set:function(e){e&&"string"==typeof e&&(this._scheduledDateTimeString=e)}}]),r}(),on=function(){function e(){v(this,e),this.channelUrl=null,this.channelType=null,this.messageId=0,this.includeMetaArray=!1,this.includeParentMessageText=!1,this.includeThreadInfo=!1}return s(e,[{key:"_validate",value:function(){var e=D.get(this._iid).BaseChannel;return"string"==typeof this.channelUrl&&"string"==typeof this.channelType&&[e.CHANNEL_TYPE_BASE,e.CHANNEL_TYPE_OPEN,e.CHANNEL_TYPE_GROUP].includes(this.channelType)&&"number"==typeof this.messageId&&"boolean"==typeof this.includeMetaArray&&"boolean"==typeof this.includeParentMessageText&&"boolean"==typeof this.includeThreadInfo}}]),e}(),ln=function(){function n(){v(this,n);var e=D.get(this._iid).BaseChannel;this.prevResultSize=0,this.nextResultSize=0,this.isInclusive=!1,this.reverse=!1,this.messageType=e.MessageTypeFilter.ALL,this.customType=null,this.senderUserIds=null,this.includeMetaArray=!1,this.includeReactions=!1,this.includeReplies=!1,this.includeParentMessageText=!1,this.includeThreadInfo=!1}return s(n,[{key:"_validate",value:function(){var e=D.get(this._iid).BaseChannel;return"number"==typeof this.prevResultSize&&"number"==typeof this.nextResultSize&&"boolean"==typeof this.isInclusive&&"boolean"==typeof this.reverse&&"string"==typeof this.messageType&&Object.values(e.MessageTypeFilter).includes(this.messageType)&&("string"==typeof this.customType||null===this.customType)&&(Array.isArray(this.senderUserIds)&&this.senderUserIds.every(function(e){return"string"==typeof e})||null===this.senderUserIds)&&"boolean"==typeof this.includeMetaArray&&"boolean"==typeof this.includeReactions&&"boolean"==typeof this.includeReplies&&"boolean"==typeof this.includeParentMessageText&&"boolean"==typeof this.includeThreadInfo}}]),n}(),un=function(){function n(){v(this,n);var e=D.get(this._iid).BaseChannel;this.prevResultSize=0,this.nextResultSize=0,this.isInclusive=!1,this.reverse=!1,this.messageType=e.MessageTypeFilter.ALL,this.customType=null,this.senderUserIds=null,this.includeMetaArray=!1,this.includeReactions=!1,this.includeParentMessageText=!1}return s(n,[{key:"_validate",value:function(){var e=D.get(this._iid).BaseChannel;return"number"==typeof this.prevResultSize&&"number"==typeof this.nextResultSize&&"boolean"==typeof this.isInclusive&&"boolean"==typeof this.reverse&&"string"==typeof this.messageType&&Object.values(e.MessageTypeFilter).includes(this.messageType)&&("string"==typeof this.customType||null===this.customType)&&(Array.isArray(this.senderUserIds)&&this.senderUserIds.every(function(e){return"string"==typeof e})||null===this.senderUserIds)&&"boolean"==typeof this.includeMetaArray&&"boolean"==typeof this.includeReactions&&"boolean"==typeof this.includeParentMessageText}}]),n}(),cn=function(){function e(){v(this,e),this.includeMetaArray=!1,this.includeReactions=!1,this.includeReplies=!1,this.includeParentMessageText=!1,this.includeThreadInfo=!1}return s(e,[{key:"_validate",value:function(){return"boolean"==typeof this.includeMetaArray&&"boolean"==typeof this.includeReactions&&"boolean"==typeof this.includeReplies&&"boolean"==typeof this.includeParentMessageText&&"boolean"==typeof this.includeThreadInfo}}]),e}(),dn=function(){function e(){v(this,e),this.customTypes=[],this.includeEmpty=!1,this.includeFrozen=!0}return s(e,[{key:"_validate",value:function(){return(Array.isArray(this.customTypes)&&this.customTypes.every(function(e){return"string"==typeof e})||null===this.customTypes)&&("boolean"==typeof this.includeEmpty||null===this.includeEmpty)&&"boolean"==typeof this.includeFrozen}}]),e}(),hn=function(){function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];v(this,t),this.key=e,this.value=Array.isArray(n)&&n.every(function(e){return"string"==typeof e})?n:[]}return s(t,[{key:"encode",value:function(){return{key:this.key,value:this.value||[]}}}]),t}(),pn=new WeakMap,fn=function(){function a(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;v(this,a),this.key=e,this.userIds=n,this.updatedAt=t;var r={};for(var i in this.userIds){r[this.userIds[i]]=this.updatedAt}pn.set(this,r)}return s(a,[{key:"_applyEvent",value:function(e){if(e instanceof G){var n=pn.get(this);if(e.key===this.key&&(!n[e.userId]||n[e.userId]<e.updatedAt)){var t=this.userIds.indexOf(e.userId);switch(e.operation){case"add":t<0&&this.userIds.push(e.userId);break;case"delete":0<=t&&this.userIds.splice(t,1)}n[e.userId]=e.updatedAt}}}},{key:"isEmpty",get:function(){return 0===this.userIds.length}}],[{key:"createFromJson",value:function(e){var n=e.key,t=e.user_ids,r=e.updated_at;return"string"==typeof n&&n&&Array.isArray(t)&&0<t.length&&"number"==typeof r?new this(n,t,r):null}}]),a}(),_n=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];v(this,n),this.isLoading=!1,this.hasNext=!0,this.limit=20,this.userIds=e,this.metaDataKey="",this.metaDataValues=[],this._token=""}return s(n,[{key:"next",value:function(e){var s=this;return j(this._iid,function(a){"number"==typeof s.limit&&0<s.limit&&Array.isArray(s.userIds)&&"string"==typeof s.metaDataKey&&Array.isArray(s.metaDataValues)&&!!s.metaDataKey==0<s.metaDataValues.length?s.isLoading?a(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null):s.hasNext?(s.isLoading=!0,pe.get(s._iid).container.apiClient.loadUserList(_(_({},s),{},{userIdsFilter:s.userIds,metaDataKeyFilter:s.metaDataKey,metaDataValuesFilter:s.metaDataValues,token:s._token}),function(e,n){var t=null;if(!e){var r=D.get(s._iid).User,i=String(n.next);s._token=i,s.hasNext=!!i,t=n.users.map(function(e){return new r(e)})}s.isLoading=!1,a(e,t)})):a(null,[]):a(O.error,null)},e)}}]),n}(),gn=new WeakMap,yn=function(){function n(e){v(this,n),this.isLoading=!1,gn.set(this,e)}return s(n,[{key:"prev",value:function(t,s,o,e){var l=arguments,u=this;return j(this._iid,function(r){var e,i=D.get(u._iid).BaseChannel,n=C(O.parse(l,[new O({type:"number"}),new O({type:"number"}),new O({type:"boolean"}),new O({type:"function"})]),5);if(e=n[0],t=n[1],s=n[2],o=n[3],r=n[4],e)r(e,null);else if(u.isLoading)r(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null);else{u.isLoading=!0;var a=gn.get(u);pe.get(u._iid).container.apiClient.getMessageList({channelUrl:a.url,channelType:a.channelType,token:t,tokenType:"timestamp",isInclusive:!1,prevResultSize:s,nextResultSize:0,shouldReverse:o,messageType:"",customType:""},function(e,n){var t=null;e||(t=n.messages.map(function(e){return i.buildMessage(e,a)})),u.isLoading=!1,r(e,t)})}},e)}},{key:"next",value:function(t,s,o,e){var l=arguments,u=this;return j(this._iid,function(r){var e,i=D.get(u._iid).BaseChannel,n=C(O.parse(l,[new O({type:"number"}),new O({type:"number"}),new O({type:"boolean"}),new O({type:"function"})]),5);if(e=n[0],t=n[1],s=n[2],o=n[3],r=n[4],e)r(e,null);else if(u.isLoading)r(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null);else{u.isLoading=!0;var a=gn.get(u);pe.get(u._iid).container.apiClient.getMessageList({channelUrl:a.url,channelType:a.channelType,token:t,tokenType:"timestamp",isInclusive:!1,prevResultSize:0,nextResultSize:s,shouldReverse:o,messageType:"",customType:""},function(e,n){var t=null;e||(t=n.messages.map(function(e){return i.buildMessage(e,a)})),u.isLoading=!1,r(e,t)})}},e)}},{key:"load",value:function(t,s,o,l,e){var u=arguments,c=this;return j(this._iid,function(r){var e,i=D.get(c._iid).BaseChannel,n=C(O.parse(u,[new O({type:"number"}),new O({type:"number"}),new O({type:"number"}),new O({type:"boolean"}),new O({type:"callback"})]),6);if(e=n[0],t=n[1],s=n[2],o=n[3],l=n[4],r=n[5],e)r(e,null);else if(c.isLoading)r(new fe("Query in progress.",fe.QUERY_IN_PROGRESS),null);else{c.isLoading=!0;var a=gn.get(c);pe.get(c._iid).container.apiClient.getMessageList({channelUrl:a.url,channelType:a.channelType,token:t,tokenType:"timestamp",isInclusive:!1,prevResultSize:s,nextResultSize:o,shouldReverse:l,messageType:"",customType:""},function(e,n){var t=null;e||(t=n.messages.map(function(e){return i.buildMessage(e,a)})),c.isLoading=!1,r(e,t)})}},e)}}]),n}(),mn=null,vn={},Cn=!1,En=function(){function u(e){if(v(this,u),I()){var n=null,t=null;if(e.nodeJs&&"object"===de(e.nodeJs)&&(n=e.nodeJs.XMLHttpRequest,t=e.nodeJs.FormData),!n||"function"!=typeof n)return _e.debug("XMLHttpRequest should be provided in NodeJS environment."),null;if(!t||"function"!=typeof t)return _e.debug("FormData should be provided in NodeJS environment."),null}else e.nodeJs=null;var r=!1;if(e.newInstance||!mn?(r=!0,mn=this):mn&&e.appId!==mn.getApplicationId()&&mn.getConnectionState()===mn.ConnectionState.CLOSED&&(r=!0,mn=this),r){try{if(!e.hasOwnProperty("appId"))return _e.debug("Must be set appId"),null}catch(e){return _e.debug("Must be set appId"),null}var i=se.create();Object.defineProperty(this,"_iid",{get:function(){return i}}),(vn[i]=this).customApiHost=null,this.customWsHost=null,this.connecting=!1,this.reconnecting=!1,this.isReconnectingOnError=!1,this.connectionCallbacks=[],this.ConnectionManager=new L(this),this.GCMPushToken="",this.APNSPushToken="",this.PUSH_TEMPLATE_DEFAULT="default",this.PUSH_TEMPLATE_ALTERNATIVE="alternative",this.currentUser=null,this.isSessionOpened=!1,this.globalTimer,this.loginTimer,this.reconnectTimer,this.loginHandler=null,this.onLoginTimerCancel,this.onReconnectTimerCancel,this.BaseChannel={MessageTypeFilter:J.MessageTypeFilter};var a={User:V,Member:Ue,GroupChannel:Ee,OpenChannel:Me,UserMessage:Re,FileMessage:Te,AdminMessage:Oe,GroupChannelListQuery:qe,GroupChannelParams:en,BaseMessageParams:tn,UserMessageParams:rn,FileMessageParams:an,ScheduledUserMessageParams:sn,GroupChannelTotalUnreadMessageCountParams:ne,MessageRetrievalParams:on,MessageListParams:ln,ThreadedMessageListParams:un,MessageChangeLogsParams:cn,GroupChannelChangeLogsParams:dn,MessageMetaArray:hn,UserEventHandler:re,ChannelHandler:ie,ConnectionHandler:te},s={BaseChannel:J,BaseMessage:K,UserListQuery:_n,ApplicationUserListQuery:De,BannedUserListQuery:He,BlockedUserListQuery:Fe,FriendListQuery:Ge,MemberListQuery:Be,MutedUserListQuery:xe,OpenChannelListQuery:ze,OperatorListQuery:Qe,ParticipantListQuery:Ke,MessageListQuery:yn,PreviousMessageListQuery:Ze,MessageSearchQuery:We,PublicGroupChannelListQuery:$e,ScheduledUserMessage:Le,ThreadInfo:we,ThreadInfoUpdateEvent:Pe,Command:H,Sender:be,ReadStatus:ae,Reaction:fn,ReactionEvent:G,Emoji:Ie,EmojiCategory:Ae,EmojiContainer:Se,FileMessageQueue:ee},o=new D(this._iid,_(_({},a),s));for(var l in o)a[l]&&(this[l]=o[l]);pe.create(i,{appId:e.appId,pinger:new A(this),apiClient:new M(this),wsAdapter:new T(this),commandHandler:new X(this),onlineDetector:new w(this),ackStateMap:{},subscribedUnreadMessageCount:{all:0,custom_types:{},ts:0},maxUnreadCountOfSuperGroupChannel:he.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,auth:new E,appInfo:null,pingInterval:15e3,pongTimeout:5e3,connectedAt:0,extensions:{},supportedExtensionKeys:["sb_uikit","sb_syncmanager"],getUserAgentWithExtensions:function(e){var n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",t=e.sb_uikit?"u".concat(e.sb_uikit):"";return"JS/c".concat(he.SDK_VERSION,"/").concat(n,"/").concat(t)},stateChangeEnabled:!0,isInBackground:!1,closedByGoingBackground:!1,nodeJs:e.nodeJs||null,isErrorFirstInCallback:!1}),this.userEventHandlers={},this.channelHandlers={},this.connectionHandlers={},this.Options={_useMemberAsMessageSender:!0,get UseMemberAsMessageSender(){return this._useMemberAsMessageSender},set UseMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},get useMemberAsMessageSender(){return this._useMemberAsMessageSender},set useMemberAsMessageSender(e){"boolean"==typeof e&&(this._useMemberAsMessageSender=e)},_typingIndicatorThrottle:1e3,get typingIndicatorThrottle(){return this._typingIndicatorThrottle},set typingIndicatorThrottle(e){"number"==typeof e&&1e3<=e&&e<=9e3&&(this._typingIndicatorThrottle=e)}}}return mn}return s(u,[{key:"getApplicationId",value:function(){return pe.get(this._iid).get("appId")}},{key:"getCurrentUserId",value:function(){return this.currentUser?this.currentUser.userId:null}},{key:"getDebugMode",value:function(){return Cn}},{key:"setDebugMode",value:function(e){Cn=e,_e.mode=e?_e.Mode.DEBUG:_e.Mode.PRODUCTION}},{key:"getErrorFirstCallback",value:function(){return pe.get(this._iid).container.isErrorFirstInCallback}},{key:"setErrorFirstCallback",value:function(e){"boolean"==typeof e&&pe.get(this._iid).set("isErrorFirstInCallback",e)}},{key:"getCurrentApiHost",value:function(){return this.customApiHost?this.customApiHost:"https://api.sendbird.com"}},{key:"clearCurrentApiHost",value:function(){this.customApiHost=null}},{key:"getCurrentWsHost",value:function(){return this.customWsHost?this.customWsHost:"wss://ws.sendbird.com"}},{key:"clearCurrentWsHost",value:function(){this.customWsHost=null}},{key:"getConnectionState",value:function(){try{var e=pe.get(this._iid).container.wsAdapter;return this.connecting||this.reconnecting?this.ConnectionState.CONNECTING:e.ws?this.connecting||this.reconnecting?this.ConnectionState.CONNECTING:this.isSessionOpened?e.ws.getConnectionState():this.ConnectionState.CLOSED:this.ConnectionState.CLOSED}catch(e){return this.ConnectionState.CLOSED}}},{key:"getPendingGCMToken",value:function(){return this.GCMPushToken}},{key:"getPendingAPNSToken",value:function(){return this.APNSPushToken}},{key:"hasLoggedIn",value:function(){var e=pe.get(this._iid);return this.currentUser&&e.get("auth").hasSession()}},{key:"getLastConnectedAt",value:function(){var e=pe.get(this._iid);return this.getConnectionState()===this.ConnectionState.OPEN&&this.currentUser?e.get("connectedAt"):0}},{key:"connect",value:function(n,t,r,i,e){var a=this,s=pe.get(this._iid).container,o=s.wsAdapter,l=s.onlineDetector;l&&l.start();var u,c=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||3===e.length}}),new O({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||2===e.length}}),new O({type:"string",nullable:!0,ignoreIf:function(e){return 1===e.length||2===e.length}}),new O({type:"callback"})]),6);return u=c[0],n=c[1],t=c[2],r=c[3],i=c[4],e=c[5],j(this._iid,function(e){u?e(u,null):(a.customApiHost=r,a.customWsHost=i,a.connecting=!0,a.reconnecting=!1,a.isReconnectingOnError=!1,a.reconnectTimer&&(clearTimeout(a.reconnectTimer),a.reconnectTimer=null,a.onReconnectTimerCancel=null),a.getConnectionState()===a.ConnectionState.OPEN&&a.currentUser&&a.currentUser.userId===n?(a.connecting=!1,e(null,a.currentUser)):(a.connectionCallbacks.push(e),1===a.connectionCallbacks.length&&(o.disconnect({clearSession:!0,err:null},null),o.connect(n,t))))},e)}},{key:"reconnect",value:function(){var e=pe.get(this._iid).container,n=e.wsAdapter;if(e.auth.sessionKey&&this.currentUser){var t=!0;return 0<n.reconnectCount&&(t=!1),n.disconnect({clearSession:!1,err:new fe("Connection has been canceled.",fe.CONNECTION_CANCELED)},null),n.reconnectCount=0,n.reconnect(this.currentUser.userId,t),!0}return!1}},{key:"disconnect",value:function(e){var i=this;return j(this._iid,function(e){var n=pe.get(i._iid).container,t=n.wsAdapter,r=n.onlineDetector;r&&r.stop(),t.disconnect({clearSession:!0,err:new fe("Connection has been canceled.",fe.CONNECTION_CANCELED)},e)},e)}},{key:"setBackgroundState",value:function(){var e=pe.get(this._iid),n=e.container,t=n.wsAdapter,r=n.stateChangeEnabled;!n.isInBackground&&r&&(e.set("isInBackground",!0),this.getConnectionState()!==this.ConnectionState.CLOSED?(e.set("closedByGoingBackground",!0),t.disconnect({clearSession:!1,err:new fe("Websocket connection failed.",fe.WEBSOCKET_CONNECTION_FAILED)},null)):e.set("closedByGoingBackground",!1))}},{key:"setForegroundState",value:function(){var e=pe.get(this._iid),n=e.container,t=n.wsAdapter,r=n.stateChangeEnabled,i=n.isInBackground,a=n.closedByGoingBackground;i&&r&&(e.set("isInBackground",!1),a&&this.currentUser&&t.reconnect(this.currentUser.userId,!0))}},{key:"enableStateChange",value:function(){pe.get(this._iid).set("enableStateChange",!0)}},{key:"disableStateChange",value:function(){pe.get(this._iid).set("enableStateChange",!1)}},{key:"addExtension",value:function(e,n){var t=pe.get(this._iid).container,r=t.extensions;-1<t.supportedExtensionKeys.indexOf(e)&&(r[e]=n)}},{key:"createUserListQuery",value:function(e){return new(D.get(this._iid).UserListQuery)(e)}},{key:"createApplicationUserListQuery",value:function(){return new(D.get(this._iid).ApplicationUserListQuery)}},{key:"createBlockedUserListQuery",value:function(){return new(D.get(this._iid).BlockedUserListQuery)}},{key:"createFriendListQuery",value:function(){return new(D.get(this._iid).FriendListQuery)}},{key:"createMessageSearchQuery",value:function(e,n){return new(D.get(this._iid).MessageSearchQuery)(e,n)}},{key:"sendCommand",value:function(l,e){var u=this;return j(this._iid,function(o){u.ConnectionManager.ready(function(e,n){if(e)o(e,null);else{var t=pe.get(u._iid).container,r=t.wsAdapter,i=t.ackStateMap;if(null==r||null==r.ws||r.ws.getConnectionState()!==u.ConnectionState.OPEN||u.getConnectionState()!==u.ConnectionState.OPEN)return void o(new fe("Connection is not valid. Please reconnect.",fe.WEBSOCKET_CONNECTION_CLOSED),null);if(l.isAckRequired){var a=l.requestId,s={handler:o,timer:setTimeout(function(){o(new fe("Command received no ack.",fe.ACK_TIMEOUT),null),delete i[a]},he.COMMAND_ACK_TIMEOUT)};i[a]=s,r.ws.send(l,function(e){e&&(clearTimeout(s.timer),o(e,null))})}else r.ws.send(l,o)}},!1)},e)}},{key:"addUserEventHandler",value:function(e,n){n instanceof D.get(this._iid).UserEventHandler&&(this.userEventHandlers[e]=n)}},{key:"removeUserEventHandler",value:function(e){delete this.userEventHandlers[e]}},{key:"removeAllUserEventHandler",value:function(){this.userEventHandlers={}}},{key:"addChannelHandler",value:function(e,n){n instanceof D.get(this._iid).ChannelHandler&&(this.channelHandlers[e]=n)}},{key:"removeChannelHandler",value:function(e){delete this.channelHandlers[e]}},{key:"removeAllChannelHandlers",value:function(){this.channelHandlers={}}},{key:"addConnectionHandler",value:function(e,n){n instanceof D.get(this._iid).ConnectionHandler&&(this.connectionHandlers[e]=n)}},{key:"removeConnectionHandler",value:function(e){delete this.connectionHandlers[e]}},{key:"removeAllConnectionHandlers",value:function(){this.connectionHandlers={}}},{key:"updateCurrentUserInfo",value:function(i,a,e){var n,s=this,t=C(O.parse(arguments,[new O({type:"string",nullable:!0}),new O({type:"string",nullable:!0}),new O({type:"callback"})]),4);return n=t[0],i=t[1],a=t[2],e=t[3],j(this._iid,function(r){n?r(n,null):pe.get(s._iid).container.apiClient.updateCurrentUserInfo({nickname:i,profileUrl:a},function(e,n){var t=null;e||(s.currentUser&&(i&&(s.currentUser.nickname=i),a&&(s.currentUser.profileUrl=a)),t=s.currentUser),r(e,t)})},e)}},{key:"updateCurrentUserInfoWithProfileImage",value:function(i,e,n){var t,a=this,r=C(O.parse(arguments,[new O({type:"string",nullable:!0}),new O({type:"file",nullable:!0}),new O({type:"callback"})]),4);return t=r[0],i=r[1],e=r[2],n=r[3],j(this._iid,function(r){t?r(t,null):pe.get(a._iid).container.apiClient.updateCurrentUserInfo({nickname:i,profileImage:e},function(e,n){var t=null;e||(a.currentUser&&(i&&(a.currentUser.nickname=i),n.profile_url&&(a.currentUser.profileUrl=n.profile_url)),t=a.currentUser),r(e,t)})},n)}},{key:"updateCurrentUserInfoWithPreferredLanguages",value:function(i,e){var n,a=this,t=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return n=t[0],i=t[1],e=t[2],j(this._iid,function(r){n?r(n,null):pe.get(a._iid).container.apiClient.updateCurrentUserInfo({preferredLanguages:i},function(e,n){var t=null;e||(a.currentUser&&i&&(a.currentUser._preferredLanguages=i),t=a.currentUser),r(e,t)})},e)}},{key:"registerGCMPushTokenForCurrentUser",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,i.pushTokenRegistrationState.ERROR):i.currentUser?pe.get(i._iid).container.apiClient.registerGCMPushToken({token:e},function(e,n){var t=i.pushTokenRegistrationState.ERROR;e||(i.GCMPushToken="",t=i.pushTokenRegistrationState.SUCCESS),r(e,t)}):(i.GCMPushToken=e,r(null,i.pushTokenRegistrationState.PENDING))},n)}},{key:"unregisterGCMPushTokenForCurrentUser",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):i.currentUser?pe.get(i._iid).container.apiClient.unregisterGCMPushToken({token:e},function(e,n){t(e,null)}):(i.GCMPushToken=e,t(null,i.pushTokenRegistrationState.PENDING))},n)}},{key:"unregisterGCMPushTokenAllForCurrentUser",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.unregisterAllGCMPushTokens({},function(e,n){t(e,null)})},e)}},{key:"registerAPNSPushTokenForCurrentUser",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,i.pushTokenRegistrationState.ERROR):i.currentUser?pe.get(i._iid).container.apiClient.registerAPNSPushToken({token:e},function(e,n){var t=i.pushTokenRegistrationState.ERROR;e||(i.APNSPushToken="",t=i.pushTokenRegistrationState.SUCCESS),r(e,t)}):(i.APNSPushToken=e,r(null,i.pushTokenRegistrationState.PENDING))},n)}},{key:"unregisterAPNSPushTokenForCurrentUser",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return 0<e.length}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):i.currentUser?pe.get(i._iid).container.apiClient.unregisterAPNSPushToken({token:e},function(e,n){t(e,null)}):(i.APNSPushToken=e,t(null,i.pushTokenRegistrationState.PENDING))},n)}},{key:"unregisterAPNSPushTokenAllForCurrentUser",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.unregisterAllAPNSPushTokens({},function(e,n){t(e,null)})},e)}},{key:"unregisterPushTokenAllForCurrentUser",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.unregisterAllPushTokens({},function(e,n){t(e,null)})},e)}},{key:"getMyGroupChannelChangeLogsByToken",value:function(e,n,t,r){var l=this,i=null,a=C(O.parse(arguments,[new O({type:"string",nullable:!0}),new O({type:"array",optional:!0,nullable:!0,defaultValue:null}),new O({type:"boolean",nullable:!0,optional:!0,defaultValue:null}),new O({type:"callback"})]),5);i=a[0],e=a[1],n=a[2],t=a[3],r=a[4];var s=D.get(this._iid).GroupChannelChangeLogsParams,u=null;if(i){var o=C(O.parse(arguments,[new O({type:"string",nullable:!0}),new O({type:s,constraint:function(e){return e._validate()}}),new O({type:"callback"})]),4);i=o[0],e=o[1],u=o[2],r=o[3]}else(u=new s).customTypes=n,u.includeEmpty=t,u.includeFrozen=!0;return j(this._iid,function(o){i?o(i,null):pe.get(l._iid).container.apiClient.getMyGroupChannelChangeLogs(_({ts:null,token:e},u),function(e,n){if(e)o(e,null);else{var t=D.get(l._iid).GroupChannel,r=n.updated.map(function(e){return new t(e)}),i=n.deleted,a=n.has_more,s=n.next;o(null,{updatedChannels:r,deletedChannelUrls:i,hasMore:a,token:s})}})},r)}},{key:"getMyGroupChannelChangeLogsByTimestamp",value:function(e,n,t,r){var l=this,i=null,a=C(O.parse(arguments,[new O({type:"number",constraint:function(e){return 0<=e}}),new O({type:"array",optional:!0,nullable:!0,defaultValue:null}),new O({type:"boolean",nullable:!0,optional:!0,defaultValue:null}),new O({type:"callback"})]),5);i=a[0],e=a[1],n=a[2],t=a[3],r=a[4];var s=D.get(this._iid).GroupChannelChangeLogsParams,u=null;if(i){var o=C(O.parse(arguments,[new O({type:"number",constraint:function(e){return 0<=e}}),new O({type:s,constraint:function(e){return e._validate()}}),new O({type:"callback"})]),4);i=o[0],e=o[1],u=o[2],r=o[3]}else(u=new s).customTypes=n,u.includeEmpty=t,u.includeFrozen=!0;return j(this._iid,function(o){i?o(i,null):pe.get(l._iid).container.apiClient.getMyGroupChannelChangeLogs(_({ts:e,token:null},u),function(e,n){if(e)o(e,null);else{var t=D.get(l._iid).GroupChannel,r=n.updated.map(function(e){return new t(e)}),i=n.deleted,a=n.has_more,s=n.next;o(null,{updatedChannels:r,deletedChannelUrls:i,hasMore:a,token:s})}})},r)}},{key:"getChannelInvitationPreference",value:function(e){var n=this;return j(this._iid,function(r){pe.get(n._iid).container.apiClient.getChannelInvitationPreference({},function(e,n){var t=null;e||(t={autoAccept:n.auto_accept}),r(e,t)})},e)}},{key:"setChannelInvitationPreference",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"boolean"}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.setChannelInvitationPreference({isAutoAccept:e},function(e,n){var t=null;e||(t={autoAccept:n.auto_accept}),r(e,t)})},n)}},{key:"getDoNotDisturb",value:function(e){var n=this;return j(this._iid,function(r){pe.get(n._iid).container.apiClient.getDoNotDisturb({},function(e,n){var t=null;e||(t={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone}),r(e,t)})},e)}},{key:"setDoNotDisturb",value:function(e,n,t,i,a,s,r){var o,l=this,u=C(O.parse(arguments,[new O({type:"boolean"}),new O({type:"number",constraint:function(e){return 0<=e&&e<=23}}),new O({type:"number",constraint:function(e){return 0<=e&&e<=59}}),new O({type:"number",constraint:function(e){return 0<=e&&e<=23}}),new O({type:"number",constraint:function(e){return 0<=e&&e<=59}}),new O({type:"string"}),new O({type:"callback"})]),8);return o=u[0],e=u[1],n=u[2],t=u[3],i=u[4],a=u[5],s=u[6],r=u[7],j(this._iid,function(r){o?r(o,null):pe.get(l._iid).container.apiClient.setDoNotDisturb({doNotDisturbOn:e,startHour:n,startMin:t,endHour:i,endMin:a,timezone:s},function(e,n){var t=null;e||(t={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone}),r(e,t)})},r)}},{key:"getSnoozePeriod",value:function(e){var n=this;return j(this._iid,function(r){pe.get(n._iid).container.apiClient.getSnoozePeriod({},function(e,n){var t=null;e||(t={isSnoozeOn:n.snooze_enabled,startTs:n.snooze_start_ts,endTs:n.snooze_end_ts}),r(e,t)})},e)}},{key:"setSnoozePeriod",value:function(e,n,t,r){var i,a=this,s=C(O.parse(arguments,[new O({type:"boolean"}),new O({type:"number",constraint:function(e){return 0<e}}),new O({type:"number",constraint:function(e){return 0<e}}),new O({type:"callback"})]),5);return i=s[0],e=s[1],n=s[2],t=s[3],r=s[4],j(this._iid,function(r){i?r(i,null):pe.get(a._iid).container.apiClient.setSnoozePeriod({snoozeOn:e,startTs:n,endTs:t},function(e,n){var t=null;e||(t={isSnoozeOn:n.snooze_enabled,startTs:n.snooze_start_ts,endTs:n.snooze_end_ts}),r(e,t)})},r)}},{key:"blockUser",value:function(e,n){var t,r=C(O.parse(arguments,[new O({type:"object",constraint:function(e){return e&&e.hasOwnProperty("userId")}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],t?j(this._iid,function(e){e(t,null)},n):this.blockUserWithUserId(e.userId,n)}},{key:"blockUserWithUserId",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return e&&(!i.currentUser||e!==i.currentUser.userId)}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.blockUser({blockedUserId:e},function(e,n){var t=null;e||(t=new V(n)),r(e,t)})},n)}},{key:"unblockUser",value:function(e,n){var t,r=C(O.parse(arguments,[new O({type:"object",constraint:function(e){return e&&e.hasOwnProperty("userId")}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],t?j(this._iid,function(e){e(t,null)},n):this.unblockUserWithUserId(e.userId,n)}},{key:"unblockUserWithUserId",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"string",constraint:function(e){return e&&(!i.currentUser||e!==i.currentUser.userId)}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.unblockUser({unblockedUserId:e},function(e,n){t(e,null)})},n)}},{key:"getPushTriggerOption",value:function(e){var n=this;return j(this._iid,function(t){pe.get(n._iid).container.apiClient.getPushTriggerOption({},function(e,n){t(e,n?n.push_trigger_option:null)})},e)}},{key:"setPushTriggerOption",value:function(e,n){var r=this;return j(this._iid,function(t){-1<Object.keys(r.PushTriggerOption).map(function(e){return r.PushTriggerOption[e]}).indexOf(e)?pe.get(r._iid).container.apiClient.setPushTriggerOption({pushTriggerOption:e},function(e,n){t(e,n?n.push_trigger_option:null)}):t(O.error,null)},n)}},{key:"getGroupChannelCount",value:function(e,n){var t,i=this,r=D.get(this._iid).GroupChannel,a=C(O.parse(arguments,[new O({type:r.MemberStateFilter,optional:!0,defaultValue:r.MemberStateFilter.ALL}),new O({type:"callback"})]),3);return t=a[0],e=a[1],n=a[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.getGroupChannelCount({memberStateFilter:e},function(e,n){var t=null;e||(t=parseInt(n.group_channel_count)),r(e,t)})},n)}},{key:"getTotalUnreadChannelCount",value:function(e){var n=this;return j(this._iid,function(r){pe.get(n._iid).container.apiClient.getTotalUnreadChannelCount({},function(e,n){var t=null;e||(t=parseInt(n.unread_count)),r(e,t)})},e)}},{key:"getTotalUnreadMessageCount",value:function(t,e){var i,a=this,n=D.get(this._iid),s=n.GroupChannel,o=n.GroupChannelTotalUnreadMessageCountParams,r=C(O.parse(arguments,[new O({type:"object",optional:!0,defaultValue:null,constraint:function(e){return Array.isArray(e)&&e.every(function(e){return"string"==typeof e})||e instanceof o}}),new O({type:"callback"})]),3);return i=r[0],t=r[1],e=r[2],j(this._iid,function(r){if(i)r(i,null);else{var e=s.SuperChannelFilter.ALL;if(t instanceof o){var n=t;t=n.channelCustomTypesFilter,e=n.superChannelFilter}pe.get(a._iid).container.apiClient.getTotalUnreadMessageCount({customTypesFilter:t,superChannelFilter:e},function(e,n){var t=null;e||(t=parseInt(n.unread_count)),r(e,t)})}},e)}},{key:"getUnreadItemCount",value:function(r,e){var n,i=this,t=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return 0<e.length&&e.every(function(e){return-1<Object.keys(Ee.UnreadItemKey).map(function(e){return Ee.UnreadItemKey[e]}).indexOf(e)})}}),new O({type:"callback"})]),3);return n=t[0],r=t[1],e=t[2],j(this._iid,function(t){if(n)t(n,null);else{var e=r.filter(function(e,n){return r.indexOf(e)===n});pe.get(i._iid).container.apiClient.getUnreadItemCount({keys:e},function(e,n){t(e,n)})}},e)}},{key:"getSubscribedTotalUnreadMessageCount",value:function(){var e=pe.get(this._iid).container.subscribedUnreadMessageCount;return 0<=e.all?e.all:0}},{key:"getSubscribedCustomTypeTotalUnreadMessageCount",value:function(){var e=pe.get(this._iid).container.subscribedUnreadMessageCount;if(0<Object.keys(e.custom_types).length){var n=0;for(var t in e.custom_types)n+=e.custom_types[t];return n}return 0}},{key:"getSubscribedCustomTypeUnreadMessageCount",value:function(e){if(e&&"string"==typeof e){var n=pe.get(this._iid).container.subscribedUnreadMessageCount;return n.custom_types.hasOwnProperty(e)?n.custom_types[e]:0}return 0}},{key:"getMyPushTokensByToken",value:function(e,n,t){var i,a=this,r=C(O.parse(arguments,[new O({type:"string"}),new O({type:"string",constraint:function(e){return-1<["gcm","apns","apns_voip"].indexOf(e)}}),new O({type:"callback"})]),4);return i=r[0],e=r[1],n=r[2],t=r[3],j(this._iid,function(r){i?r(i,null):pe.get(a._iid).container.apiClient.getPushTokens({ts:null,token:e,type:n},function(e,n){if(e)r(e,null);else{var t=n.type;r(null,{deviceTokens:n.device_tokens,type:t?t.toLowerCase():"unknown",hasMore:n.has_more,token:n.token})}})},t)}},{key:"getPushTemplate",value:function(e){var n=this;return j(this._iid,function(r){pe.get(n._iid).container.apiClient.getPushTemplate({},function(e,n){var t=null;e||(t=n.name.toString()),r(e,t)})},e)}},{key:"setPushTemplate",value:function(e,n){var t=this;return j(this._iid,function(r){-1<[t.PUSH_TEMPLATE_DEFAULT,t.PUSH_TEMPLATE_ALTERNATIVE].indexOf(e)?pe.get(t._iid).container.apiClient.setPushTemplate({templateName:e},function(e,n){var t=null;e||(t=n.name.toString()),r(e,t)}):r(O.error,null)},n)}},{key:"markAsReadAll",value:function(e){var s=this;return j(this._iid,function(r){var i=D.get(s._iid).GroupChannel,a=(new Date).getTime();a-i.markAsReadAllLastSentAt<1e3?r(new fe("MarkAsRead rate limit exceeded.",fe.MARK_AS_READ_RATE_LIMIT_EXCEEDED),null):(i.markAsReadAllLastSentAt=a,pe.get(s._iid).container.apiClient.markAsReadAll({channelUrls:null},function(e,n){if(!e)for(var t in i.cachedChannels)s.currentUser&&i.cachedChannels[t].updateReadReceipt(s.currentUser.userId,a),i.cachedChannels[t]._setGroupChannelUnreadCount(0,0);r(e,null)}))},e)}},{key:"markAsReadWithChannelUrls",value:function(s,e){var n,o=this,t=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return n=t[0],s=t[1],e=t[2],j(this._iid,function(i){if(n)i(n,null);else{var a=(new Date).getTime();pe.get(o._iid).container.apiClient.markAsReadAll({channelUrls:s},function(e,n){if(!e)for(var t in s){var r=s[t];Ee.cachedChannels[r]&&(o.currentUser&&Ee.cachedChannels[r].updateReadReceipt(o.currentUser.userId,a),Ee.cachedChannels[r]._setGroupChannelUnreadCount(0,0))}i(e,null)})}},e)}},{key:"markAsDelivered",value:function(e){"string"==typeof e&&D.get(this._iid).GroupChannel.getChannel(e,function(e,n){e||n.markAsDelivered()})}},{key:"getFriendChangeLogsByToken",value:function(e,n){var t,a=this,r=C(O.parse(arguments,[new O({type:"string",optional:!0,defaultValue:null}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(i){t?i(t,null):pe.get(a._iid).container.apiClient.getFriendChangeLogsByToken({token:e},function(e,n){var t=null;if(!e){var r=D.get(a._iid).User;t={updatedUsers:n.updated.map(function(e){return new r(e)}),deletedUserIds:n.deleted,hasMore:n.has_more,token:n.next}}i(e,t)})},n)}},{key:"uploadFriendDiscoveries",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return e.every(function(e){return e.hasOwnProperty("friendDiscoveryKey")})}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.uploadFriendDiscoveries({discoveries:e},function(e,n){t(e,n)})},n)}},{key:"deleteFriendDiscovery",value:function(e,n){var t,r=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],t?j(this._iid,function(e){e(t,null)},n):this.deleteFriendDiscoveries([e],n)}},{key:"deleteFriendDiscoveries",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.deleteFriendDiscoveries({discoveryKeys:e},function(e,n){t(e,n)})},n)}},{key:"addFriends",value:function(e,n){var t,a=this,r=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(i){t?i(t,null):pe.get(a._iid).container.apiClient.addFriends({userIds:e},function(e,n){var t=null;if(!e){var r=D.get(a._iid).User;t=n.users.map(function(e){return new r(e)})}i(e,t)})},n)}},{key:"deleteFriend",value:function(e,n){var t,r=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],t?j(this._iid,function(e){e(t,null)},n):this.deleteFriends([e],n)}},{key:"deleteFriends",value:function(e,n){var r,i=this,t=C(O.parse(arguments,[new O({type:"array",constraint:function(e){return e.every(function(e){return"string"==typeof e})}}),new O({type:"callback"})]),3);return r=t[0],e=t[1],n=t[2],j(this._iid,function(t){r?t(r,null):pe.get(i._iid).container.apiClient.deleteFriends({userIds:e},function(e,n){t(e,n)})},n)}},{key:"getAllEmoji",value:function(e){var n,i=this,t=C(O.parse(arguments,[new O({type:"callback"})]),2);return n=t[0],e=t[1],j(this._iid,function(r){n?r(n,null):pe.get(i._iid).container.apiClient.getAllEmoji(function(e,n){if(e)r(e,null);else{var t=new(D.get(i._iid).EmojiContainer)(n);r(null,t)}})},e)}},{key:"getEmojiCategory",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"number"}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.getEmojiCategory({categoryId:e},function(e,n){if(e)r(e,null);else{var t=new(D.get(i._iid).EmojiCategory)(n);r(null,t)}})},n)}},{key:"getEmoji",value:function(e,n){var t,i=this,r=C(O.parse(arguments,[new O({type:"string"}),new O({type:"callback"})]),3);return t=r[0],e=r[1],n=r[2],j(this._iid,function(r){t?r(t,null):pe.get(i._iid).container.apiClient.getEmoji({emojiKey:e},function(e,n){if(e)r(e,null);else{var t=new(D.get(i._iid).Emoji)(n);r(null,t)}})},n)}},{key:"ConnectionState",get:function(){return{CONNECTING:"CONNECTING",OPEN:"OPEN",CLOSED:"CLOSED"}}},{key:"MessageRequestState",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",SUCCEEDED:"succeeded"}}},{key:"MessageSendingStatus",get:function(){return{NONE:"none",PENDING:"pending",FAILED:"failed",CANCELED:"canceled",SUCCEEDED:"succeeded"}}},{key:"pushTokenRegistrationState",get:function(){return{SUCCESS:"success",PENDING:"pending",ERROR:"error"}}},{key:"PushTriggerOption",get:function(){return{ALL:"all",MENTION_ONLY:"mention_only",OFF:"off"}}},{key:"appInfo",get:function(){return pe.get(this._iid).container.appInfo}}],[{key:"getInstance",value:function(e){return e?vn[e]:mn}},{key:"version",get:function(){return he.SDK_VERSION}}]),u}();return En});